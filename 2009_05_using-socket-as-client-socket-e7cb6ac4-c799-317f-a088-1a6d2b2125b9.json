[{"_id":"1a486373-c009-336d-bcaf-d779548484da","authorName":"TH","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"http://www.blogger.com/profile/01711760374259717819","authorUserId":"","authorFallbackAvatar":"","message":"I use MSDN async sample + your length prefix solution to write an Async socket Client and Server class, 3000 GB data all success transferred under single client and single data send thread test.   \r\nBut when I use a for loop to create several threads to send data to server, I found that in Client side, the thread created for BeginConnectCallback were always have the same id.  \r\nand all ManualResetEvent mechanism failed, all threads actived when ManualResetEvent.Set( ) called by first thread.  \r\n\r\nHere is my Client side Log sample: ( the problem is why it always Thread 7 do the EndConnect job? )  \r\n\r\n15:33:05.100 Data send Thread 1, BeginConnect to Server 192.168.1.100 Port 6000  \r\n15:33:05.100 Data send Thread 2, BeginConnect to Server 192.168.1.100 Port 6000  \r\n15:33:05.100 Data send Thread 3, BeginConnect to Server 192.168.1.100 Port 6000  \r\n15:33:05.102 ConnectionCallback Thread 7 Execute EndConnect and mreConnectDone.Set( );  \r\n15:33:05.102 ConnectionCallback Thread 7 Execute EndConnect and mreConnectDone.Set( );  \r\n15:33:05.121 Data send Thread 1, Connected via Port 2650, Socket Handle: 8234  \r\n15:33:05.145 ConnectionCallback Thread 7 Execute EndConnect and mreConnectDone.Set( );  \r\n15:33:05.170 Data send Thread 2, Connected via Port 2651, Socket Handle: 8235  \r\n15:33:05.177 Data send Thread 3, Connected via Port 2652, Socket Handle: 8236  \r\n\r\nI can mail you source code if you interested on this.  \r\nmy mail is thlin.harcon@gmail.com  \r\n\r\nthe MSDN sample URL: [http://msdn.microsoft.com/en-us/library/bew39x2a(VS.80).aspx](http://msdn.microsoft.com/en-us/library/bew39x2a(VS.80).aspx)","postId":"2009_05_using-socket-as-client-socket-e7cb6ac4-c799-317f-a088-1a6d2b2125b9","replyTo":"","date":"2013-12-11T16:35:24Z","timestamp":1386779724},{"_id":"2fb63c03-198a-31d7-a0fa-338ef62f3933","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"I'm not sure why there's a problem with the same thread always doing EndConnect; this is natural with the .NET IOCP used by asynchronous methods.  \r\n\r\nIf you have a specific problem with code, the best place to post it is Stack Overflow, where there are several people who can take a look at it.  \r\n\r\nP.S. The MSDN socket samples are notoriously poor.","postId":"2009_05_using-socket-as-client-socket-e7cb6ac4-c799-317f-a088-1a6d2b2125b9","replyTo":"","date":"2013-12-11T18:02:23Z","timestamp":1386784943},{"_id":"3686db8a-8d9b-3e39-8777-05048a51e8e4","authorName":"TH","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"http://www.blogger.com/profile/01711760374259717819","authorUserId":"","authorFallbackAvatar":"","message":"thank you, my problem solved.","postId":"2009_05_using-socket-as-client-socket-e7cb6ac4-c799-317f-a088-1a6d2b2125b9","replyTo":"","date":"2013-12-13T16:06:53Z","timestamp":1386950813},{"_id":"0c4b7fe0-cb0d-11eb-b0b1-291ac2881876","postId":"2009_05_using-socket-as-client-socket-e7cb6ac4-c799-317f-a088-1a6d2b2125b9","postUri":"https://blog.stephencleary.com/2009/05/using-socket-as-client-socket.html","replyTo":"ed86e110-caf5-11eb-b073-95a2105cc877","authorEmailEncrypted":"gHaeIoNMe5XkBZHjcRnCGHz4FoOJD59UGhBNEsKRL50913YVyK1ni3ODOr85F+OfkVu/ivM+vv1xbPRIXeevrrUB5/gs/YGbC1Iig+dPUj1yfyUf7BBMLV9AX/6AnXFCkHKSWGzlE37AO+41kEic4VqO3QQxvAkLN1Hi05Ydx1fBxuQSE1rhJUazRWNbMmDiSadRF60SipAZTwdwATp/nRO2ei9rYT5urep8h8ahGTE7sQK9v8fyEc/3UjXDmo950Yp4xhmkjpCdgog/OMraFq3fZTJNlTbC3gWNW1nvxSnGAZVnrP0hoM/lfrxPTzP/PsSeM8t0INYfhUVnhhDntHM+rHibFyMMMmxRP9YVpZeW7ROs3VHEMwdhHktt8c5OUqZylQCLSpp40tQ8Y8tuHz2L46TQ3W5N8X/ndI/CiTPvsN5Ql08Wv08skDPALO1phw1wclMCwajGA51jPgim1Ct8ymAn5MU0Tu4qnwiwiphrQHuCqE6+Zf7H0lzA4/RWh3Fun9fmSQ7LZaKr14u9A4SnVNJjUvkeQ8sFvgniQZ2wYNXClA0VP6wRxMceJMYeUo6W+HibPYOaTW5PYuAY/0IuMwZvhXNIwBnFbBgGb2Lb02wUt5dXCcrFLiKZYYEv9NQrnQoHWZ8uyzARs9CKlgdDhUAig9VPfwRn3TDH6Ns=","authorEmailMD5":"23448e78d187fba56d8bc263081ac5d8","authorName":"Stephen Cleary","authorUri":"https://stephencleary.com","message":"Sorry, I don't know why that would be. Perhaps try asking on Stack Overflow?","date":"2021-06-11T23:30:46.870Z"},{"_id":"ed86e110-caf5-11eb-b073-95a2105cc877","postId":"2009_05_using-socket-as-client-socket-e7cb6ac4-c799-317f-a088-1a6d2b2125b9","postUri":"https://blog.stephencleary.com/2009/05/using-socket-as-client-socket.html","replyTo":"","authorEmailEncrypted":"","authorEmailMD5":"","authorName":"Tonmoy Roy","authorUri":"","message":"Hello Stephen, thanks for your nice explanations. \r\n\r\nI need your help for a specific issue. In ASP.NET Web API, I need to connect to a socket. I used await tcpclient.connectAsync with ip and port. When debugging and stepping through VS IDE, this code works. But, if I don't step through (using F10), then the code waits infinitely.","date":"2021-06-11T20:45:16.859Z"},{"_id":"42b92ac0-cb47-11eb-b08e-5b428c6ee2c0","postId":"2009_05_using-socket-as-client-socket-e7cb6ac4-c799-317f-a088-1a6d2b2125b9","postUri":"https://blog.stephencleary.com/2009/05/using-socket-as-client-socket.html","replyTo":"0c4b7fe0-cb0d-11eb-b0b1-291ac2881876","authorEmailEncrypted":"","authorEmailMD5":"","authorName":"","authorUri":"","message":"Ok. Thanks.","date":"2021-06-12T06:27:28.996Z"}]