{"_id":"290d5ea3-4e28-3a19-8866-37060145d8f3","authorName":"Chiranjib","authorEmailEncrypted":"I/EzQAvu+QnY0mALguO3yeMavK0HlSYtxm4Y9iQJl47gAyRF76YTQ7jF+93MYpRWAYCxRRPQixhYGxWnUJZlhJaFXzTKB4X7dBbFU0wtfa4zQ1yltrJKw13j0ecbU0/TgoPpzAbMj4Y7IAAUGRM/H7qXFg1pzaeN6HYaB9bSlewpWoNePyNeuPQKfxFUpA1jxPUPYpOiXRwUKLQmRbM6dZSZm9oHqHfOqP1Glh7blzTlS5g8/5hTEv2YPvyd454Q5ndfOizMWMYHzby1G0NwtAeKBUEg/Wkzo+VZrrT63Pox/A1KIICw6w/w5H7fXbO9AYBRqhO+tHE5NBhsItB3/UOKtPgo19wntCoFzG8iWIPg9307GT0YRHPBWrUnHa2D9HjgbJK3HWk47MHuLZHgNE6Ko8dpgwYhIRRfB/LJsaLDNlwK4LSRdRmapQLwFDQN4MKqfgz2q9CMWUBS3xgUvMtHmwBQLuctCcSbEeOFZhQR9M221sA/e0hwCLe1PAsrL0NZbLG/T1sKO0u4H7x4SVFoCOFzik20ogFkUHdN3axiPqUFBe960eRUxsSp9u4IbJpcycaL3Yq/7kCfzEgxEnbCQj/Ra2KGJ+hR+mglmnl9js9hX0uqw7tecMIgLZrMfJ+vZmqUS/+fHCG2FX8LfnNJ5eP7zljIJD8dpwQPxzY=","authorEmailMD5":"6fb9392412fb481f785a114073349699","message":"Awesome post . And I am eager to discuss a problem that I faced.   \r\nOn the web service side here are four layers : controller,business and DAL and DAL talks to DB.\r\n\r\nNow from service side I want to invoke the three methods like\r\n\r\npublic async Task<groupmembershipvalidationoutput> validateDetails(myObject _input1)\r\n\r\n{\r\n\r\n Data.Upload.UploadDetails gd = new Data.Upload.UploadDetails();\r\n\r\n var firstTask = gd.myMethod1(_input1);  \r\n var secondTask = gd.myMethod2(_input1);  \r\n var thirdTask = gd.myMethod3(_input1);\r\n\r\nHere is how DAL methods look like\r\n\r\n public async Task<ienumerable<aout>> myMethod1(myObject gmvi)  \r\n {  \r\n Repository rep = new Repository();  \r\n var _validCodes = await rep.ExecuteSqlQueryAsync(typeof(AOut),SQL.Upload.UploadValidation.getCodeValidationSQL(gmvi._codes), null);  \r\n return (IEnumerable<aout>)_validCodes;\r\n\r\n }\r\n\r\nI want to invoke all the methods in service parallely without waiting them to complete one by one . Only I want to wait for their results . So I followed what u suggested here ...\r\n\r\n [http://stackoverflow.com/qu...](http://stackoverflow.com/questions/17197699/awaiting-multiple-tasks-with-different-results \"http://stackoverflow.com/questions/17197699/awaiting-multiple-tasks-with-different-results\")\r\n\r\n await Task.WhenAll(firstTask,secondTask,thirdTask);\r\n\r\n var _codesA = await firstTask;\r\n\r\n var _codesB = await secondTask;\r\n\r\n var _codesC = await thirdTask;\r\n\r\nBut these are not working as expected .  \r\nThe breakpoints hit show that one by one the method is getting called from service, going to DAL, execute the DB Query and comeback and assign to respective variables.\r\n\r\nAnd then call the next one .\r\n\r\nAnd also as soon as it hits\r\n\r\n await Task.WhenAll(_validChapterCodesTask, _validGroupCodesTask);\r\n\r\nThe next few lines are not hit and the control returns to the invoking controller. That is   \r\nin my controller ...\r\n\r\n var searchResults = ts.validateDetails(gmvi);\r\n\r\nIt is not waiting for the results to be assigned .\r\n\r\nWhat can be done to achieve the desired functionality ? Fire them parallely and wait for all the results to come back and then only return ?\r\n\r\nHere is the stack overflow question ..\r\n\r\n[http://stackoverflow.com/qu...](http://stackoverflow.com/questions/38012332/async-await-not-working-as-expected?noredirect=1#comment63476795_38012332 \"http://stackoverflow.com/questions/38012332/async-await-not-working-as-expected?noredirect=1#comment63476795_38012332\")","postId":"2012_07_dont-block-on-async-code-abe2d9c7-c3e9-3ed8-827c-021686fa2310","replyTo":"","date":"2016-06-24T18:19:23Z","timestamp":1466792363,"authorUserId":""}