{"_id":"034e3000-b0f3-11ec-81c4-b35731576ab0","postId":"2020_06_a-new-pattern-for-exception-logging-727f531a-2b21-3b7a-ba16-032c960fc67a","postUri":"https://blog.stephencleary.com/2020/06/a-new-pattern-for-exception-logging.html","replyTo":"124219d0-b0af-11ec-a952-2fb4cc7a5584","authorEmailEncrypted":"ciuCmRKz8mNozq5P/3KxvemVT5vJDXxs44lEJ2DtPh4RpnyMvHFPs2G0tjYADAIPIvxHtYuMAiH9eGKFKWgKu9UKACgnz8Vyu8cRHr4RUEQ8uy3FIiJPwPgkLQ82HQY8Xi+CVcizCvLj5TXZEMMMOkYSFCsp6GsA1L1KfIPATwSdB54w8TCTY6ICZ1aNSC00bpmq0XGcsFO3sCpKF0/+TOxGtQKoiNfTYIF0+FJwAaqsdtZkom9l4wg/z/NwqFI54gin9ofb+CYihezon/y1b8jkn4ibnGbeZGX08yUM/QUmrMvp83vb6nL2mfhEOP4mRboR/J8TvmpKjxW34n9bsgMitcqIXZYg7mH2JVekvEgI4h5d0NR3hTsiileMq7uHcN5jMq4f7DhurrIymP36fCIMHNMG/LOQZh1CFd86qyH33jz1Ff6etF2bvbIlTWMcQjioszy6kgE58in9l17Qqio0GCnM5I5zTCBfr2TyrGmJrH0ViWMr6d3aD0nEhtF/jRTYzYVA6q8JYs2smXkiEFeIG47YQ6E8jCZ7fnyGeXGIz0Sxl0i5k82CtYsAXUXwcQdzi2A58R4G5TXPSOu1uyDqKAS0HWt/YYvVsNw6LwZFmm5aHijv+f1VA/VUu98JkNB85r1s1KJnHupMiqSxbAt3rdku8DIUV/06zRN2eyI=","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorName":"Stephen Cleary","authorUri":"https://stephencleary.com","message":"What you're proposing is exactly as safe as `HttpContext.Items`. I like to leave open the option of, e.g., `Task.WhenAll` where the concurrent paths can each set their own scoped data. I don't use that kind of code on *every* request, but it happens often enough that I have a general rule of only using immutable data.\r\n\r\n> Will threads or async win the future?\r\n\r\nBoth. ;)  Async is really about more efficient use of threads. It's not either/or; it's both/and.\r\n\r\n> Also, I like the ability to use exceptions for things, even signaling a 403 not authorized -- what are your thoughts on performance here. Is capturing the stack trace too inefficient? Should the industry look at perhaps a \"throw without traceback capture\" optimization?\r\n\r\nI also like using exceptions for \"out of band\" responses, although I respect the arguments that it violates good design rules. It's just so convenient that I often do it anyway. I haven't had any performance concerns with it; those kinds of exceptions are a small percentage of all requests.","date":"2022-03-31T13:03:52.368Z"}