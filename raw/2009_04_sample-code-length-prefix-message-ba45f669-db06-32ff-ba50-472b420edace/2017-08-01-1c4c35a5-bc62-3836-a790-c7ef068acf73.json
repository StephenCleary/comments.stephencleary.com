{"_id":"1c4c35a5-bc62-3836-a790-c7ef068acf73","authorName":"Soumen Mondal","authorEmailEncrypted":"oBR/c8TfAybQHdkHxHu27LuOZw2dIKZ/FSRtVUKdpeV1IUIny8pktC0yfUzM1K/v6fS/RP6XzRdbRnfxRjDtey00QYwcCoMITP1Sj7HEuGiZ8TItwNjNhOJAxq3tUAQFu7JGsutMnYg35IaiMG7xBVidWd+K7+KSsgG0mCazAYpTdhAfZtIZlLVHAO5n8WjyIfmfSyL1RXeaBqrQJfTpPJ6VW12ixFAs1f2o5+ohAzjDSvaxpVMtZ2yMdadSAyyV4fReC+yPp/9jZQuLTNQ2ZNtm43r+WwA8CTMPtz/TgvlZpLXHW9cEbK+OANQydeDDShAiKOO+HBsiQWqzq2desDhvJ1Bf8LXC1/MfdEcEWgszWr0ymRkgkUXwRKFBn59b0CvEed5lmLr80GS4zHd+amXCHnJn0/fI2ayC1sChqtrd6GTqLQolMzU9QmI0Zt3A7jobOuJzlu9Suehr9Pozd6PQnNCup0raH2CieAtAA50O4hO/vr/4TeW+puBI/0st0LSOWrdWAQnD3EOjWsCG6i4bgazj+oU71qNmEOCmgMpFIfn0MNKM472igwBagqYICnbTDEOOqKWZm9Ie1cWQpFFrBkzRZlgUNZ2OfB66Q/1mBqW3xAWrP1T5tXa/sExqYAEmBqhs5y6quaDSya2Ffk0jH169qmPiPBwd2CX1gdI=","authorEmailMD5":"bf0ce2750b73e0f385399d45fdff6f01","message":"How can i use this packet protocol when send file data over ssl stream.Please help. I am using this code to send data to server from client  \r\n private Boolean SendTCPPackets(String filePath)  \r\n {\r\n\r\n Boolean status = false;\r\n\r\n TcpClient client = null;  \r\n SslStream sslStream = null;  \r\n String returndata = String.Empty;  \r\n String reciveddata = String.Empty;\r\n\r\n client = new TcpClient(serverName, serverPort);\r\n\r\n // Create an SSL stream that will close the client's stream.  \r\n sslStream = new SslStream(  \r\n client.GetStream(),  \r\n false,  \r\n new RemoteCertificateValidationCallback(ValidateServerCertificate),  \r\n null  \r\n );  \r\n try  \r\n {\r\n\r\n sslStream.AuthenticateAsClient(serverName);\r\n\r\n String fileName = Path.GetFileName(filePath);  \r\n Byte[] fileNameByte = Encoding.UTF8.GetBytes(fileName);  \r\n Byte[] fileNameLen = BitConverter.GetBytes(fileNameByte.Length);\r\n\r\n String filetext = File.ReadAllText(filePath).Trim();\r\n\r\n Byte[] fileData = Encoding.UTF8.GetBytes(filetext);  \r\n Byte[] fileDatalenByte = BitConverter.GetBytes(fileData.Length);\r\n\r\n Byte[] clientData = new Byte[4 + fileDatalenByte.Length + fileNameByte.Length + fileData.Length];\r\n\r\n fileNameLen.CopyTo(clientData, 0);  \r\n fileDatalenByte.CopyTo(clientData, 4);  \r\n fileNameByte.CopyTo(clientData, 4 + fileDatalenByte.Length);  \r\n fileData.CopyTo(clientData, 4 + fileDatalenByte.Length + fileNameByte.Length);\r\n\r\n client = new TcpClient(serverName, serverPort);\r\n\r\n client.Client.SendTimeout = 5000;  \r\n client.Client.ReceiveTimeout = 5000;  \r\n Byte[] messsage = clientData;  \r\n // Send message to the server.  \r\n sslStream.Write(messsage);  \r\n sslStream.Flush();\r\n\r\n String serverMessage = ReadMessage(sslStream);  \r\n serverMessage = serverMessage.Substring(0, serverMessage.Length - 5);  \r\n if (serverMessage.ToLower() == \"true\")  \r\n {  \r\n status = true;\r\n\r\n }  \r\n else  \r\n {  \r\n status = false;  \r\n }  \r\n //status = false;  \r\n // Read message from the server.\r\n\r\n }  \r\n catch (AuthenticationException e)  \r\n {  \r\n Console.WriteLine(\"Exception: {0}\", e.Message);  \r\n if (e.InnerException != null)  \r\n {  \r\n Console.WriteLine(\"Inner exception: {0}\", e.InnerException.Message);  \r\n }  \r\n Console.WriteLine(\"Authentication failed - closing the connection.\");  \r\n //client.Close();  \r\n return false;  \r\n }\r\n\r\n finally  \r\n {  \r\n //client.GetStream().Close();  \r\n //sslStream.Close();  \r\n client.Close();  \r\n }\r\n\r\n return status;  \r\n }","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2017-08-01T07:45:03Z","timestamp":1501573503,"authorUserId":""}