{"_id":"1c4c35a5-bc62-3836-a790-c7ef068acf73","authorName":"Soumen Mondal","authorEmailEncrypted":"jmZq9llnsSp0oStcCP6BWUPElQPrc/5Wur1mLHflANTRVPbt8dCAtVjFbPY3ejgbfGxZWsQ+IlaR8rhvP9yjxNdbsLorBxgAZbRGSS0e/SDUtsjVAlWGCyxaO+M51EzooTjvjLehmsFN2PJZUBWGcmwZCSPu5JazqVBkClwmr5oxz5DkN+N6LoX7lNS9gV46vI/QN4yyHl4fENRl7xjoPGctAa7sAVc/tXFZTog+v10t1ocCA5zUe4gdyotRU75pP0CfyYltXU3suYE8PnN3xpQbDtCSdHmqomBJ7fCehiB/mHyVA2XsUN8AsnpLMBTGP2wy+aSgOQCh979LY+a9ugIR6IKL06GmHy0XeaZpUuqcmOi1u4V0b9tGgGd1ahaKnNKoiCRWxlFHDv5r49PSHbwMarxIwkKRYX7ZJbQYJCKn+bzdBey0IJw00UQuLVC0pq4mAoRqJvqc7a4EwFJcC4+layLyVHwuNvbG33fZxEcGjuBe3aY0I9UGCb2d7WnvmNAbuMK/sLxu2w2YeEVNJOryvsZEXAF29snjScv0TEKQHiOgXt17cnY/GlFJElLxLILBg0uNtnXrS7CuYj/zl6486wmhUG9h+eXZBUsAJnsU0jLz21WIAHDdcHfMiRZinEnB3nt0R9c5+5jHR0fbI87RvGhCAiRAz4WJHjUAPow=","authorEmailMD5":"bf0ce2750b73e0f385399d45fdff6f01","message":"How can i use this packet protocol when send file data over ssl stream.Please help. I am using this code to send data to server from client  \r\n private Boolean SendTCPPackets(String filePath)  \r\n {\r\n\r\n Boolean status = false;\r\n\r\n TcpClient client = null;  \r\n SslStream sslStream = null;  \r\n String returndata = String.Empty;  \r\n String reciveddata = String.Empty;\r\n\r\n client = new TcpClient(serverName, serverPort);\r\n\r\n // Create an SSL stream that will close the client's stream.  \r\n sslStream = new SslStream(  \r\n client.GetStream(),  \r\n false,  \r\n new RemoteCertificateValidationCallback(ValidateServerCertificate),  \r\n null  \r\n );  \r\n try  \r\n {\r\n\r\n sslStream.AuthenticateAsClient(serverName);\r\n\r\n String fileName = Path.GetFileName(filePath);  \r\n Byte[] fileNameByte = Encoding.UTF8.GetBytes(fileName);  \r\n Byte[] fileNameLen = BitConverter.GetBytes(fileNameByte.Length);\r\n\r\n String filetext = File.ReadAllText(filePath).Trim();\r\n\r\n Byte[] fileData = Encoding.UTF8.GetBytes(filetext);  \r\n Byte[] fileDatalenByte = BitConverter.GetBytes(fileData.Length);\r\n\r\n Byte[] clientData = new Byte[4 + fileDatalenByte.Length + fileNameByte.Length + fileData.Length];\r\n\r\n fileNameLen.CopyTo(clientData, 0);  \r\n fileDatalenByte.CopyTo(clientData, 4);  \r\n fileNameByte.CopyTo(clientData, 4 + fileDatalenByte.Length);  \r\n fileData.CopyTo(clientData, 4 + fileDatalenByte.Length + fileNameByte.Length);\r\n\r\n client = new TcpClient(serverName, serverPort);\r\n\r\n client.Client.SendTimeout = 5000;  \r\n client.Client.ReceiveTimeout = 5000;  \r\n Byte[] messsage = clientData;  \r\n // Send message to the server.  \r\n sslStream.Write(messsage);  \r\n sslStream.Flush();\r\n\r\n String serverMessage = ReadMessage(sslStream);  \r\n serverMessage = serverMessage.Substring(0, serverMessage.Length - 5);  \r\n if (serverMessage.ToLower() == \"true\")  \r\n {  \r\n status = true;\r\n\r\n }  \r\n else  \r\n {  \r\n status = false;  \r\n }  \r\n //status = false;  \r\n // Read message from the server.\r\n\r\n }  \r\n catch (AuthenticationException e)  \r\n {  \r\n Console.WriteLine(\"Exception: {0}\", e.Message);  \r\n if (e.InnerException != null)  \r\n {  \r\n Console.WriteLine(\"Inner exception: {0}\", e.InnerException.Message);  \r\n }  \r\n Console.WriteLine(\"Authentication failed - closing the connection.\");  \r\n //client.Close();  \r\n return false;  \r\n }\r\n\r\n finally  \r\n {  \r\n //client.GetStream().Close();  \r\n //sslStream.Close();  \r\n client.Close();  \r\n }\r\n\r\n return status;  \r\n }","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2017-08-01T07:45:03Z","timestamp":1501573503,"authorUserId":""}