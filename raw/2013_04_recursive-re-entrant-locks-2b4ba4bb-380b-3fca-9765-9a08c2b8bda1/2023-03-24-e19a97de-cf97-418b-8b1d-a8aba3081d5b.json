{"_id":"e19a97de-cf97-418b-8b1d-a8aba3081d5b","postId":"2013_04_recursive-re-entrant-locks-2b4ba4bb-380b-3fca-9765-9a08c2b8bda1","postUri":"https://blog.stephencleary.com/2013/04/recursive-re-entrant-locks.html","replyTo":"","authorEmailEncrypted":"N8QgksYdDEzyO\u002B7Y/fFFNNfp5BkZUHRLlKO8IEL82ZAMe2IU1o8DdbqwZMVApoOhZhpqO7t83cpIyWHP3oo/cKgsC\u002B3f\u002BAaiNiEVtFZ\u002Bmyae2sUtocFIFCGRl58zBk9MkxExS\u002BCKgcMEFHKuGKa4jLq29\u002BI5NM1UYPu7bhz2qPhxq87a8qInBw57ZunIlQNijj2U8fZcyna/YIF6Y926Z3thhqw9mYOm/B/c8XpY/d1o3VLx7YOgzJy9SqbTOKciCyNT3BqO/EhTzbncpVCIC9RvCkuWzoryt1QGZH2aLc3tgwMcV1QcLhFuSm0L76G8LlJTWjuF41WbvNX7oI8WSqiyoitt9a/DfAb5AZRHZZZuP9X/5CVh0s6KGhZCHcNYckuVRF35WUmgkDkLEZJrOpdJLWWtIQlph32Cfr86orYJ6MXrFSqeTLuOdUNohMa9tU/vGIogiE/iD03mhcM/UeIV6\u002B90hZ6Ecrjnmuq5NYSz0fVduapKNp0Imo23wE0cWcnzNt5rpt\u002BkFnz4S3dLQg1dYIyZywzLZlngG5ndMHR\u002BHsXOPLdwTpSzwkcT3TbsugW3ybRAPDlqaH2JEUE4I507u\u002BzxMzHs5b2LQcTfFc1hJdYHMuMyw0\u002BHFcOff5FLwOjh8AG9rWBYxi7zNIjud6zzp3tqHbd8XIH5x5x1Im4=","authorEmailMD5":"f4fa2effb77c48bf460210baa762cb4b","authorName":"Kevin","authorUri":"","message":"I did use a pattern that is a counter-example to that rule that I\u0027m curious to throw it out there.\n\n\u0060\u0060\u0060csharp\nTask operation;\nlock (_runningOperationLock)\n{\n    if (_runningOperation == null)\n    {\n        operation = StartOperationAsync();\n        _runningOperation = operation;\n    } \n    else \n    {\n        operation = _runningOperation;\n    }\n\n    async Task StartOperationAsync()\n    { \n        await GetLatestValueAsync();\n        \n        lock (_runningOperationLock)\n        {\n            _runningOperation = null;\n        }\n    }\n}\n\nreturn await operation;\n\u0060\u0060\u0060\n\nIf \u0022DoStuffAsync\u0022 happens to run synchroneously, the recursive property of the lock is necessary. Not knowing if we will hold the lock or not at that point is a consequence of the async/await system...\n\nI\u0027m definitely not saying this is a common pattern, but it seems like a legitimate case for recursive mutexes in a traditional application.\n\nThanks,\nKevin","date":"2023-03-24T19:48:49.8179150Z"}