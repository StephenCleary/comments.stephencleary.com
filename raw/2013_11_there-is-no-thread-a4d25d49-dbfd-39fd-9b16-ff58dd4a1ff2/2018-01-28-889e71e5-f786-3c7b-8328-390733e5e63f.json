{"_id":"889e71e5-f786-3c7b-8328-390733e5e63f","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"If you want to dive that deep, then think of it in terms of callbacks. The task callback (a.k.a. continuation) contains a reference to the state machine struct.\r\n\r\nAt each level, only the state at that level is referenced. The IRP contains the callbacks in the driver stack, OVERLAPPED contains the callback in the (unmanaged) user-mode process (processed via I/O Completion Ports), and Task contains the callback(s) in managed code. Only this last callback references the state machine struct; the others reference their own similar structures.\r\n\r\nSo, when an asynchronous I/O operation is in flight, there's no call stack in memory. Instead, there's a series of callbacks that all refer to each other, from the lowest level device driver up to your own managed code.","postId":"2013_11_there-is-no-thread-a4d25d49-dbfd-39fd-9b16-ff58dd4a1ff2","replyTo":"9432b305-cdc0-3ee7-8f70-95419d5b9476","date":"2018-01-28T02:46:37Z","timestamp":1517107597}