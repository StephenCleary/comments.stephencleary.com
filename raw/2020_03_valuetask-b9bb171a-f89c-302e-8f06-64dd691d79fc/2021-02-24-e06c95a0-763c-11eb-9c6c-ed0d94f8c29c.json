{"_id":"e06c95a0-763c-11eb-9c6c-ed0d94f8c29c","postId":"2020_03_valuetask-b9bb171a-f89c-302e-8f06-64dd691d79fc","postUri":"https://blog.stephencleary.com/2020/03/valuetask.html","replyTo":"","authorEmailEncrypted":"V4H43ZBcq2MNZfFfVTRQCMtNUwsnvwam9ODOpkcQYaF6mVDSF7Wm3mVmfr3egMkQfrFida3eudWvXPtIQSX75sWLG8BHNpluBLn9hoIiPtrEmtXT03ZVL0EQADScdOklcXeljTPR91BqNKk0BoAJz73D2JANqezMyo8Ay7mJnjI8M9CjUSrrK/ENqgYwvGxaBd82+XUeLyGelaegJ4KUyCDhmpyMDjvhh2BDN8qfU2mx6KzHIeFZsn39kTUjF5tRHp/9mFOvoH1Do49OXwlogT9gdFtCaK5B+XVOKXyKBZBqcuCjFdJrId27Jw0qpsMXMX0uncX5WPNxFwiOcPIE15lGfq95xq3ziE/JspDJlQS3rz1oh/5LUxyuAwdNQyT/ohSrRE0nFy1GR44FEdUZkvekhDJvhHDtNFvzGJ7VGgCDcGZThn1ulXYp72NvOf/4NfHyQdWql6mLcBcQEynaEAhON04MWFRRtkFt9V6vuq0ZY1tilJlzbq8O8CeoyNM29qfhjXAKP9XbdOpp3iMOgE4dF6vncHaSaGFk8Jj6s8YnBIC7nFQYb3zXTUgcK3CFVBuQMKkrhXdr0VUhPaBSEQubKNgkK6ppFGcqRGl6MTsrtybFN4WhkM9b0RheOHKDyZFN+GSx4OF5/n5ID5GsTsAUZiQoX4cZ63fDndKRqKU=","authorEmailMD5":"bac49a5e551462450167dbc0b4c0b122","authorName":"Vlad","authorUri":"","message":"Thank you for your work!\r\nIn the article you are saying:\r\n\r\n\"But if your code does an await more than once, or wants to use Task.WhenAll or Task.WhenAny, then it should not await the value task - it should convert the value task to a reference task (by calling AsTask) exactly once, and then only use that reference task from then on\"\r\n\r\nDo you mean that the same ValueTask shouldn't go into Task.WhenAll (or Task.WhenAny) and be awaited after, like that:\r\n\r\n------------Example 1\r\n\r\n`ValueTask<int> someValueTask = getMyValueTask();`\r\n\r\n`await Task.WhenAll(someValueTask);`\r\n\r\n`int actualValue = await someValueTask; // WRONG!`\r\n\r\n--------------Example 2\r\n\r\n`ValueTask<int> someValueTask = getMyValueTask();`\r\n\r\n`await Task.WhenAll(someValueTask); // CORRECT!`","date":"2021-02-24T01:09:00.318Z"}