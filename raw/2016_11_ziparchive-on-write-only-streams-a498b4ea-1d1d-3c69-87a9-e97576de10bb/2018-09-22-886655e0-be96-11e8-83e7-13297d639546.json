{"_id":"886655e0-be96-11e8-83e7-13297d639546","postId":"2016_11_ziparchive-on-write-only-streams-a498b4ea-1d1d-3c69-87a9-e97576de10bb","postUri":"https://blog.stephencleary.com/2016/11/ziparchive-on-write-only-streams.html","replyTo":"","authorEmailEncrypted":"DsVJuI0gkhJCA+KtJzBXgHa/pUe8a5JKRIXN7mU1X2sDv+mhqXlTnhiw3BVkOJHJKfvVuPxDeRpsTbLhGjk+srIolgvzVKQyIC9J7HpnOqAovFGdadyg5AbADpa6/axOyn2kPpyiULtPhhVcpbI5p7TEH+KGzoEv/N0iRVD0HswadEHhVudUrHEBQZeGJRUsZUE7g2oAADb2YzVh7n2Zb1OhthEkUEZx9l3HnlcPbVHGEOH+o9bv3PySTHo13r00akNQwOQmCsVnRGv0BIkpZcxjfdm8D321Q1ao2uIzimw659KSBx5K9anjnwxFV9OKNnfnPD1LErHT0pNW8rYjfJWolzML+6wJ7HXTLu2T3f+ZbxWR2b4GpwELntF8LkCNM4WJ8Jyhr3i1FD1dg0A3rU2i0nfdF+IcxQ1Aaw/PM8uVY8aDy2O6I2wwF/nQwUSO1q3WZDKz6vnZUXtu1bXkLJJHjyqkpMlTbEhOWSH/0bQ3LKx19VCCOwjiq0Ehoq5hM1D1QuE9uxGwgqMaPP+nXReuGa0HiLTE92at7lYpxRainaa0a+B3a3IaM7ghrUX2sUAAVpJUrOKLKIe5PZwTh0d1ruwBm1htrAoVUVymtsrDVJQ+WZ0qUOiktvOIV114AdCNLDBPbjwKp5miDpxWkGUauLWO13d61DTj2OaZLeM=","authorEmailMD5":"0c178795cbf4a05bc0a72d35f23e9f26","authorName":"Paul","authorUri":"https://printslon.com","message":"Hi Stephen, I'm using a free Azure tier and when I try to download archive more than 130Mb I'm getting OutOfMemoryException\r\n\r\n(at my laptop, of course, everything is ok)\r\n\r\nHere is a stack trace\r\n\r\n2018-09-22T17:56:46.6166236+00:00 0HLH0MHOCHK0R:00000004 [ERR] An unhandled exception has occurred: Exception of type 'System.OutOfMemoryException' was thrown. (8be5a754)\r\nSystem.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.\r\n   at System.IO.MemoryStream.set_Capacity(Int32 value)\r\n   at System.IO.MemoryStream.EnsureCapacity(Int32 value)\r\n   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)\r\n   at Controllers.ViewModels.WriteOnlyStreamWrapper.Write(Byte[] buffer, Int32 offset, Int32 count) in D:\\a\\1\\s\\\\WriteOnlyStreamWrapper.cs:line 33\r\n   at System.IO.Compression.PositionPreservingWriteOnlyStreamWrapper.Write(Byte[] buffer, Int32 offset, Int32 count)\r\n   at System.IO.Compression.DeflateStream.WriteDeflaterOutput()\r\n   at System.IO.Compression.DeflateStream.Write(Byte[] array, Int32 offset, Int32 count)\r\n   at System.IO.Compression.CheckSumAndSizeWriteStream.Write(Byte[] buffer, Int32 offset, Int32 count)\r\n   at System.IO.Compression.ZipArchiveEntry.DirectToArchiveWriterStream.Write(Byte[] buffer, Int32 offset, Int32 count)\r\n   at System.IO.Compression.WrappedStream.Write(Byte[] buffer, Int32 offset, Int32 count)\r\n   at System.IO.Stream.<>c.<BeginWriteInternal>b__46_0(Object <p0>)\r\n   at System.Threading.Tasks.Task`1.InnerInvoke()\r\n   at System.Threading.Tasks.Task.<>c.<.cctor>b__276_1(Object obj)\r\n   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\r\n   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)\r\n\r\nDo you have any ideas how to resolve it for free Azure tier?","date":"2018-09-22T18:37:18.326Z"}