{"_id":"35f5343d-7fae-3555-9472-805644bb9456","authorName":"cessna048","authorEmailEncrypted":"HFLXd4n6/TECQ6StH7VbpKMnOoiBc1r85NlRUzsjLsZftCezBl+UBoCNNSLDqalbLbJG6Nrt5+C1/wurOPQORvQJMn5SoFv1FpDU2Z4v77GTL7crjWrhw/wjVZpZ4iNEC22v2yQlXB9kygd+f/n99lBRBofsyUaD2LkgoG0/3gKSH2Yv7i02OZXSMiTCD90gkBRCKDDufdYPaVjVkA5sNVjviBa/J1Fo8/6vVKj2TQ89SPZ/lOUvuR/CU772IFG/hrbOFgocauDXmJJSnfsBONgjKbVw0wPo/+yafVvEMKdoyLTq11mvidnTUWPm2XqGJ1EAeI25dm03Dz6fDQPEpz9XVC9O683s0WJq14K06pB806vBs97F7qTvErpj6vnFbal6+6Txlxj6bC6xwqF2X+lsigT3IrpWgiSfI54erbONiJtD5ia+t09upfMGwnWyNa0FQ3cq4ssJYaJqgqWkguj/ZpUe7COIJ1MWnPlmqOjYWq/k19WyKjaQ3wW4M8Lrq7ptDZiAsoqvWpt/+OL5Ur+2aOuvfRp8dTPUDs1Za2T5x30g2skbJ82+JmChEWlMAgbG9nuVaTyt4ibtKhZW7jhZdFxrwJpHfy8LNmEip4EiSTJFaMvzUjplQt5BJxyqqHdfgj9DuIRn/eS0nVcW6QYphe8n1nvRnQuoQJH6ZuM=","authorEmailMD5":"99a3bcc695ffdcd91a1d946e0a409f85","authorUri":"","authorUserId":"disqus:cessna048","authorFallbackAvatar":"","message":"Thank you for this great article series. Sorry I am such a late-comer.\r\n\r\nI am adding DVD burning to a WPF app using IMAPI2. At IMAPI2's heart is a blocking Write call so I am wondering what approach I should take. Here is what I currently have but I wonder if you would consider it correct implementaion of async. My feeling is that it is, because it is I/O bound, but I am not so sure because IMAPI2 is not \"naturally asynchronous\" and I have an asynchronous wrapper (fake async?).\r\n\r\nThanks,  \r\nBill\r\n\r\npublic class MainViewModel  \r\n{  \r\n//Command execute handler  \r\nprivate void async BurnDataDiscExecute  \r\n{  \r\nCancellationTokenSource burnCanceller = new CancellationTokenSource();  \r\nProgress<datadisccreatorprogressargs> progress = new Progress<datadisccreatorprogressargs>();\r\n\r\nDataDiscCreator discCreator = new DataDiscCreator(...);\r\n\r\n// Add files to image  \r\nfor (...)  \r\ndiscCreator.AddFile(...);\r\n\r\n// Create the disc  \r\nawait discCreator.CreateDiscAsync(progress, burnCanceller.Token);  \r\ndiscCreator.EjectDisc();\r\n\r\n}\r\n\r\n}\r\n\r\n// Wrapper around IMAPI2  \r\npublic class DataDiscCreator  \r\n{  \r\n...  \r\npublic CreateDiscAsync(Progress<datadisccreatorprogressargs> progress, CancellationToken cancel)  \r\n{  \r\nTask<bool> t = Task.Factory.StartNew<bool>(() =>   \r\n{  \r\nCreateDisc(burnProgress, cancel);  \r\nreturn true;   \r\n}, TaskCreationOptions.LongRunning);  \r\nreturn t;  \r\n}\r\n\r\n public void CreateDisc(IProgress<datadisccreatorprogressargs> burnProgress, CancellationToken cancel)  \r\n{  \r\nMsftDiscRecorder2 discRecorder = new MsftDiscRecorder2(); // Interop class for IMAPI2  \r\ndiscRecorder.InitializeDiscRecorder(...);\r\n\r\n MsftDiscFormat2Data discFormatter = new MsftDiscFormat2Data(); // Interop class for IMAPI2  \r\n...\r\n\r\n // Blocking write   \r\ndiscFormatter.Write(result.ImageStream);  \r\n}\r\n\r\n}","postId":"2013_11_taskrun-etiquette-examples-even-in-92009538-82a4-3754-9963-fbe116fda88e","replyTo":"","date":"2015-07-16T14:41:24Z","timestamp":1437057684}