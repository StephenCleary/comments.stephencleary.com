{"_id":"35f5343d-7fae-3555-9472-805644bb9456","authorName":"cessna048","authorEmailEncrypted":"mtsq7d22KavvJ8MRaJs3u/lsOJXfa0sd/QTB6eg2eZPjP5CkHMnsGqJlzx2lHZRqsTXWHYNeB/5QZIaceG8wZ5YxWbqQrT/T73Jeam+GGuemarqZivdrk8wWi71wqmkQHx/zlNxNkG0pnO1JIRoStFynw9CU06pi6Dfb4DH9SNr1u0bQNfhPEQ9Lm9H+X7UB27hGGI9zvEPgBeD1pw6sfNyILuYdciZwgHksTeJiNsOMdctP5c1/NpdmM4nzJOqL/u160r6JNwB8s63TvFPEDggJ8DBYNz0AbY4hOnDJLb7dQlUQ4AGW4ghfIjjkEDkRGIaz2MDb1IU1XW0BdB0AgxeltuBuVp+SPjieYSZVSXdzY6xGcg1rap/Ug5gpgA6ihNH9UQ+dxy+wejLquiE06qj/BDz50bYdl3GbDAK4JZMFJDXoIffPdS9NMH2mHJwjd6BXEBPFKNX35NsAJwzYUZfqDa9hwJOR0vp2crmRzAFYUyFFRQW5psl2oekH8HTBNtCQAKu0HfwIcAYV40Klw1MSxQTDE0nNoFQTEPXXu48vVCv84H1On47d32V4kkZPzkq/cDMtcwxK49tW8Tc7htCAO2JvrjpU7fVfQ9INZS0Lqh0/zw+HvBGbYH16kYqw/OcpQe2dz5NaOwge4zgpZ83OseYu52ek/5rYei9m0hg=","authorEmailMD5":"99a3bcc695ffdcd91a1d946e0a409f85","message":"Thank you for this great article series. Sorry I am such a late-comer.\r\n\r\nI am adding DVD burning to a WPF app using IMAPI2. At IMAPI2's heart is a blocking Write call so I am wondering what approach I should take. Here is what I currently have but I wonder if you would consider it correct implementaion of async. My feeling is that it is, because it is I/O bound, but I am not so sure because IMAPI2 is not \"naturally asynchronous\" and I have an asynchronous wrapper (fake async?).\r\n\r\nThanks,  \r\nBill\r\n\r\npublic class MainViewModel  \r\n{  \r\n//Command execute handler  \r\nprivate void async BurnDataDiscExecute  \r\n{  \r\nCancellationTokenSource burnCanceller = new CancellationTokenSource();  \r\nProgress<datadisccreatorprogressargs> progress = new Progress<datadisccreatorprogressargs>();\r\n\r\nDataDiscCreator discCreator = new DataDiscCreator(...);\r\n\r\n// Add files to image  \r\nfor (...)  \r\ndiscCreator.AddFile(...);\r\n\r\n// Create the disc  \r\nawait discCreator.CreateDiscAsync(progress, burnCanceller.Token);  \r\ndiscCreator.EjectDisc();\r\n\r\n}\r\n\r\n}\r\n\r\n// Wrapper around IMAPI2  \r\npublic class DataDiscCreator  \r\n{  \r\n...  \r\npublic CreateDiscAsync(Progress<datadisccreatorprogressargs> progress, CancellationToken cancel)  \r\n{  \r\nTask<bool> t = Task.Factory.StartNew<bool>(() =>   \r\n{  \r\nCreateDisc(burnProgress, cancel);  \r\nreturn true;   \r\n}, TaskCreationOptions.LongRunning);  \r\nreturn t;  \r\n}\r\n\r\n public void CreateDisc(IProgress<datadisccreatorprogressargs> burnProgress, CancellationToken cancel)  \r\n{  \r\nMsftDiscRecorder2 discRecorder = new MsftDiscRecorder2(); // Interop class for IMAPI2  \r\ndiscRecorder.InitializeDiscRecorder(...);\r\n\r\n MsftDiscFormat2Data discFormatter = new MsftDiscFormat2Data(); // Interop class for IMAPI2  \r\n...\r\n\r\n // Blocking write   \r\ndiscFormatter.Write(result.ImageStream);  \r\n}\r\n\r\n}","postId":"2013_11_taskrun-etiquette-examples-even-in-92009538-82a4-3754-9963-fbe116fda88e","replyTo":"","date":"2015-07-16T14:41:24Z","timestamp":1437057684,"authorUserId":"disqus:cessna048"}