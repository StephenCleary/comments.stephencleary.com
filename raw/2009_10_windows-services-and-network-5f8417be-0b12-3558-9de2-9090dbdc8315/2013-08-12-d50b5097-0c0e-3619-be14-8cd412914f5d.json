{"_id":"d50b5097-0c0e-3619-be14-8cd412914f5d","authorName":"Suresh Babu","authorEmailEncrypted":"IO2DgYXt44scoSPSCkFF8ckxRMgtqo0YfLCcuiUCOqGitQ0yPEQEMVpDM7tA2KJbqxJ/nOkn72LbIuMNXO43Z4/b/IzXW6RZCCdTka/i77+LZ40aXz1Br6A3V+tF6XkbvDhdGd180MJAgF8yEVNIe8tnWsuGv2PXT8IGdFOXdumZyjAFtXMF5x19mJEHn5Mh40gFE9naDDc5wK1TOu1CpDI2xg7qqyYjLz25g8gvHUKxkQz4dQ/k+SpZjnoAtt3wCUle8NrsPmAh80+vYo/LqcqBv7NerElYyJ5LuBrpS0I6SJGshE8s36YVaKiJi9ro2UHGAgGrr1od/N8mVn+LgRjsQHApQaOKT0nByzngvzc4EEWzCL8prCTlOXme8UdUsRUnExZcyAZ+O1f4vVFAY2F3RB4Ag/76dcJKgh/qhTTWuOctCtxs1KutTWqtmmOVQ/83uW7P5D3VizVbiKOlLZN3K+xpn6DRog+kAXitEeeCxC3zqB/xsYPBnM3MUqWA+c4smzHseVKPKfoEZKeYDEiorc0VTJ/AtWCQ/V+2kK+/YXrZHZ6a6hja4PU7Vfq8kw520RRAT27hvWAodW5XSm48ET4UXTm6ngkEDwXL/RqTWm5Ik3l/SgpwjXRXPW6Fzg8EeLCMALpipurbKzR+WRGu3S8Q4w9y8sGnqQo5VKc=","authorEmailMD5":"c63ccfea17109d095b22c1f192ef0cf7","message":"hi cleary this is suresh   \r\n\r\nWindowservice  \r\n-----------------------  \r\n\r\n private System.Timers.Timer timer;  \r\n protected override void OnStart(string[] args)  \r\n {  \r\n this.timer = new System.Timers.Timer(20000); // 30000 milliseconds = 30 seconds  \r\n this.timer.AutoReset = true;  \r\n this.timer.Elapsed += new System.Timers.ElapsedEventHandler(this.timer_Elapsed);  \r\n this.timer.Start();  \r\n }  \r\n\r\n private void timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)  \r\n {  \r\n EventLog log = new EventLog();  \r\n log.Source = \"suresh\";  \r\n string pathvalue = Pathing.GetUNCPath(Clipboard.GetText());  \r\n if (pathvalue != \"\")  \r\n {  \r\n log.WriteEntry(pathvalue);  \r\n }  \r\n }  \r\n\r\n public static class Pathing  \r\n {  \r\n [DllImport(\"mpr.dll\", CharSet = CharSet.Unicode, SetLastError = true)]  \r\n public static extern int WNetGetConnection(  \r\n [MarshalAs(UnmanagedType.LPTStr)] string localName,  \r\n [MarshalAs(UnmanagedType.LPTStr)] StringBuilder remoteName,  \r\n ref int length);  \r\n public static string GetUNCPath(string originalPath)  \r\n {  \r\n StringBuilder sb = new StringBuilder(512);  \r\n int size = sb.Capacity;  \r\n if (originalPath.Length > 2 && originalPath[1] == ':')  \r\n {  \r\n char c = originalPath[0];  \r\n if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z'))  \r\n {  \r\n int error = WNetGetConnection(originalPath.Substring(0, 2),  \r\n sb, ref size);  \r\n if (error == 0)  \r\n {  \r\n DirectoryInfo dir = new DirectoryInfo(originalPath);  \r\n\r\n string path = Path.GetFullPath(originalPath)  \r\n .Substring(Path.GetPathRoot(originalPath).Length);  \r\n return Path.Combine(sb.ToString().TrimEnd(), path);  \r\n }  \r\n }  \r\n }  \r\n\r\n return originalPath;  \r\n }  \r\n }  \r\n\r\nPlease tel me any wrang in code","postId":"2009_10_windows-services-and-network-5f8417be-0b12-3558-9de2-9090dbdc8315","replyTo":"","date":"2013-08-12T14:17:48Z","timestamp":1376317068,"authorUserId":""}