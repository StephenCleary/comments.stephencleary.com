{"_id":"4bc9cf90-b3ba-34ad-8ccb-d2dc1c15ee2f","authorName":"Thomas Tharp","authorEmailEncrypted":"DjQYzg7f171h9iuMSP8sKDfBI0EQK5Svtnef8sZhCa3kHHp1/uKUu/OxuvePJM4EJCfSrmC5CiNz8tZtle8+KP4IW3NxJc9gDsri2fApa5hy7q9dYhTIJJ7jKfvyCtciUSST338bC5omPLqrRsItrtzjZiHMhmL5S4B9AuXcJ13qYlRRgRrlL/7M6H1gbLuwoclY2mPt5F7rSHO68C1kb4DVsr7nT5L9FTtoAhfXv6/J2Hy6hSi+z40AdaZs3eRL2OycHUHgeU9e4i4hFrbOVCWbabzYxNW//S3w3gqltSaeIr4LwS4WLJXcoxMZxL4fKjN5GOkaHSEFOQA/h9RAupCPPl25uWMZTGdwycVhU8ag+1mMiHupSVb4mfO+lt5wKLRvGjG1MBzf+6leK+yGsGqb06XYXJsyuwK+J4p3SZY3mJ0zkkKrI2AtOHOQj3WSt+SlXzx7724qOjMqMqVjH1pQRCxxxFkvmnRMxJLBqbBdudH+ajYOw4CJYqyyUtee6JroXE10yXFuM/ECx/hDA0B0hTve/mBrtKTo5ZneasxZGgYpp5CH08U2+RUA3yY7p2NHAI4yYtT6aVyE9IYFqjWVrTPiMJeC57hKJkL99SS1PUg3orpQTjf13vYMLKY9ZtOwXwqmt4Ie4mdQzfDaLpD4PDjXeUI3g7PsydbfcxU=","authorEmailMD5":"3190c7cb5200e38ef7d74502562371ba","authorUri":"","authorUserId":"disqus:thomastharp","message":"Hi Stephen,\r\n\r\nI have a case where there is a database query that is naturally asynchronous, and potentially long running. However, there is also non-trivial CPU work in the processing of the query results (~200-500ms per query). On a load of my ASP.NET page, I may have to do a few dozen of these queries, all of which are independent.\r\n\r\nMy question is, what is the right way to make these queries parallel? I control the API, so I can change it as much as I want. Originally, I had everything (including the database call) wrapped in Task.Runs, which guaranteed the parallelism that I wanted, but obviously killed scalability (the site could scale up to a few hundred or a thousand concurrent users).  \r\nI then changed the API to make everything naturally asynchronous, which helped reduce thread-count, but ultimately negatively impacted performance for the low usgae scenario (as the CPU bound work was no longer done in parallel).\r\n\r\nIs this a case where it would make sense to use Parallel or Task.Run at the top level, to make sure the CPU bound work is actually done in parallel?\r\n\r\nThanks,\r\n\r\nTom","postId":"2013_11_taskrun-etiquette-examples-dont-use-a63e8aa8-3250-37a4-990d-af802d3197e6","replyTo":"2ed7433c-8e66-38cb-a92a-275995b10f32","date":"2015-03-10T17:33:11Z","timestamp":1426008791}