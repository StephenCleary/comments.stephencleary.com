{"_id":"3e4d0b40-3b80-11e9-97f7-73cce500929f","postId":"2016_11_streaming-zip-on-aspnet-core-66a49df2-4f92-385b-8999-87a9f3054346","postUri":"https://blog.stephencleary.com/2016/11/streaming-zip-on-aspnet-core.html","replyTo":"","authorEmailEncrypted":"","authorEmailMD5":"","authorName":"Francis","authorUri":"","message":"Hi, im trying to use this example to download a existing folder into a zip file\r\ni've done the following\r\n```c#\r\n FileCallbackResult result = new FileCallbackResult(new MediaTypeHeaderValue(\"application/octet-stream\"), async (outputStream, _) =>\r\n            {\r\n                using (ZipArchive zip = new ZipArchive(new WriteOnlyStreamWrapper(outputStream), ZipArchiveMode.Create))\r\n                {\r\n                    foreach (string filepath in Directory.EnumerateFiles(existingDirectory.FullName, \"*.*\", SearchOption.AllDirectories))\r\n                    {\r\n                        string relativepath = filepath.Replace(existingDirectory.FullName, string.Empty);\r\n\r\n                        ZipArchiveEntry zipEntry = zip.CreateEntry(relativepath);\r\n                        using (Stream zipstream = zipEntry.Open())\r\n                        {\r\n                            using (Stream stream = new  FileStream(filepath, FileMode.Open))\r\n                            {\r\n                                await stream.CopyToAsync(zipstream);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n            {\r\n                FileDownloadName = $\"{package.FileName}.zip\"\r\n            };\r\n```\r\nIt works as expected and i'm able to download the zip file from an angular app using \r\nhttp.resquest(method, url, option) but when i donwload the file and i try to extract it on my computer\r\nwindows says : The compressed (zipped) folder is invalid\r\n\r\nany idea why?","date":"2019-02-28T17:42:40.460Z"}