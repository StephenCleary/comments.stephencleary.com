{"_id":"e2471932-0168-331c-92ff-f02b14a1aa76","authorName":"Riko","authorEmailEncrypted":"qDRyDil2pyI/82lwz633h0gTskuc7vqtCDW23MYfB1FS9/wyzqFM8tuA6U4Bk3cIyUsB9LwNIU98v/+J4WYeHt94VSOjI3eyWRHILyeWZeAW0lL+O7fWCiFSDSmTagppYpTDcA+kzqPfReQjI/xmgnxU67VsfqF8Kqy4BcIDsjCkBilrQGbgemnHbiOZp65wtPGgzQz0jMe17LSbz4RWsk5HEPFbK7l+ieq8zzHHDJY+jnt1C6eY+NVy5pGKHathL2UqJ/oy/K4PTw5SfrtmX4UndaDPu8FK2F3zWaWh5bS7aCk/yFSlI5tSfmbrbB8TPl4xLcY17T3e4t56kE4llL+4YuRnzCPqXMst9+g2ivSpKk1J5KNCg7/p/d8OQ+sHFKzlleSf5zNvyHwA8kUcJr9j9UMowqgX7nAyOjSVTVNFA+EWPQ1emq0NVGS8OiJP6LwCkPHAvUWw1f28O0RNzvv3A63aIEo1UrnTFFxknAjkSKmywezuuhA92on4Ex1Cd0PQls/5cwdbYk0opheVqm0WuUixjWTySJPXQNk1sYz7U3Xub0MU29Zf54eVOCWK5fZAbcqJZBrPd9UNFDFrQf9ostDL6k4VEa3EnsgqUR1/ZnFl3/01LQVbyWnttbST1QnuTY8PRFe/TknAKXrpiazyDGdUl5IT1PlBS9+77H8=","authorEmailMD5":"c1b99fc51717f507f13d0e2297a64fdc","message":"Hi Sthephen.\r\n\r\nCan you, please, help with Console project ?\r\n\r\nI have a few questions. And can you help make this code better (especially the part about working with the console).\r\n\r\nHere is the code:\r\n\r\nstatic void Main(string[] args)\r\n\r\n {\r\n\r\n CancellationTokenSource mycts = new CancellationTokenSource();\r\n\r\n var task1 = Task.Run(() =>\r\n\r\n {\r\n\r\n // doing some work, that can throw exception\r\n\r\n Thread.Sleep(1000);\r\n\r\n // how to avoid closuring ?\r\n\r\n mycts.Token.ThrowIfCancellationRequested();\r\n\r\n throw new InvalidOperationException(\"test\");\r\n\r\n }\r\n\r\n )\r\n\r\n .ContinueWith((_) => mycts.Cancel()); // need caching for this task ?\r\n\r\n var task2 = Task.Run(() =>\r\n\r\n {\r\n\r\n // doing some work, that can throw exception\r\n\r\n Thread.Sleep(1000);\r\n\r\n // how to avoid closuring ?\r\n\r\n mycts.Token.ThrowIfCancellationRequested();\r\n\r\n throw new InvalidOperationException(\"test\");\r\n\r\n }\r\n\r\n )\r\n\r\n .ContinueWith((_) => mycts.Cancel()); // need caching for this task ?\r\n\r\n // I do not know how to do better with Console !\r\n\r\n var consoleTask = Task.Factory.StartNew((cts) =>\r\n\r\n {\r\n\r\n Console.WriteLine(\"Press Enter to exit\");\r\n\r\n Console.ReadLine();\r\n\r\n }, mycts)\r\n\r\n .ContinueWith((_) => mycts.Cancel()); // need caching for this task ?\r\n\r\n// We are waiting for the Completion or Exception  \r\n Task.WaitAny(task1, task2, consoleTask);\r\n\r\n // We are waiting for the completion of workflow  \r\n Task.WaitAll(task1, task2);\r\n\r\n // WHY this task is not Faulted ?  \r\n if (task1.IsFaulted || task2.IsFaulted)\r\n\r\n {\r\n\r\n //log\r\n\r\n }\r\n\r\n //Exit  \r\n }","postId":"2015_05_thatconference-1a3e1f0e-197f-34d4-857c-efaba4a4a73c","replyTo":"","date":"2015-10-06T09:06:14Z","timestamp":1444122374,"authorUserId":""}