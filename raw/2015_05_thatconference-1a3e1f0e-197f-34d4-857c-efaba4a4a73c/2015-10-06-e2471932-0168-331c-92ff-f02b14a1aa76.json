{"_id":"e2471932-0168-331c-92ff-f02b14a1aa76","authorName":"Riko","authorEmailEncrypted":"OlpbnbL5XsmI1cDOo2ZVVBWXXZxFrnQ9kBb4cvmg5JoymwB973en6zbrCZVlIzKDGEsIcBOJxKdaS5PT3xA4WhlB0ZALKWyNCHu8UN7iNq9pHIkXHwB6zl2cJKqAkLENFeO0DPRlRs5aKDG+0xFrcCvOwSkV8MILIiY7FKqY+DHZk2nkTywF7tKlsLVV0FRLuNkRGG4h8HwC3I8o04mCg+QBq5gOm0zrCZU+C9ftJo57N8cVIt3AFdgCHp9TlTe3ndZyIDuKEn0LSGM28EXrWx3r/zNKF8ANqn0HIOUyllRkPk0XVPoqIUGJA20J6DaO7gMWLQkccpatDnbTh2GNiLjUikEtqBWAlhiskCKmqIeQfXRax6eraf8Fs4+sau03mJQX6E9hk7w5Nyti4Kr9Q29On8UNqieU92bDEmwdJ/CpfYU/rDOG76SxE0I2zch4FK+e4hP2pE1/FFTgYPRNmQvw1a8zgn2Qz0q0U1CQpqS4QStQcXgvn3jeGN4F/QovMvOiRM8OSXzYEssQaBjigp3PCDNRrwsiz4FI8ZQOZMJBMAmlGhbBLZ/T3mE6P8UpvJ7BqC5vkw6XDENoYTr8LrFEtF2m3VAzBe9nw3iPq6Rz4dwT+gDtttrjupKjKAKauVRUEh0IOAROT6pl4bF21DlsRrTHiBVY+QolA7G/F6I=","authorEmailMD5":"c1b99fc51717f507f13d0e2297a64fdc","message":"Hi Sthephen.\r\n\r\nCan you, please, help with Console project ?\r\n\r\nI have a few questions. And can you help make this code better (especially the part about working with the console).\r\n\r\nHere is the code:\r\n\r\nstatic void Main(string[] args)\r\n\r\n {\r\n\r\n CancellationTokenSource mycts = new CancellationTokenSource();\r\n\r\n var task1 = Task.Run(() =>\r\n\r\n {\r\n\r\n // doing some work, that can throw exception\r\n\r\n Thread.Sleep(1000);\r\n\r\n // how to avoid closuring ?\r\n\r\n mycts.Token.ThrowIfCancellationRequested();\r\n\r\n throw new InvalidOperationException(\"test\");\r\n\r\n }\r\n\r\n )\r\n\r\n .ContinueWith((_) => mycts.Cancel()); // need caching for this task ?\r\n\r\n var task2 = Task.Run(() =>\r\n\r\n {\r\n\r\n // doing some work, that can throw exception\r\n\r\n Thread.Sleep(1000);\r\n\r\n // how to avoid closuring ?\r\n\r\n mycts.Token.ThrowIfCancellationRequested();\r\n\r\n throw new InvalidOperationException(\"test\");\r\n\r\n }\r\n\r\n )\r\n\r\n .ContinueWith((_) => mycts.Cancel()); // need caching for this task ?\r\n\r\n // I do not know how to do better with Console !\r\n\r\n var consoleTask = Task.Factory.StartNew((cts) =>\r\n\r\n {\r\n\r\n Console.WriteLine(\"Press Enter to exit\");\r\n\r\n Console.ReadLine();\r\n\r\n }, mycts)\r\n\r\n .ContinueWith((_) => mycts.Cancel()); // need caching for this task ?\r\n\r\n// We are waiting for the Completion or Exception  \r\n Task.WaitAny(task1, task2, consoleTask);\r\n\r\n // We are waiting for the completion of workflow  \r\n Task.WaitAll(task1, task2);\r\n\r\n // WHY this task is not Faulted ?  \r\n if (task1.IsFaulted || task2.IsFaulted)\r\n\r\n {\r\n\r\n //log\r\n\r\n }\r\n\r\n //Exit  \r\n }","postId":"2015_05_thatconference-1a3e1f0e-197f-34d4-857c-efaba4a4a73c","replyTo":"","date":"2015-10-06T09:06:14Z","timestamp":1444122374,"authorUserId":""}