{"_id":"e2471932-0168-331c-92ff-f02b14a1aa76","authorName":"Riko","authorEmailEncrypted":"lZmLG9Tx+xOwqYUtFaH5G4t0HVTvIqihrLpnPAVy/A8xz8spamQTfjNSHQ6Q1JJR1WFulWYkkeW+yJu838FsuVeC6801VuZrxZBcPUgSuVntQZxGNaCygnD2lncvGKL7fAHJ/dcrVX36UAQGcNXPhkbQhXRKfSFgWdckXsVkTWZ3+974AENWj2yDz/BqRtEt7IYt+53piKh1ZXIR12i0Wexi8vTMbEmTfhe3ZNmjbgCDJkU4UsEqQ0oQwbar1QPhEvBMdej9OCWBYOoSTkWMpTRKoetVaiSdrkOlOWl37HunNe7oKm70pLOEJZgKYKU3YmJQc8ybU7Aokg3HlPLaZ0Z+Ne1EcXYIIgzgsonxeIXy+TzQA2qHfIkdCuWaShfKOmjN0NKD0oeWLY2UCceXHmjoCQ8bm+FIpjQoGsWQnybEr94KH7YKJGOvHIAsRSj7ONRuMG9ieBulMJkA9VPjOLMWlTfDDvRWozj0Mo74oxIVbDWFawZQjYIemsiHGhXqvxD+wwZLz5/r6R2ixOA/G6Au+B9PJ8q6mSKHKlh0cY+RdHc3xoK+ovTLgou5bSC0wT5xQ76Ant+DqxEOy+YMCf73tE6ncyxBhILanzw2B15hyRh+svaJVXzfaM331W1NGtrk9dBU+Oj6hwu5WHn3SR8Fh0Q530l42Bh1u7exFJo=","authorEmailMD5":"c1b99fc51717f507f13d0e2297a64fdc","message":"Hi Sthephen.\r\n\r\nCan you, please, help with Console project ?\r\n\r\nI have a few questions. And can you help make this code better (especially the part about working with the console).\r\n\r\nHere is the code:\r\n\r\nstatic void Main(string[] args)\r\n\r\n {\r\n\r\n CancellationTokenSource mycts = new CancellationTokenSource();\r\n\r\n var task1 = Task.Run(() =>\r\n\r\n {\r\n\r\n // doing some work, that can throw exception\r\n\r\n Thread.Sleep(1000);\r\n\r\n // how to avoid closuring ?\r\n\r\n mycts.Token.ThrowIfCancellationRequested();\r\n\r\n throw new InvalidOperationException(\"test\");\r\n\r\n }\r\n\r\n )\r\n\r\n .ContinueWith((_) => mycts.Cancel()); // need caching for this task ?\r\n\r\n var task2 = Task.Run(() =>\r\n\r\n {\r\n\r\n // doing some work, that can throw exception\r\n\r\n Thread.Sleep(1000);\r\n\r\n // how to avoid closuring ?\r\n\r\n mycts.Token.ThrowIfCancellationRequested();\r\n\r\n throw new InvalidOperationException(\"test\");\r\n\r\n }\r\n\r\n )\r\n\r\n .ContinueWith((_) => mycts.Cancel()); // need caching for this task ?\r\n\r\n // I do not know how to do better with Console !\r\n\r\n var consoleTask = Task.Factory.StartNew((cts) =>\r\n\r\n {\r\n\r\n Console.WriteLine(\"Press Enter to exit\");\r\n\r\n Console.ReadLine();\r\n\r\n }, mycts)\r\n\r\n .ContinueWith((_) => mycts.Cancel()); // need caching for this task ?\r\n\r\n// We are waiting for the Completion or Exception  \r\n Task.WaitAny(task1, task2, consoleTask);\r\n\r\n // We are waiting for the completion of workflow  \r\n Task.WaitAll(task1, task2);\r\n\r\n // WHY this task is not Faulted ?  \r\n if (task1.IsFaulted || task2.IsFaulted)\r\n\r\n {\r\n\r\n //log\r\n\r\n }\r\n\r\n //Exit  \r\n }","postId":"2015_05_thatconference-1a3e1f0e-197f-34d4-857c-efaba4a4a73c","replyTo":"","date":"2015-10-06T09:06:14Z","timestamp":1444122374,"authorUserId":""}