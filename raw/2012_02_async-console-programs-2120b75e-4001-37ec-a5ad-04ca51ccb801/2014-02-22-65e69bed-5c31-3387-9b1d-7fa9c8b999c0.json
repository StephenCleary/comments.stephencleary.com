{"_id":"65e69bed-5c31-3387-9b1d-7fa9c8b999c0","authorName":"Prasanna V. Loganathar","authorEmailEncrypted":"jxW0/XNWHuyUs074+S6gOA2AnMvtkT9AcC1UN24v9Sks1SMslCNAbsG6DpMDYjxJfDesEQVvyIPKTbaYShPPiu0+u22G3XAGhiUFs/tLUiFJJlSd3j9UDbdJnidje0fVbCYPAO4i+GCFRfiOjq+idWFVPMmI2gTx5iQ2QWSec/mJA9q0nIREtTXwn0Sj6P5a8q84DVbejFbphfx0MCkV/w33KEaj6syJHgPl8w7mRZuotmbBM2fFyutysJM4ct9v56Yiky8jgbeNldcl44o2w7bM3mTuo0DMST9ISFZBeQhIXy5lgQ9Xjb8ukHANRByYXFer6Rb7kX34ojnfi2WwgNt4wFJ3qq3S1TyEQEi69Afha+7K/emTMcCIQAiL5iREh6MCwivxd9i1lKsMZsnzIAJyoTB1hUBo465e32lETgj2YNhaV948to9wU1j1peePK4MkjyJJgAOZgET983JpnhU6VrHgjGwBo7fL+zLrz6xP93GtuQvfrK8HHQsDlXa5EkZlgWB+a/R+fKb+PX92ns05kdXZmtynuIGBukldDvTwVFlyKH1NWazUc/w8hQzfUfIggMbPeRZQbpa7w6F3l5tFsjSWlbGp8pdPkTDoOTHxDM3fwhiWoT4HxytWm9LoyFodGWFrwQ5U5KKQrjmu3vok1AwTThL2306LNlz3sKA=","authorEmailMD5":"e60d651d102f89261628b097e87bbc59","message":"Hi,   \r\n\r\nI was playing around with the AsyncContext, and suddenly, got into a situation which I couldn't explain. I've written a simple example below. All the tasks below seemed to execute as expected, until I put in the Console.ReadKey there. It seems the tasks complete, only when the AsyncContext ends. Am I missing something?  \r\n\r\n public class Program  \r\n {  \r\n private static ThreadLocal _localStr =  \r\n new ThreadLocal(() => String.Format(\"Hello from Thread: {0}!\", Thread.CurrentThread.ManagedThreadId));  \r\n\r\n private static void Main(string[] args)  \r\n {  \r\n Nito.AsyncEx.AsyncContext.Run(() =>  \r\n {  \r\n\r\n Console.WriteLine(_localStr);  \r\n\r\n Task.Factory.StartNew(() => Console.WriteLine(_localStr), CancellationToken.None,  \r\n TaskCreationOptions.None, TaskScheduler.FromCurrentSynchronizationContext());  \r\n\r\n Task.Factory.StartNew(() => Console.WriteLine(_localStr), CancellationToken.None,  \r\n TaskCreationOptions.None, TaskScheduler.FromCurrentSynchronizationContext());  \r\n\r\n Task.Delay(100).Wait();  \r\n\r\n Console.WriteLine(_localStr);  \r\n\r\n Console.ReadKey();  \r\n });  \r\n }  \r\n }","postId":"2012_02_async-console-programs-2120b75e-4001-37ec-a5ad-04ca51ccb801","replyTo":"","date":"2014-02-22T20:25:23Z","timestamp":1393100723,"authorUserId":""}