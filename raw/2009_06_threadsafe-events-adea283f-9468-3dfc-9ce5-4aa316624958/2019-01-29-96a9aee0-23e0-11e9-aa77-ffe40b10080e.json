{"_id":"96a9aee0-23e0-11e9-aa77-ffe40b10080e","postId":"2009_06_threadsafe-events-adea283f-9468-3dfc-9ce5-4aa316624958","postUri":"https://blog.stephencleary.com/2009/06/threadsafe-events.html","replyTo":"7a00e600-23db-11e9-aa77-ffe40b10080e","authorEmailEncrypted":"SzIAdE8M93Gc4Un3PZAb+wN5+pQyDPAbWsV/bp5RTUfw1gQNBZcnRmfrKgPJtMkTQl9aO3x3igVp01Axv+RxeCaa8YYKL3nBkdy+X8KP8P3YVUVisLOANnZ/JRRW7RVrSB1tssycIa8lL+uKAe+U+BRumxPq/gop7oa9yQY9IRuBj2uSzhFC3QKeJBrnUUb4tK+SSv5BwgF3FwlrkdqZMMiRjmfmLamh6uwGsh0nUOeQkPFTUOSC/HwDfGCeWMAZlhgGugdv1n/jxymyGYYrX6LVuDNv5aezIOyOMkfAb7eDUTrJHwK6LETQl4fJW+Qw8p3RbRZI6Xfz/Uh1MRHFYniJsoafL6r2osGVQ7TBFx7hKnuGEYEky/jUHmqXSvhrQuXvYHHz57yVWehwJ5bJvzgW5pd54WqlWYgir+QILvrtWHXK14Fm2WZKRSpVMKJAL093+uelB3i90ryyUiqUFDACYEE9dRNt46BeBqDnz17PGg2oSH8IDISpz/qQLcloG7i/2qhfMyohTFWiCn5xvE0cgQE9bT1F1AxSlnlYPv4nmGSPdxRLEIUeZhLchRr6X4ovpSJnJ1lEr/qsFCBnkU/f6XymRySg9PwpeJgQVToCK0hK8tqAXJErXq8qI605Lm3YukTqhWfBt3AbyZxjW0EGJKs1nrn7hKABm2w0hUc=","authorEmailMD5":"23448e78d187fba56d8bc263081ac5d8","authorName":"Stephen Cleary","authorUri":"https://stephencleary.com","message":"In his article, he states:\r\n\r\n> The temporary variable ensures that this is “thread safe”.\r\n\r\nand then later states:\r\n\r\n> You've got to solve both problems if you want to do threadsafe events.\r\n\r\nI.e., the temporary variable is insufficient to make a threadsafe event.\r\n\r\nMost of the confusion around this issue is around the question \"what does threadsafe mean\". And both of our articles agree that there is *no way* to make events threadsafe just on the producer side. Eric's second statement sums that up.\r\n\r\nEric mentions a solution you could make on the consumer side, but it's not easy to get right (or even to know you need to do it).\r\n\r\nIn my opinion, the core issue here is that C# events are rather poorly designed, and lead developers into a pit of failure as soon as multiple threads enter the mix. `IObservable<T>` is how events *should have been* designed; it provides a new producer *and* consumer pattern that is truly threadsafe. In my own code, I *only* use events if they are always raised from the same thread; that way, thread safety is trivial.\r\n\r\nThe only point in which Eric and I disagree is whether the temporary variable is useful. It is useful for avoiding null reference exceptions when using cross-thread events, but it is not sufficient to avoid race conditions when using cross-thread events (we both agree on all this). I always recommend not using cross-thread events *at all*, in which case the temporary variable is not useful. He recommends allowing cross-thread events, with the understanding that your event handler must have special logic to detect and handle race conditions.","date":"2019-01-29T16:11:52.502Z"}