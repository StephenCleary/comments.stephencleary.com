[{"_id":"d50b5097-0c0e-3619-be14-8cd412914f5d","authorName":"Suresh Babu","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"http://www.blogger.com/profile/09633822600873953251","authorUserId":"","authorFallbackAvatar":"","message":"hi cleary this is suresh   \r\n\r\nWindowservice  \r\n-----------------------  \r\n\r\n private System.Timers.Timer timer;  \r\n protected override void OnStart(string[] args)  \r\n {  \r\n this.timer = new System.Timers.Timer(20000); // 30000 milliseconds = 30 seconds  \r\n this.timer.AutoReset = true;  \r\n this.timer.Elapsed += new System.Timers.ElapsedEventHandler(this.timer_Elapsed);  \r\n this.timer.Start();  \r\n }  \r\n\r\n private void timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)  \r\n {  \r\n EventLog log = new EventLog();  \r\n log.Source = \"suresh\";  \r\n string pathvalue = Pathing.GetUNCPath(Clipboard.GetText());  \r\n if (pathvalue != \"\")  \r\n {  \r\n log.WriteEntry(pathvalue);  \r\n }  \r\n }  \r\n\r\n public static class Pathing  \r\n {  \r\n [DllImport(\"mpr.dll\", CharSet = CharSet.Unicode, SetLastError = true)]  \r\n public static extern int WNetGetConnection(  \r\n [MarshalAs(UnmanagedType.LPTStr)] string localName,  \r\n [MarshalAs(UnmanagedType.LPTStr)] StringBuilder remoteName,  \r\n ref int length);  \r\n public static string GetUNCPath(string originalPath)  \r\n {  \r\n StringBuilder sb = new StringBuilder(512);  \r\n int size = sb.Capacity;  \r\n if (originalPath.Length > 2 && originalPath[1] == ':')  \r\n {  \r\n char c = originalPath[0];  \r\n if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z'))  \r\n {  \r\n int error = WNetGetConnection(originalPath.Substring(0, 2),  \r\n sb, ref size);  \r\n if (error == 0)  \r\n {  \r\n DirectoryInfo dir = new DirectoryInfo(originalPath);  \r\n\r\n string path = Path.GetFullPath(originalPath)  \r\n .Substring(Path.GetPathRoot(originalPath).Length);  \r\n return Path.Combine(sb.ToString().TrimEnd(), path);  \r\n }  \r\n }  \r\n }  \r\n\r\n return originalPath;  \r\n }  \r\n }  \r\n\r\nPlease tel me any wrang in code","postId":"2009_10_windows-services-and-network-5f8417be-0b12-3558-9de2-9090dbdc8315","replyTo":"","date":"2013-08-12T14:17:48Z","timestamp":1376317068},{"_id":"0a5c7b20-cbb8-350e-a3f2-296bfb23ede9","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"As I explain in this blog post, Win32 services are not supposed to use network connections. They can use UNC paths, but you have to do that kind of translation in an application running in the user's desktop. If you have a tray or background application translate the network drive to a UNC path, then it can pass the UNC path to the Win32 service. But the service itself cannot do that translation.","postId":"2009_10_windows-services-and-network-5f8417be-0b12-3558-9de2-9090dbdc8315","replyTo":"","date":"2013-08-14T06:06:01Z","timestamp":1376460361}]