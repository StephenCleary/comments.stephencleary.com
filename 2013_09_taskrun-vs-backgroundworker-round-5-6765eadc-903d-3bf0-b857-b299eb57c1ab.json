[{"_id":"ddb8d9c7-1b35-32fb-ae50-7219421a97f0","authorName":"http://devtools.korzh.com/","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"http://devtools.korzh.com/","authorUserId":"","authorFallbackAvatar":"","message":"NIce comparison, interesting.","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"","date":"2013-10-03T18:36:27Z","timestamp":1380825387},{"_id":"4a19b4c5-6082-3004-860b-cf931c8402db","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"I was trying to stay close to the normal usage without actually breaking the background code off into a separate method.  \r\n\r\nThe more normal way of doing this is to have the Task.Run lambda as a separate method which would take an IProgress argument. The caller constructs a value of Progress. Progress exposes the \"caller\" side of the API, and IProgress exposes the \"consumer\" side of the API.  \r\n\r\nSo the conversion of \"progressHandler\" to IProgress simulates the conversion that happens during the method call.","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"","date":"2013-11-11T17:29:03Z","timestamp":1384190943},{"_id":"5481b8f4-32d1-3ee8-993a-6b184406bc89","authorName":"Icosa Deca","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"http://www.blogger.com/profile/08774539440721674414","authorUserId":"","authorFallbackAvatar":"","message":"Great article. Was there any particular reason why you didn't initialize the progess local variable in one go?  \r\n\r\nIProgress progress = new Progress(value =>  \r\n {  \r\n label2.Text = value;  \r\n });","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"","date":"2013-11-11T14:19:24Z","timestamp":1384179564},{"_id":"0d69c896-10c7-37a5-a924-c175a8a6f49f","authorName":"Mickey ","authorEmailEncrypted":"k5v5Zw4vcjRmkGH/Y7ucHaOrNxQypllJDAB/+Zh3yjhlmhhwwim0Ji9KVqKbBXBdVNbIiW+SUOZnsp6EWx18a5eVeR73KxjK1PH5RBmWISwoNbSnb4e+B7WLTz/gpzVUTXnQIDGb2FAnVz0mTjEUHTUMf6jgw81eB9Ayx3nVYM8m2J42t6svJa+46mz3W1Dn0znfvWiaxH02AN5KOOyN+cXt7jXYNgtmHlxDKEYP0bYIeZW1dZuRaZwJTygr7vYHZ4+3ibqLd7eq8kKyFAf7cHTfG6BVHojL/+kSNqRGmcShMP8lXD4OB8pdkAdwViTjfg+FfoIdKib5i78r8ng4B3X4yJT183c1AE2Hz7j130zEZ0MCi9QuOJIU9otF52XOTToLeUF3fbIwdUrHSDkammoAbfhBoPTSJBuk81uewNMvfLHac5FnKDWCdmMrVSRcIXHNa0IsNP1+TWg282+ovY2vXg90KND6ilmZ9CkHjJc36cO6I9sINOYFkFPPMQxqLAsgR9bveDcxziV15fHWt8d4GIuR5jJz2Jsrtvk2O8NvWVFDRg3OMze1Vhc1MVRmqz7KKMWbsGIFLtEBVvHSTQaciqx26kVKegvIuxsbcPsOMfOUPIVPt0k3XtPrJnhYLPxXWGS7+WJDf2m8nmL2FZdnsyRLwYaKFy9gy7d6C9I=","authorEmailMD5":"17bab64544dd57b68a7ad39d6fb0ced3","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"Great article. I really liked your comparrisons and your wit ","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"","date":"2014-12-15T20:27:26Z","timestamp":1418675246},{"_id":"424bf94c-1522-3040-b6a4-a5ef95b5f442","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"Your code is reading the file from a thread pool thread, and then reading the file again from the UI thread.\r\n\r\nIf you want to just read the file from the thread pool thread, use `await Task.Run`, as such:\r\n\r\nvar dt = await Task.Run(() => _sourceService.ReadFileContent(filePath));  \r\ndataGrid.ItemsSource = dt.DefaultView;  \r\nDataTable = dt;\r\n\r\nif (dt.Rows.Count > 0)  \r\nBtnCreateXmlFile.IsEnabled = true;\r\n\r\n(Tip: you should almost always use await instead of ContinueWith)","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"9cd50358-8e36-33da-a097-bdcb54cde63e","date":"2017-01-31T13:55:11Z","timestamp":1485870911},{"_id":"9cd50358-8e36-33da-a097-bdcb54cde63e","authorName":"Rozsos Antonio","authorEmailEncrypted":"NeSmvjeBDlRVlrR7xGm8/YXmRPhvC2y6ZAh1mAo+6zcq0zRUZP3lepRysu1N/zArXvBsEOUuQKeTAwQJ9Gv8WAWJLSjEHq0dDma1703uQvFX13mJGd4EfQHXyccrvqf5waeW4oicXBaalxUxU4y7aG2Y82aq24QxYAxEEZM0a6jjtZEBN5dt7JZWiHSpBZNKsSWWdfYGl0+k3SGLLfS9GkzyZORqX4Q+UXcxrvFs3J+jHNTVKWvYMaSbv48XAwbPIB7CySDdJK9Rbh04vRpt/Utq6rzAsq4Jo1PwXI8lxTymWzauVWMHqbM3ooJsGOVE9cEOeL/TWhYuBAzIpoJFStpN4ZTA2toPUGzpHFr0TSgGyx6FaSAgmCctboPvaZjS9gYIqyXybgphz2TxkIRA54Z9i09KXd9GT62FKvbVQ4flok+gq11fc+3fG+fTF/tFe5Y33BN/Cebu5HEuDlNfyuA7MqxhTGG0+uRegETExAyj6PlxlM5Z2t7rsrqzgkVe7EChTelJ+iO0iuPR76cBZISEmreBDjyEZ9YdQnaBiVwb698HXU+Tcd1wBIqDEVQEHXl/ll7vkc/4wVhSM7nAuJHu8VxIya5VpBIB2hBcsSHSwOgea57PtXqVxAoK7Ty+VIn+vAx5ODpqDPR3MEOqyH0zUAFck5ieyUv7/vjjh8Q=","authorEmailMD5":"85374bf6705e6ef24e2e9f9507057250","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"Hi Stephen, I really enjoy your articles here and also on Stackoverflow. I have one question regarding the reporting of the progress using a Task.Run. With the help of your articles I have managed to implemenet a Task.Run from the button event. Basically it reads a large Excel File without the UI Blocking. The thing is this is done in a Service Class and I have no idea how to report from that service class back to the caller.\r\n\r\nThe code looks something like this:\r\n\r\nTask.Run(() => _sourceService.ReadFileContent(filePath)).ContinueWith(task =>  \r\n {  \r\n var dt = _sourceService.ReadFileContent(filePath);  \r\n dataGrid.ItemsSource = dt.DefaultView;  \r\n DataTable = dt;\r\n\r\n if (dt.Rows.Count > 0)  \r\n BtnCreateXmlFile.IsEnabled = true;\r\n\r\n }, CancellationToken.None, TaskContinuationOptions.None, TaskScheduler.FromCurrentSynchronizationContext());\r\n\r\nAny hints will be gladly appreciated.","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"","date":"2017-01-31T07:36:28Z","timestamp":1485848188},{"_id":"eda7628a-12f2-3b68-976e-8a8bd77b70d2","authorName":"Robert Mirabelle","authorEmailEncrypted":"ePJfmPhRRwFX1wdRyC/XSDIe3+iMy7gMh9XOvlE9rWBMv6szAd6WN+Wqi/dctqmdmp0IXoXXttZzYTqEc/16dWXDJ2qKdEsE1yzQ6ucIgdztnECXmuKO+fBoGFBAG6RCi1sLXnIJsv+4s3Xl3tzJbO1SMPGsP/hVRC37PMC5s9Z5+JaxParZ1FXhKQYOnx6KjV7vF2t4yKBMtyHnipnC/oXieAn6dBYk9qa/YzZY0eLivWNCGUj9SmKYnv0+mlXMNvd2sy/XltgKq4LaxIX8Qh2TMRyk2iLspSIKjeJZGDk7ZiTbapfkcGcvUXUQYntbnJR+rdJlM6cZUCaWx78JKn4K0s/C9gzlS+HLrDcWLxuypEexBXtYfoobPrDqlIh5SZrhJWdx2B3oUoBKlzfzchGpkbNHQJkCtg/7MW7ELiX6dZMBAXLL3d8E3WtxuLVQPMCvOZQe7yYI2YebWE/1oEwjYcCPE/EnBO3v6Kisn8TXOZKcPyOJQUWoGYp0WuBYmKKjGMQQTUympCxRRrg4/NmfGsowMqm4VDc6GD+vkojsVgrvoDli6I4+LVmEs4/km33vIySJol9zYaRQ76JiZ+UJ0xTvxQucU3P+9FTvoyjbG2yppVhdfs5sN5dd8MRcvnMiay6Zl9ccsrAs9LECqszXhhqq6R7BwSQa1pARE7Q=","authorEmailMD5":"a00127568b70da5b09210c50b0504042","authorUri":"","authorUserId":"disqus:robertmirabelle","authorFallbackAvatar":"https://disqus.com/api/users/avatars/robertmirabelle.jpg","message":"My first time seeing IProgress and it's just what I needed - thanks for this article and in particular the generalized/oversimplified implementation of IProgress.","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"","date":"2017-02-09T21:17:11Z","timestamp":1486675031},{"_id":"10663731-7648-36e4-ab30-1f4930ffffc0","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"[https://msdn.microsoft.com/en-us/library/cscsdfbt.aspx](https://msdn.microsoft.com/en-us/library/cscsdfbt.aspx)","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"f30bafa8-36bc-3853-89a7-430c54f21a0c","date":"2017-03-06T16:48:06Z","timestamp":1488818886},{"_id":"f30bafa8-36bc-3853-89a7-430c54f21a0c","authorName":"Juan Carlos Oropeza","authorEmailEncrypted":"tixFDno0OgBaMRLz3gZrp78M0vcY+C13eUPHjPyDefmHD2npG09PiBZeHcG4HtARFn6okqpK+uX8fRZ9TJyF0PmrW/aYMjlxuWv+s1nXiPg9Yn119wBcxIQhPR3i91pxvVwtFQ6Iggnjt6cGhW1vCUEANPG24kbgi/+32bEcZuQO2TDY4EluR9qSbfWiW8DHAyZke/EIaMRNe21159Tg7Sm7vMHFk3Btb0EgN+SAyuoi7tmGyme/yNsbFbjvVTuaGv/9XTyUh7X3+OKBNaSdWHyGXzxyFKCiC6MNXDZhmL1HBixscxQqNMdPxNxXFGUUJJXhSKj4Tg3wq7AdWYtwM/gvN1SdV+jmEAaYjMZwegdbF8tu0KHkLiPVZ24+HFyqU5MUXvfBNsO8eXuYgtVZ1wcBCbTFCo3YJdmauv5GHT6Anpl4+oe8jM8uy2K782GHFxvyzdcnQ55IkvCKeXyJ0ZJmO9aQdk0DMuZ+RxaVAP8RsCmZR9YsPQRCAjgpyMzcMTuTYw/T1HhgaH7ZnY6zuztk8hS410K29yBROatjyMC/5mv/7RtG1vmke4T2ey8Q8xtUvvFQksdTo4Q54uUjz4oDPZ7Gtvq/31GhdczJK8g4wL5fAazSzNluYHBTA8bK9Uuzvt4/hr2gmqNP0zbvbnHhm+sN1or+NElw8VreUQ0=","authorEmailMD5":"67c37ad7b0447b4ad74f77583f549ee6","authorUri":"","authorUserId":"disqus:juan_carlos_oropeza","authorFallbackAvatar":"https://disqus.com/api/users/avatars/juan_carlos_oropeza.jpg","message":"what `var progress = progressHandler as IProgress<string>;` does? Looks like you `CAST` progressHandler to IProgress? But never see this sintaxis.","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"","date":"2017-03-06T14:29:14Z","timestamp":1488810554},{"_id":"24e4a6bd-c5e6-3e8f-80a8-ba0233d21031","authorName":"Leo Gurdian","authorEmailEncrypted":"c3HtbzDNdfmyjYHtMVSuSRynPRnuNaZyMD6MPRJyiPbxIuVnT8WXzySScLkyzOvGhIw+Vlb8ODHS9kjsuvs+3bxx2hcW5Lz4IPNDThm603loc+unI9VU9ACWnz2RtM7NOWL0WIqInNuERnpVBVKjXOhms5GDq6PC3YTh4Uwh2Y3gRhjj3T/I2IkWN9NjC4Tn2casqAA3oKDVYN9zFU58T2RhyOnb/cFufAtBYCcp/Oj3Xb/9M3lG+5NRcIJ/abcptEuX8BKisjZ7gSIf7ovmu+MUpmVsdeJsbHvpFfzpR95gIeL18PvnUuO7yn6mx8HYJTQK/VtOOGKqPnXuqY8CGg09C7+qm5B3gex3kf1s1CayMe+8lNSxwITw03UbFjZgKOqlgh23AjiVU6QvDFGXGaWhGV8QZtOn8jSBsCfdNQ01tgF5xfUlkTY/QwpuxHc8b9nAkYCuVu3FITfXqz5vaTyJww8CCheHXwPpIN+h7ZANvhaajBysQDIEehsvAjEH78cLch+CY1fGDHk9kw/dOUo9XVYyyTKsXomw4azFJbjhKt2vXC1Q5DZoC4ExCRUNnbm0nuE2G5iHLkzuRFQdx9gnPT6Xz4IGb9f6uQf3ZA90EYTFFGjtEmutWVN9p99DZs9jhWT/B5/9gupt77+rbU0gduRb+QmD6s+1Ptm5qMs=","authorEmailMD5":"ba92d2cbd6945934f38d5aa952ffcab2","authorUri":"http://www.CompuConexion.com/","authorUserId":"disqus:deeply7","authorFallbackAvatar":"https://disqus.com/api/users/avatars/deeply7.jpg","message":"I dont' get why I'm getting this..  \r\nAdditional information: Cross-thread operation not valid: Control 'progressBar' accessed from a thread other than the thread it was created on.\r\n\r\nvar progressHandler = new Progress<int>(value =>  \r\n {  \r\n progressBar.Value += value;  \r\n });  \r\nvar progress = progressHandler as IProgress<int>;\r\n\r\nvar headersInsertAsync =   \r\n await Task.Run(()=>  \r\n {  \r\n return Headers.MCKspPRCCInsert(JCCo, batchId, headers, headers_indeces, craft_and_class, progress);  \r\n });","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"","date":"2017-04-06T06:03:49Z","timestamp":1491458629},{"_id":"52925e53-b414-36c8-9f83-0e0f2289b57a","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"Ah, actually that's a long-standing bug with office plugins.\r\n\r\nTo work around this bug, you need to set the SynchronizationContext yourself at the beginning of the event handler (or wherever the office app invokes into your code):\r\n\r\nSynchronizationContext.SetSynchronizationContext(new WindowsFormSynchronizationContext());","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"72822d9c-489f-31a0-af57-9ea807eec5ac","date":"2017-04-06T18:33:39Z","timestamp":1491503619},{"_id":"66a1f4e3-9783-3537-964a-c1a51d5d0132","authorName":"Leo Gurdian","authorEmailEncrypted":"n2ZpPfjAUPTSbfRNk5VBrDdInKnkJ+aqmUpcbcmuhQYIe8sAeeCkgpIhZoVVutqnv2LRRPXoeevk+pis7ULpNaFmo6SwqxmybwZE5+t2z/g4Alpn4vOpaNhPsrLNz8lA+DQRs11qXJXHoyywZvjwvYtvjJDIMrSeDHX9FP0ktUDigSfV/HeGMJeu24NqeC5ZUcvoRZmV3OA43H8Zy7Fjb8VDMRSXb6dlk3KDxAflv+U3BqCPti0nnOzc1lMiEaRbHa/iaWSJImDzXH03iH4878jG10yziZSQaAKpHm4xREZKpEQVf6mPOjDU/kO86eUX23ngePqn8bc35D5BKh06K4Hrprzo6JkTL5zJyeYynTgiJjGr3xjJNBvcrSUKo6l/c14MSoG0hMrRGSxOFLXhU0gO8Z7CSTeZmtroCXq9xVti+PD0HUjlLKq/nP8Mqswp4Ow1mlm5L3RzzjKSJFag0kaUHLoRHXfBAZTxM0A47zaI+GtTWm71zutjX2bbYbXiURiAO1w6x/v3v6gtRSnjb3PdRaHrVZud++CgyIiiBXvnbDhom6it0pMxb56aqD5mcUwEC9zncd1kz7L46HeGHJtdn0Pn9UjZc1Q/yCVoCpOe1OU6jYXdfSpOYpRZ8PLs4+zg9ao4/n3e6cCvU5yptas6djfDFluBTnDwliQsVz0=","authorEmailMD5":"ba92d2cbd6945934f38d5aa952ffcab2","authorUri":"http://www.CompuConexion.com/","authorUserId":"disqus:deeply7","authorFallbackAvatar":"https://disqus.com/api/users/avatars/deeply7.jpg","message":"Yes!! Thank you so much Stephen. You just saved me endless hours trying to figure this out. As I adjusted the code like this:\r\n\r\nSystem.Threading.SynchronizationContext.SetSynchronizationContext(new WindowsFormsSynchronizationContext());  \r\n var progressHandler = new Progress<int>(value =>  \r\n...\r\n\r\nAnd all worked perfectly!","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"52925e53-b414-36c8-9f83-0e0f2289b57a","date":"2017-04-06T19:27:30Z","timestamp":1491506850},{"_id":"72822d9c-489f-31a0-af57-9ea807eec5ac","authorName":"Leo Gurdian","authorEmailEncrypted":"N6iVFny4zcl7Dw6AsdKRePO/K22mqLxL+fSXzTjpde53JkdoWarlG4zM8tnp1LAjdOmwEU3qGYp4uiVEvEVljZRuW7ToKMViM8ufTP4qLiudikLRWr4Rk6zyFLu9QM1gKOsB5Aq2uVltKRJM8Jz+X3WKF46ViqGGI4uwvOyF+fP5oCJNXPaCWbK2P9znCrwP8axhu4Ovn8bOQ1d2QHENIOZPrx7R4Sb2GgKmLGDmXne8ux3AssIgXqWft7jWswCl4waeDh9WqklDnz+aDkxpDP+bTpCoRYYCYTXb4vCjkwuQJh/PrL5zTjOAINI4ISCuYk5Yzanjdn6WjSK3zH54zNsXblWGs9lHWQz9symRFElC5ZyHk3JMOGj8HtbeCkQ5xlh6xhW5EIA87YVCt1nGx1hnM2HpRrd1GhDlFzuO3xvsMlf3BWgodcpRQgrbnri1k+TCBFp7DMUtMYiQ0CZfIEctim+SuNMmRrT/Ko0Ae3LU/c/XW2gEku1AXCdnfB67vALm6M1OR9xZmZJM2ujd2UOokDHCmJod2sp6lj5UaGNlCZ26ySV3qUj8FxgH46Zg3RGahpA2E0XIEaWagO/NbXqBM1kUhj9UHxH1VCUIT76AT57V0vMCwxFmN/KRBiFEEy5V03Dl62zfHYs7YfxYFi/4u4DsUbOp2UK/8r+OTIE=","authorEmailMD5":"ba92d2cbd6945934f38d5aa952ffcab2","authorUri":"http://www.CompuConexion.com/","authorUserId":"disqus:deeply7","authorFallbackAvatar":"https://disqus.com/api/users/avatars/deeply7.jpg","message":"Thanks Stephen. Sorry for lack of clarification. This code is inside a System.Windows.Forms.Button's click event, in a VSTO's action pane. As you know COM can exhibit weird behavior. I have this as the signature for the button:\r\n\r\nprivate async void btnUpdateRates_Click(object sender, EventArgs e)\r\n\r\n...\r\n\r\n..[ the code here]","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"8b75604e-c2fd-3a9a-a035-aba5321024b8","date":"2017-04-06T18:24:06Z","timestamp":1491503046},{"_id":"8b75604e-c2fd-3a9a-a035-aba5321024b8","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"Ensure that your \"new Progress<int>\" code is run on the UI thread.","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"24e4a6bd-c5e6-3e8f-80a8-ba0233d21031","date":"2017-04-06T13:43:30Z","timestamp":1491486210},{"_id":"0f50eaca-9962-35de-8442-9879cb79a66e","authorName":"UbergonMX","authorEmailEncrypted":"nxh2w2tMBN/RoAmAhpsUo/SBcEyRikyZdjULav2ArwoSXgNGjuZKtH4o2YMpcg7/FqEaRp7yrpeLXDNLAwLrydJqjMh5RgR52bra/ekOoA4kNKLyMfqQytIg/E/4TxF9bigHA1wikFkYRouNeqASlUIL2vYvFugr447NIFAnWgoqCAjlPsgDhZ1mknvecKxdke1M2ghXHdSN1CoQMJB6XXgs+E25UxkJFLMAfOuQb20PZZMzYVb57DXQPCpLSnL8ABdS2kOhVrMF/0WZ7OyceeSB28B+a7jOe/YE+tVIwJGLPS0rkDd6Gzo6WoyuK6d7q7lkHzVsptYhyhJ42l1jYnHNjwmkqDF6flH3ASubINm4f1D3Z+NYl4bOpD1X8qywz3SZizyw5LEKPaM4Xr3WXJka/gsDFGJozn8qgns7US59DMY8becf5cnBNuxd5GIxsQTjPKruPd8jeXazsFxRDbapD7bR1Qx8v4505ivVxE0oGenwnw1BSlzyOPbnC8KQ/NWjNa3D9+pXgxNgOIsbdDYgWgAd3PAgPUP2SXWWTQiADVJg9SWTsHbBRj/5tTMQG8OgT0Z1aU9yJv+rKlZQR7bO1P+VZ7a7prqhKQcrwMD2r0cuXQ+z7PSdYCH4wcYtbHWs5ChkwPIm3mN0x9VasxqcaHG49kFQ0UgYrFzqPm4=","authorEmailMD5":"f41e49bb29e00962aa613558ab29fda1","authorUri":"http://acromix.net16.net","authorUserId":"disqus:UbergonMX","authorFallbackAvatar":"https://disqus.com/api/users/avatars/UbergonMX.jpg","message":"oh ok thanks, im just a beginner in c# c:","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"de06b9fe-2e75-3a8f-8d67-e0a75ce2f79b","date":"2017-04-08T10:25:16Z","timestamp":1491647116},{"_id":"de06b9fe-2e75-3a8f-8d67-e0a75ce2f79b","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"This series is specifically dealing with CPU-bound code, not I/O-bound code. So the Thread.Sleep is a placeholder for CPU-bound code, not an actual sleep.","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"f611c5d4-2b49-3f63-a774-020b7fb425cf","date":"2017-04-08T10:22:35Z","timestamp":1491646955},{"_id":"f611c5d4-2b49-3f63-a774-020b7fb425cf","authorName":"UbergonMX","authorEmailEncrypted":"FDQ6pcRE1xuY2go2EathjVsw4+rEdlwYFejoFCQYhPzcjXUd4lEXfcjqUoclUbl2jxVQTPtlFo6HpBKZBcIQggiwY1VYNe1KFuaZdQe0SufTSAbNv0RdgJFa7DlMhjfN7yCvaLIcscyDlywwTVz51WWgYs3iWO0e9Y0LISX3Npx/d27Ghk8MUo8CVWzf6r91G54u3F+aNMQzeS0z/vI+Edt8q8Zg1ND0toUB+sLZf0ji3llGa13PjIxin0oTniwD2UsifLAKrx+jlBZtpBDBct2oMSkS8AnH6HWEadqNi2vC8p54RNzFSVXFpgcdq3aadjSIEuY74bVAhZd+NR08pvysqo9Cgkm6r14WvvqSyVmY07jrNDZeW1moo6vnGzZdr1PWnce+DLvIt9vAvFmnyNQmSXjS6daNPpJWETiBz4e+U6pMM+lQiflfH8D7vOgNbiuVzgEG8ZB0w1bjn5OhI7IClWL+UjilIQtNSw/uWgAdkdmCLKhbPNBkrruJa/6wzrPfo4zlVHxczzdg5WMiBWQ/sOu9x1k3DJLH0qSSwcKCc7dB48gRqpzjSMWakhchE/5BAVFDtDTcOWN4w458UvSGslNoA6TNiXJ068wbduA9+ya4t/fvpxRlrOwREflUZZ5GGhmubYxw8fQt1xCGyy8CzdSQ+HxBMbUn6NWx8WE=","authorEmailMD5":"f41e49bb29e00962aa613558ab29fda1","authorUri":"http://acromix.net16.net","authorUserId":"disqus:UbergonMX","authorFallbackAvatar":"https://disqus.com/api/users/avatars/UbergonMX.jpg","message":"isn't this much better? or no? [https://pastebin.com/MX4XpRqy](https://pastebin.com/MX4XpRqy)","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"","date":"2017-04-08T09:12:32Z","timestamp":1491642752},{"_id":"64d5ee85-017d-305c-932a-59d4c28a064e","authorName":"D","authorEmailEncrypted":"SJVbz+co9JFqvLIcyDvNm9S9I+v6DPi/OkrzgAzqgZnL18OcIqiGT94AZGw6qeNlcHR8YrW2KvEcgKuP2SbH4zd9aaB9eRx3a1Z9iDfQpdnmA78WHftAlEIKnegWQysc9aUyFqpJZrejDvI42oAzV257iDhAPSr3Z2vFkUUEx6x61Bt+e3Oqsr0De9ik7/yE133UkvXeR6T0RZ2XsNMe/OQ13x7+3+7+EXMYl1HFq5TegfAYBmTmkSUARloxwT8JE9+vkE3H21b/ZiPCCpAn1PCHcM/mxBLePO9yPIfE5/PGqQIy2l9Mv8oHdi9ymGJGHd5NjedIRXKn2newhIbJGv6TBQuHT5NPwL7w/A3v29m1LGsdtaw5XWjgM+bsveqw8gs23ODaCBPZxB3+jBLU+sGx2Yltl8FkJF0X2oMK5qwprpRmM0hRm7d7oqBI0IbP25exc/oO5XUxoJNydy8CmkgFdS9lnPortzLKwkRC5Yo1OqYKEB2K/yg9w1uwLIVBmhUtDxI96vR+wrqLbD/jguYgXnVEBAeAlTjyc8TSZDhQaYPqUnxufzkpKS9Xo+1VEJGN75gDoL3wY8BDd0qAWHePXsttHlXJME1RB8OcXevgyEA39lkyxwsIUfysuUyNnyHdSnyhh2OB6flcplCGJBMz7bokJAAC3REIW1ulPik=","authorEmailMD5":"293466f749e47b2a66546bc853e15ee1","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"Great series. It was easy to read and concise. I was just wondering about your comment about BGW's drawbacks \"The second is that we must pass back a “percent complete”, even   \r\nif there is no way to calculate a meaningful value for that parameter.   \r\nYou can, of course, just pass zero and document that the caller should   \r\nignore that value.\"\r\n\r\nI'm not really sure what you meant and I didn't see anything in the code that stood out to me to illustrate the point.","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"","date":"2017-06-28T19:15:10Z","timestamp":1498677310},{"_id":"026ef2c7-e1ad-38fc-8053-6d0315e86668","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"It's in the code immediately above that quote. The ReportProgress call always passes 0 for the first argument, and the ProgressChanged handler completely ignores args.ProgressPercentage because it knows that it's meaningless.","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"64d5ee85-017d-305c-932a-59d4c28a064e","date":"2017-06-29T17:30:09Z","timestamp":1498757409},{"_id":"4be240bf-9c3d-3d2b-ba95-1df064132a97","authorName":"Leamsi Ordnavi","authorEmailEncrypted":"NAf3tPKu6Gtt8RvTM+1gbDd56tMOKv8dr1wp9i33v+kuY58ajPDFkvJOavxwt6cmZELxeFK12DuAEnKgJ9hGLcmHlfa9B7sfk0XjRboF3ExQqdx6j3xStOcJJcNFgEkLoFdQofLa9zx446WXqR14JwNlLG5BcM2t3y53at7iffrlKG8zrHC0DASfSC5YAcW20G36ZTKl4DH2YtBxY0WBas2mopCzrB5F6hYJ2pj3VaZYBKGpvuzuQ8wdImEpJs+vyrU/B4JZe/YBgIbQ3x7b1w7a8yasqNCw8sAMGQndxXy+JBc4laAWcq8Zr+9CsYfhNMYBdwHVZq2ncnEK5IlqlPLPtTiHeq7/eZ2IPnJkiHtfRbSruOAuNkXBmjemsfJI11MPLvqf3zZbuXOo1lLmsp3BvpPJsd+yTvUjAWqE0RdIv5EGJg/YHZK3q+L5IAdul2PtkTXg+OsBPWGTUePvaCTPI7WEE098ZAaI5jnt0GT0TkOdkVvipoFrPsSHSZfAQWPksffT3O6U2sdDmkmTIlw0r54/lrGw7suY5JV2WDEgcYJ28QINkB+2CMjv7uihn9TbF6VIti89DqiEF1XNvw0YcHwQG4p6OLQXxfIfGIf7IDHKAR5l1yEpCa8wfdq9lYfEoyu/+ttYvLLCwg/ASfOLYULCwAhlis4l9wEHxDo=","authorEmailMD5":"9b8bb3cad15bc02dac8511af7cbde14e","authorUri":"","authorUserId":"disqus:leamsiordnavi","authorFallbackAvatar":"https://disqus.com/api/users/avatars/leamsiordnavi.jpg","message":"Thank you :)","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","replyTo":"","date":"2017-07-29T21:01:33Z","timestamp":1501362093},{"_id":"b1132b30-bd10-11e8-8d8b-834384c9d56e","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","postUri":"https://blog.stephencleary.com/2013/09/taskrun-vs-backgroundworker-round-5.html","replyTo":"dc658ce0-bc6d-11e8-991b-3742b088b0b8","authorEmailEncrypted":"EoO4tI+lITF6638djG/yRUYzl8+19mWLLG01EWigm9B3Ip0IA1fbLAabkJmC/hK1wBiNLjsw5Xw+UHNNaAY6e7f2KUGHJYoxLLIuRg8FF+gu/EI+f24R2P0CXH9pLaCWX4A8yPEYb0g0D7c3z409IbG98Cb1FRu4LaciPqd0brlwqXnBDVrYacthoXji7QpKtEoX/yEujG9n4Vtl7VJraaNAeRvNTmZrrhnqUkc5VuMp06Ai3qtLjST96W8Z/Vx1o2zE/Sm2I8zqsQovvatdcCK1AKqeiSkiTUIUKUCDb+ULzToVBL/F+L/PpSRVQzJvD6XdOOCRGYY49GpBc7CQaEgYp8MDgATm4nl7MhBz3VstdNOpB0IMzI7hFGMhAViS3JqNPBclnR1vbUvJFZA7pLMdGmwqGiJ5dwRPvzsVAX1hgt+V3PbU4YMiOI9rRFGjtOeWpjlTnJsCgcH1hiNBeaNqStAFKmcev24iqTuTcwj+ca+DNZF3EShzX6W9a0q4XzVceJVQvQZ6rUeRp3QWwy+ZMeIew4DL7AMe/N2pxtRhI71D/uw6ceIiJUZSw85czj+6YfNskyL4KmnEic3qrotsVmth5SqkdWuYgGfIjI8vOQ13/a7eSIITf4cv6eqhRjRmFx2EhzorzsXY4pEGFDQNUmcofp33u3GRTMljdfM=","authorEmailMD5":"23448e78d187fba56d8bc263081ac5d8","authorName":"Stephen Cleary","authorUri":"https://stephencleary.com","message":"VSTO has a long-standing issue where it does not give you a WinFormsSynchronizationContext like it should. A better solution than the MSDN forum one is to set the SynchronizationContext yourself, and then async and await will work naturally.","date":"2018-09-20T20:06:42.797Z"},{"_id":"dc658ce0-bc6d-11e8-991b-3742b088b0b8","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","postUri":"https://blog.stephencleary.com/2013/09/taskrun-vs-backgroundworker-round-5.html","replyTo":"","authorEmailEncrypted":"","authorEmailMD5":"","authorName":"Brian","authorUri":"https://stackoverflow.com/questions/52393138/c-sharp-microsoft-word-vsto-update-progressbar-in-form","message":"I have been trying to resolve use the async and await on a VSTO development and keeps getting cross thread exception. The same form works fine when called from a standalone app. Can you please help?\r\nhttps://stackoverflow.com/questions/52393138/c-sharp-microsoft-word-vsto-update-progressbar-in-form","date":"2018-09-20T00:41:07.439Z"},{"_id":"9b1b6dd0-21fd-11ea-a22b-2fc3a66bc293","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","postUri":"https://blog.stephencleary.com/2013/09/taskrun-vs-backgroundworker-round-5.html","replyTo":"","authorEmailEncrypted":"","authorEmailMD5":"","authorName":"Andrew","authorUri":"","message":"Thank you, this was very helpful.","date":"2019-12-19T01:19:30.778Z"},{"_id":"58d3edc0-9c42-11ea-b644-7794c1dbfa50","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","postUri":"https://blog.stephencleary.com/2013/09/taskrun-vs-backgroundworker-round-5.html","replyTo":"e9a18c60-9c40-11ea-b644-7794c1dbfa50","authorEmailEncrypted":"wiNZGXcQJzc/5Ymo1PMJFDDl8wnOsNfmdwAU9GUW8/SIjBONluyaysjbybpe5tM1INFum5HdsMqupihosiWPSwONoLxoEaBjn6bVDzjpTn+xwn0m+iq7jftqt461XSp6TdwPIO4hUAzBEzSS8nJW6idL7mia1MLSpQGdiXE1tfD/4bHQchCNMqpCZOFa3pYk96xDggjoKpISRaH4tE7XnRV8XIcnW54jpnXtTSyfEeqkp1gBdIfJvI1yFLE8yQBfbWJUg6JTtFZh/jGY4pczibQyCJpouH3G38L1g7ecTx2WSMbw03YAIb0XXLNWX8FIaMF1NS5wAsrJmAS2WNHT+XWU8CD38iv9fTH2E46cBHd94fjmh0aH08HB4w6Wh9AYOKr9K/Kl5ICG5bO08R3uABlJBrrPhXRBlb9Oo+kAxCdp+WFJZ5JvZkioSqZKgpy1q//wna4QQkCt7PBxMoK+1yUYxKkuqMYoajQfIqvAVUhsDQ2NJkG42soKFtPmpc2Jz/cflzGWClvJpQvQSbbRsB/TWnYv8WoDTV6mtAGfwjR9RM+ozQ9zFKPyg9WauDSyeC6AMjDqxVp5y8I/JdDPKhDxxUCWhCcccDhCJWs6tj/3kvWFZzGDZXe5+Z1aaXSh1gXmPq0r6L5A+3+b7flfdtPbbrPMQrY5NONtcgm64PA=","authorEmailMD5":"23448e78d187fba56d8bc263081ac5d8","authorName":"Stephen Cleary","authorUri":"https://stephencleary.com","message":"`Progress<T>` is only used on the *consumption* side - it has members that allow the code to consume progress updates. `IProgress<T>` is only used on the *production* side - it has a member that allows code to report progress updates.\r\n\r\nPerhaps a better design would have been to have two different types. Currently it is using an explicitly implemented interface to have both API surfaces in the same type.\r\n\r\nNormally this is not a problem because the `Progress<T>` is passed as an argument to a method taking an `IProgress<T>` parameter. That's the normal usage, and there is no `as` cast required in that case.","date":"2020-05-22T15:38:56.212Z"},{"_id":"6e103800-9c43-11ea-b644-7794c1dbfa50","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","postUri":"https://blog.stephencleary.com/2013/09/taskrun-vs-backgroundworker-round-5.html","replyTo":"58d3edc0-9c42-11ea-b644-7794c1dbfa50","authorEmailEncrypted":"C9GIUgqf13cSD4qRylbvaX09roukXnBUO12kKk+BZaVPuTbTkePFUUhjhjaZAcWDuCAY6jhKJMwpaLv5ks3lT4vsPVjOSzmGnUgPTE5L3vkkiJbPUw8KZCMnVp/hP7N23miZwsyXWj01dYzHgsXmKuyFCnyJ8Vg1hb2aLY4Hv8xyGiKVgsHU+dFwE7HThxOPx+ebNpPyFIjXIfLC6I7UEQhBhORS0sH1aVgilsBjVCwjtauGffxU7RxogHd7IsWxezeO4/vyzAVvX9tn3Fv/XDS6AY5ydwRWnHM80H+2GncmT/HhajUHmlQaVLlRnlk7TtGVC8ITwny3Xmykczo7/Ng2I1edWjcqnc2b2qfJc1//FYdBRAOXVZBOsbdnJZvKH7GxaGsMg2DP5d4hdUpNHceNEkg9wWSr4Vrqd2f72CeWoX+kYOKsfcIE/SP7h0t3z5ASupm/aqz0hk98tOTvLDa9KUbxXfs/A9P8GygsyS3H3AKa47hW8cNmTYJzKnN1QSQtUScgqC3614LPHltg3FULGrElTuX+aUhrl91b0UPbS+3Lya0+x61D8m3YoSXOeZFIwMKvmIJocXLRcDA4UWk6To19mA2VNQYYwLZgpS/T23eblH+d2187iOEEmLj/T4g0NqCFkWXT5B9RYuMh7wh1wu7r4OGiBtAWWy0koyI=","authorEmailMD5":"112c1b709c285fa3ab540079eac49da6","authorName":"Tim","authorUri":"","message":"Thanks, Stephen!  I also noticed that if I change the <code>var</code> keyword to <code>IProgress<string></code> then the Report method is exposed.","date":"2020-05-22T15:46:41.324Z"},{"_id":"e9a18c60-9c40-11ea-b644-7794c1dbfa50","postId":"2013_09_taskrun-vs-backgroundworker-round-5-6765eadc-903d-3bf0-b857-b299eb57c1ab","postUri":"https://blog.stephencleary.com/2013/09/taskrun-vs-backgroundworker-round-5.html","replyTo":"10663731-7648-36e4-ab30-1f4930ffffc0","authorEmailEncrypted":"twW7TXnS7YDpuDqDiRK7m7L0nW1mS5ljv69zjYoOk9f1E0Z6YK+vHPb6+7rAmbLC75hRy9zh7qwRQon+1+I7TAREuSYeqBDxe3CVTZ+//mydkCtqmWzH+ts1JDPpJpT77BoBHT+vCGdIwXgwtNSNvIAoBSizqbDlS5nCYFmATy7OwMiZzvWwsqSDWRU1fmuTakv2TXjU7zLrENoEvP1E/CHDIi6bqsJYAS230QseDsCDcV8hCEwzy7u+2F2Vdh1Ab2RKbaPVgqqKrKMitHlpc7sVdw4PYxvxFDiiNVObjgw2XKi8XY07EwJKTdvM4F2mqfbiejfHwmIZ4A9s5sTcrjZcricrvxeZZV7g6a4YvjjEu7cxl0oW8cSLtFnVyB5e/OoWVXN92P7dYYBufwlj4PigCrwsH/T8WnY+rzgjGhtKtenPFcfRBDo4LmqKRhJ9flvcDkC2n1BrFeP25GS2cPzKxiG+djqVGRIeLygmRl/OZXvnXve+Y4hx1If6KmAw4jTzYBR2gQgKz1C3pHk4Tc2cHrLIB/yT7GT4ZB0IugINEh5kAE689b4c09BbocEBidFd9xA+4i/TKz84SQwBWoz39nKQk9ya6glWxUEgVCwg3X5hNnmJm7r49CFcATqthw3EuDoya+NoejmPfGcQzROGCdKW4ldvmQDIpPjY0iE=","authorEmailMD5":"112c1b709c285fa3ab540079eac49da6","authorName":"Tim","authorUri":"","message":"If I comment-out the line with the \"as\" operator and replace <code>progressHandler</code> with <code>progress</code>, Visual Studio reports that the Report method is not available on the <code>progress</code> object.  But <code>Progress<T></code> implements <code>IProgress<T></code> which exposes a <code>Report</code> method.  Why won't <code>progress</code> expose this method?","date":"2020-05-22T15:28:40.329Z"}]