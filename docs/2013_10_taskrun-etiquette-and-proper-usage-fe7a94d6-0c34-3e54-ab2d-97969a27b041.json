[{"_id":"0eee7c8f-fcb4-322a-8d0d-7e15ad62bd9e","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","message":"Can you give some examples of exactly what you mean? I am interested to see the difference between right and wrong.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-10-18T14:17:15Z","timestamp":1382105835,"authorUserId":""},{"_id":"3ce2c509-e7b5-3b92-801a-1eccd0f7f049","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","message":"Yes, some examples would be very helpful! :-)","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-10-18T18:09:02Z","timestamp":1382119742,"authorUserId":""},{"_id":"5b14da16-4a7c-3f4e-a74f-1fa9afee5261","authorName":"Stephen Cleary","authorEmailEncrypted":"OvQqT+1PZc/HXC+gQyNOJl0CT+XnF+DeeiWpE3FP61BPqqyMmzWi6kK57ZD8GeeehH3T1FSZ6PsCgpGqrWfFFHbHv3/bOgkv6OLcOT88azEsAAVGsifj1aMR4z0jFdMSW8r5Mah3Q8Xj/Ug6lf4/iAdi2UiHzYQh3l96WlAbbZjyyz0ZrS8KDuv6EL+H6JyOLGG4bGmBPASR53LRM1a2199NRey9j+fa0ZPLM3H6PqnKvgqIOyzmpcTynl2RnyRujWa6gHBcqtT91xO1SOEmNak4SeiPs5jNMuAfoFlQA0/zO8sM0tEpE9fjNtfQeoTIwe/Za8pkZO89rYVh53FzS0OGTMGT78DYcKTKpGVd/4yYI17wHPLhPfP5kzKf6kXp0pxYbG++LVTH5PmJQeJBAt+uqpAn+zv4raAV86BwFc8XBVH1HHg1MKf80Yk5lnN26FDDmHdKXLzttLvpP9HaoxsojEWVywbHcoyAUVZXlJfyBlJ3XMReSs/NfRvH+5WHp8IPnKu8m5pN2d4NZO0pgCGQOHER8MIJIDf0EkvRdvobK7euU2Gwlm8vI0wyB1snVLO7tlpVa/cjoJ1we394XJysWF2a8NpLr0YHRyYAO3N7zLAJnCBwRB3k8ByyQyiuGitm8MrTfAp/74gpi+N4iMqODd0ZakXzKCv0t6WoBJc=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"OK, I'm heading out of town (to a place with no Internet... at all... not even via cell phones), but I'll put up some examples on Monday!","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-10-18T21:17:14Z","timestamp":1382131034,"authorUserId":""},{"_id":"a82931d1-e111-36d8-8ecd-50982acc969e","authorName":"Nick","authorEmailEncrypted":"","authorEmailMD5":"","message":"Yes, what exactly is CPU bound work? What is different from async tasks and parallel tasks?","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-10-18T17:26:55Z","timestamp":1382117215,"authorUserId":""},{"_id":"5662b57c-13c4-3f2f-afa9-dee42c154d70","authorName":"http://devtools.korzh.com/","authorEmailEncrypted":"","authorEmailMD5":"","message":"Yeah, examples would be great! I will wait as well :)","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-10-19T17:54:38Z","timestamp":1382205278,"authorUserId":""},{"_id":"71a4d1ac-26f3-3af7-88ed-b93a5448eab6","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","message":"Looking forward to it. Thanks!","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-10-19T10:48:53Z","timestamp":1382179733,"authorUserId":""},{"_id":"9b57d0bc-c3ea-32d7-8d8b-a5080118070f","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","message":"Hi Stephen - did you manage to put together any examples?","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-10-24T01:58:37Z","timestamp":1382579917,"authorUserId":""},{"_id":"c0feaddc-c7a6-3143-9078-babd0481a9b5","authorName":"Stephen Cleary","authorEmailEncrypted":"PFeVDnsIqvHr7itUqlWPiWp6ifVsQlMrUpjhZr2yXezWLXRmG5Fq5x6HNtIeWgMIyOQzJzWAWUgkEDemtlcVY6aAgdfA3bZY/BYEDyMoebChXFfc/JbsiZ3TxX/C1s9CPJ8JQmTIpusPT2SSxWNLmLQf2nD/3F+9pXczFyjeQ+5WVR8H1s13n0q7uV0fNAYOKGUe854M4ZaaIqbA6PYsaaV9CWotLzZ9bzSvtOj676gaO8o69+thwh3oZK748w6ecOIx5j7WlHfj12LRfJ3/Z6slITJ0wnJ936ZXgAnzi6+pA7GGIGxiivqo+NYlV05AV/hB3/o+2PweMRbySowYXn/R07DE5a6R6/XI+No0f2gQZmMc4W/xX3WKEhysSu9MiOXr9kYs5Sq6UA9/GIrqapTg9wfXN5AFCxaH1bX48+qzjvn5xoVqH8OE/PBvm6ZeRdRCQ0HgXsJ0lPKrONyHmhr+t9vBpUgxaLEzCLBObTLVP/ZcLnvTJRBCHGyduW0INGOzQ230ty0qrnx90S3wf/fS7pVuj6gtMKXmMpIKaXrts1KrHa3STsiybPRV2uw2Xg0b0DN1hR+5wDE8voxJhb4yCNiNd7MSrg/WZMlkvLqq/kAInc7iWnOesF99xyhZYAyB1WEvYsf6xOQv9bTFpc+8nYqByax0cyYMwr4tnQU=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"Sorry for the delay, folks! Examples are going up now...","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-11-06T22:38:12Z","timestamp":1383777492,"authorUserId":""},{"_id":"199891b7-640e-3e23-848f-9599e328c017","authorName":"Vitalii Vasylenko","authorEmailEncrypted":"","authorEmailMD5":"","message":"Hi,  \r\n\r\nThanks for a great article and blog in general!  \r\n\r\nHowever, this is not that clean. as for me.  \r\n// What if I have a reusable method that uses significant amounts of both I/O and CPU? Should I use Task.Run for the CPU-bound parts? The answer is still no.  \r\n\r\nHow would you recommend to improve next sample:  \r\n\r\nasync public Task RequestServerAsync()  \r\n {  \r\n var resultString = await new NetworkManager().GetAsync(Constants.SERVER_REQUEST); // Just a wrapper for await httpWebRequest.GetResponseAsync() and await postStreamReader.ReadToEndAsync()  \r\n\r\n var answer = await ParseCategoriesFromString(resultString); // await TaskEx.Run(() => JsonConvert.DeserializeObject(resultString));  \r\n\r\n return answer;  \r\n }","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-11-11T22:11:57Z","timestamp":1384207917,"authorUserId":""},{"_id":"cf4f0a5b-b5ea-36da-982e-331daa501af2","authorName":"Stephen Cleary","authorEmailEncrypted":"awB+G/melfuM17U/KC2Qb10JkPFXWqhZaeyLpAkSAFsFl2g7x1kzaionO0fvjqOagn6Wn6n9uPQy5sdnv0b5RJDbDBTh/WuIb7EBSXPPUjTWKCrYcEB5Fh7/lyh9BeWujBEpor9ptxLoL2WyN7JlUXYqCoWdhnTKLaLOqAroCDhyHtlZNJHvAJaKxexOGNLMtwKVt/3TgekpxcaiQz3PuiH9ZTXDBTD0e7Ug4IQqPiVc9ZkMLlk6aYYazX5SIRHZsVCjKFm20lbXcvwaYk8YH+l7bi5oxCggoNQVISOSMROj9zrcpJr23YrfgXCpM0+AjPaptQMIXK8vyY/+06NWX8mfS9dcx0Q/TFPNh9PDYP429X0JwKS7lgSE4UGm/djvylqS0pnQTOhGl3Qc+mCnMP5O0N9N4/P6vyhOEewtu7IVpIcoM3ahwNXiZXNZ0cRMsML0VQbE8xaHUVYB13xZZ3vW97mCCurp1LLvd7N1ctTT4bR5mVvJbIxFrKPQZ/QGr/GN/QFQnZo4JpF9f9cm1gCARb3ucutrDTLMVNyzOauAAFGIU7qlQuz3DsoURQJX1ASXT3io4JeFNhb9rVMVYRvzbVXoojKwdORZ0PD5B4mKzXDxuMRF1HbKTqTe4RKZP9vEDoC0gbDokVumNFp3owjmudj7UtyCoSPj2uATklg=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"SLaks has a good answer here: [http://stackoverflow.com/questions/19912343/async-json-net-deserialization](http://stackoverflow.com/questions/19912343/async-json-net-deserialization)  \r\n\r\nMost of the time, you're not going to be needing JSON deserialization on a background thread. Unless you're processing a *lot* of JSON.  \r\n\r\nIf you apply the guidelines in this blog post to your reusable method, you'd get:  \r\n\r\n///   \r\n/// Note: this method is partially CPU-bound.  \r\n///   \r\nasync public Task RequestServerAsync()  \r\n{  \r\n var resultString = await new NetworkManager().GetAsync(Constants.SERVER_REQUEST);  \r\n var answer = ParseCategoriesFromString(resultString); // JsonConvert.DeserializeObject(resultString);  \r\n return answer;  \r\n}  \r\n\r\nAlso see my blog post here:  \r\n [http://blog.stephencleary.com/2013/11/taskrun-etiquette-examples-even-in.html](http://blog.stephencleary.com/2013/11/taskrun-etiquette-examples-even-in.html)","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-11-11T23:29:09Z","timestamp":1384212549,"authorUserId":""},{"_id":"bd378628-9846-36c3-b7da-a21a43f56f81","authorName":"Vitalii Vasylenko","authorEmailEncrypted":"","authorEmailMD5":"","message":"Hi,  \r\n\r\nThanks for a lightspeed answer, i didnt expect that :)  \r\n\r\nWell.. i dont have too much of json - say, 20 items with 10 fields each (approximately). During waiting for the server answer (i'm still using native ProgressBar, which performance is quite low, but it is good for diagnostic), i see that bar is running smoothly. However, when data recieved, it slows ui down for about 0.5 second.   \r\n\r\nHmm.. so, you mean, i should remove waiting for CPU-bound from implementation, and then call from UI  \r\n\r\n var answer = await Task.Run(() => service.RequestServerAsync());  \r\n if (answer.Status == Ok)  \r\n ItemsList = answer.List;  ","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-11-12T23:41:30Z","timestamp":1384299690,"authorUserId":""},{"_id":"230147e6-94d4-3385-97a7-44f90836fc62","authorName":"Stephen Cleary","authorEmailEncrypted":"EC4a+bQrtObcjFjW7MJwKL+4hz5WNBFVvBTMul5UjNEro96njDre6bnzGkz1S23lcehBJOcDBIsy+yKHhr2ZgYQRXMP9kGH0g1q95DZvOcYVp9QaT7HMMqD/CQH3e4jvpYmNj4lN8txVJMnWxsRdl6/dnkZ5tJUO1hMltBATjSsq/Gazw8DUihCQQ448zByBZtGcH8anM0VC/e90Q7671wb0mtXBqloG0o1sIjPsgGVZ0J9+wHq9BZUu4zDgLRMJO/wBLd20UB/TwHrevg45d/q02CNTSZ9/WSx+O4G1CM3o9qM6hDUQVxt9XCJKd8PKg1yMSnBQa24RIKNhy+pmewVc9NLiJGFBqTBgfWU03NnZHgj9/FQWg6ArSDl7rJA9ENIZjNK8sB1atgX5zHir0RSAwEXss5ILxzHTUAx+1ErDEy7DK+odlAGDD0CTDmui8lCvSZaOP774WEBpM0Ob1n/OaPES7Cdk2QVAt/CwijUT4+CsmZolteTZE8LT8k96aNhNCAn0vvhh9EKBwTKvIphIlNs1Ss7cT08cyVIj/BeM4zQscER0wpZHL/yZ/rq7QZD6GdIclISJWsoBzySrkwH6oRGshMUuxMK36i+YPsp2GivwuCg2GA7+xwPux3ybvcgpcKrpZoU8Dc4SqUZvDhbO2kkX7+yR4Y3A4gNXCrI=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"I would be surprised that 200 fields - even large fields - would take 0.5 seconds. That seems incredibly slow to me.  \r\n\r\nIf you are having performance problems, then you should first use a profiler to make sure the slowdown is where you think it is. If it is in fact the JSON serialization, then yes, I would call it from the UI using Task.Run as your code does.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-11-13T00:26:27Z","timestamp":1384302387,"authorUserId":""},{"_id":"a76bc3c5-b365-300e-81cb-911b83f9e3aa","authorName":"Vitalii Vasylenko","authorEmailEncrypted":"","authorEmailMD5":"","message":"Ok, thanks!","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2013-11-13T00:43:13Z","timestamp":1384303393,"authorUserId":""},{"_id":"cec93a25-5659-39eb-a75f-a9aaaaa1533b","authorName":"Mike Breeden","authorEmailEncrypted":"","authorEmailMD5":"","message":"Time for me to comment.  \r\nThank you, Thank you, Thank you. I have been struggling to figure out how to properly use async/await. I found Steve Toub's posts and they left me baffled. I just read 23 of your posts starting with 2012-02-02 - Async and Await. Now lets see if I can start this without embarrassing myself.   \r\n.... I think I had better learn F# so I can think about this without turning my brain inside out.  \r\nThanks again, Miguelito","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2014-04-01T22:54:50Z","timestamp":1396392890,"authorUserId":""},{"_id":"289ce686-5da6-35ea-b875-90580cf8d66d","authorName":"Dimitar Ginev","authorEmailEncrypted":"jNNiThaLNdG00h5y+PzNrmsxK26QpM/WkZ64qd+5M0odYlaXDZQ0cohStyPn58UaBMmxFg6PheMI59JgIVBJWQmkn9ra3EfeAzD7KjyudjbmahVwuw/59h5qasELEYSSEs9+ph+8kkE9LdkjuWELg4Epd6vtMNBqlvYpMsgk62EY2eEUvm+uR/MOMagpsHXXWmyZshyBbMM5xcyeR/e20CxdY3GYm0zYA/10pK4oBOoFKj/tSg8J0mGfEjBEtFNC/ITG6EKETXeejxqpPTYu/B7IO2uFP1/mbc7A40r2PvfPny/8TWUP0pxBBqm7xE6sbzm8mRghF2YOr5samMsPOhPu6Hlvev0G5ZCirRg3gDGR6pfyds2cubcsXaW//pamjSJ7KJX0iz07TfnVlSine53fjmbWz72s1sx7bhPRTzVrAt4IYNkgN84OLpkJLm9vejLVEyqhm/iGUAnpYZwHaVy1w8JpHPwdcG8HgKGfQC5RDZiy0LgznnK3rmBfKbY49HMyjX0YH0irWev3D+VFJVyLaLtdPT4ftEf7RGvbICINjACdsCg+sli0EKTRmj+OS9xS/0BVQUTNLDynoMVNgc7OoftV2mpWJnm4Mkn5+OlKZ+mIaCR6tOmavZZvMuWVPe8XnMPxIeXOQT3Ngl2/Hnp27wr1n4VNJaVj1oQrNVE=","authorEmailMD5":"886756f0c06f96fa34273ab469fbb99d","message":"If we should only call CPU bound methods with Task.Run, how do we call IO-bound synchronous method. Is it OK to CALL it using Task.Run? In my use case I use a third party library which eventually makes a web request and all they expose is a synchronous method...","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2016-02-03T19:32:10Z","timestamp":1454527930,"authorUserId":"disqus:dimitarginev"},{"_id":"676958df-1f31-3c5c-90d4-01b52ef21619","authorName":"Dimitar Ginev","authorEmailEncrypted":"XeC4ELLnR7kA2eXw4SubjUJjSJj/32uWuA1pZoeBEAtX8M+r639kBL0KN4GKvofA8tojTlIcnhbbvTrq7VME3LUs1Ec8gBAhYbj+uQF244R8xe0LWWpRn5xRBpTh9qnHRu35KLq371TtEakQXVdEc01kZ6QYA8hgBxMB7j5G/RBtLvr4EvdD8/f2SI+If+2ilwr4ggoRvl8FtAGiWpc5gBRd7/Cdw5HpyxXIcmeQK75Ycp1RLLKo05H585I/hGsXkbKSh32YJVzoqD4hf+JshKsb65o9BsK/7sr27INw/utDGrs8FnCEIYT0YXaBA+5VhBt3kYUlu7D4quVgOuSrDxtuvC3hr1Rlc42Twi+kKrtA2uUU27ORELB6pl+Stlyb/pElh2syqN9mU1dnjkjZDSLnORBnGx1+KYiUA1LR8MkXrg0NSxCtfyy+9lj/JzjLIH7oqIFiVzNknsETKU+0q3HtCuWV52KPSyLimmMVd3lwf9TbZAoK4L2RG6ti4bFIpmZ4AV0VyAvPV1Q7/mnQVGWBEuvA5uudnjTBX+Es1hwtSdBlc4gbgAdUvnFI+mWfWg+IrCi9CUvNyD6k/moWWnvLOwu+mo/ezeLMKSbmjmz8YnKgZCAsHFN6kvkpQbNEEd4nbkctd2jFwQLKa9xkTt0D7tCZVvtEiGf3P4Wq9gA=","authorEmailMD5":"886756f0c06f96fa34273ab469fbb99d","message":"Thanks Stephen. I was not expecting such a fast response :). I will use the opportunity to fire another question: So my flow goes something like this :  \r\npublic class SomeController{  \r\n__public IHttpAction SomeAction{  \r\n_____business_service.DoWork()   \r\n__}  \r\n}  \r\nclass Busness_Service{  \r\n__public DoWork(){  \r\n____var result = third_Party_Library_Wrapper.CallTheThirdParty()  \r\n____useTheResult.........  \r\n__}  \r\n}\r\n\r\nclass Third_Party_Library_Wrapper(){  \r\n__public string CallTheThirdParty(){  \r\n____var result = third_party_library.SomeSynchronousMethod()  \r\n____return result  \r\n__}  \r\n}\r\n\r\nSo the question is which method gets to become the async method. From what I read in this series of blogs we should use Task.Run to CALL the synchronous methods, which means that busnessSrevice.DoWork() in the controller should become Task.Run(()=>busnessService.DoWork()). Am I getting it right? ","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"c06ce764-5223-39af-945b-4043aa302ce9","date":"2016-02-03T21:42:29Z","timestamp":1454535749,"authorUserId":"disqus:dimitarginev"},{"_id":"c06ce764-5223-39af-945b-4043aa302ce9","authorName":"Stephen Cleary","authorEmailEncrypted":"fBEo3CZPsXZa3rlyUXCZr1DE6hADn2kO9Hb3UhHzyW/KOInA9DZBObDrgwx1o7dfT1KfrZYdudEQkppbKbL9ZFXaRtFuplNUtx34ftqBa6ivF2NF2+1MioluZbodZyymk7I3u8KL8qmMx/WZdI2ONyvbZj6qaUKvbkSU4s8mgl/ESaXIgChkIIXdv6ml9XFjpDiGy7t/ID3o38Bp9JayKxhwZnVmMcFD3zUIYIrfQE9SEGTXxOXVJFZ4S8D3TKvgWne91Wgpn7wBQvMeoJ8f0A/hnh3G2dQjsFJ7WdFZ+gzmLI0cHNF+sf4r36r/C2FAZjIXFHX6q2WHqvBwtYgdVs6FMpuEF+VS8gR4PKvA8JczR6wk6Isghdc3o8rufzIV2bgwBCdk083BioBsV/psy948u2drd5U6rBBqgJ1Vh/kTLXOirQKyvX+l+jAX/H6Cc7h5T00qMUVLizztctaUeodTuJYsydb5Dr2LwtjT2uVW6FtICRXvaKD7xQwSQ9oDWnRmzaaRCvsuCCWvgD81Nm4nsG6xuGvFKHCnpimIjE+AFQNQItNYYurC8eAU9zwZL4nMT5WF2w7w+si28U5KnwNNYhUet71X9Xfto3d5BCtU+HVHwmc+8hnyL3jOCAkoqyJtpHdpG29IQjb7amlyAfw/h5zhPmSMVcyIu6BsfE8=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"In that case, yes, I'd say it's acceptable to use Task.Run on the UI thread to call the synchronous method.\r\n\r\nIt's not *ideal* - you should definitely ask the library author(s) to support asynchronous methods. But Task.Run is an acceptable workaround while they fix their library.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"289ce686-5da6-35ea-b875-90580cf8d66d","date":"2016-02-03T20:26:58Z","timestamp":1454531218,"authorUserId":"disqus:stephen_cleary"},{"_id":"99054c03-1092-3298-aad7-15f236ad74a5","authorName":"Stephen Cleary","authorEmailEncrypted":"tRnqJa+hNsQPEl9c+Xx/sQXChYBixzjnDcctSVHKg00LqofIMGJvlms213InQ0l2uUSL91BUHi2iUki0xTnUAMhyjoqHOmwIret1o+A3fElw+9q/5TmdAhXyzXP1i9kMqvuhVTydbG7OQWKZIOAWmrhYTtfxEbbI1Xaa0N8AI7dUBbOEbtVt2G42U5QuZwpvBFUZPtursHpiK9Vn7dvqBVz+DN7twTbp04bu8MR15s66W8sPCS8lATVPXbzogJYPqzDBVz+bbs1duvPD7VM7M41KJChaqmSZX9icAWO7GxoQPZDixMG5I2KjWYUxqFsNK3H/JiPsx2rNXlGfsneab7zeBENl6dU7qpjCSnLyQQCplbk3Dg6LaeXsaCDy0JWci68nHVoJqpUrOIs9hH76DTEB9RGclxQzJBFzhgOA3hshdXimHvyTR3aXjtDkzvMhW9skDgR5f3OrjmbMfUhHUxjLHORItl3g3ZY1G4gg7PaumbksWRGUFqd0YyjB9fMmnRJESd+OUf9USMEgz87Xro0CAgQow+UpfVQykjGSKuLvsXucBMO9lbgzhejhUrMmq5Lyj5spoEL8ouyN+5+PPYO4+4bl8W7QBOCuXzYPPMOa7i6S4UpsH/Oz+1bwFflVTS8D+6GxGCDDAySDm9j6W6c1YpOpZ2VKtMWCU/xmFXg=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"No. This is ASP.NET code, so there's no UI thread, and you shouldn't use Task.Run at all.\r\n\r\nAll of these methods should be synchronous until Third_Party_Library exposes an async API.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"676958df-1f31-3c5c-90d4-01b52ef21619","date":"2016-02-04T14:53:52Z","timestamp":1454597632,"authorUserId":"disqus:stephen_cleary"},{"_id":"aeae058c-6e6d-38d6-8305-69431dfffe9a","authorName":"Stephen Cleary","authorEmailEncrypted":"HNGLvirGAmKnUDqqHHygHaBWlivYK1W64NL7JZBVUPSYKRE1N1St3OOc9pX+d3N/E0xThnbTA25lnrxEr+coN5vlWQ68s0DatjxvVdHlpBnEbC9WgV01S1NFJ9Zk9pK98Jt1P25PFTTa3zUYkOJnplUHqGU5L09peYn7NmGPpU4PXRGiw3mchAar4vxOdufvqTm3T30O0ZKghWi1i1CGqAkCWwxfDmvUpePBYYVHz+GwjqHCs/hEjTFXMS2T8PagwbL+Hq2HRT/tyT9Die/XY1MrIZwaON3k81QwYE9laPg1fQXtJLHg8Tjh53Q4j5nY2qLGVNezCu+VEY0y0CaakBjD4uwEw+T/6cJDxQSZJ7Bt5R5fduefrC2xjO7sUYPeWp23DvwNjVuVZt77ITfUmxvTATX56DLEHlmSaL/3Sk86W2JB/R7WURwoSQEpLBi8vNhAi3GV03pEb6m1fqKUR6LnPJSkRo5VE1ybbS7OMF+7wKJGhogQPc1t/GdNBUaq4CiXWWeF21vufNfWC4qqhg3LbKOM2KR/MhKjaaSdHaP87vVL+5O+0dhIsB/5gspMnMsM0YKAsAfEHdM2G8jolbxbtH7sLziApZul3KEMHgT6UDYjVaBE7o0hg3Ffaz+QbXoShoWau09vWWTpJzuyyAXRl+MNsgOq6KTNoAOxAY0=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"Not entirely. My book covers concurrency in general, including parallelism (i.e., Parallel.For / Parallel LINQ), asynchrony (async/await), dataflow (TPL Dataflow), and reactive programming (Rx). So there's a lot of topics that aren't covered by my blog. But on the other hand, I go into a lot more detail re asynchrony on my blog that I don't have in my book.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"c5b56eb1-c940-3d14-8171-3fae05df184c","date":"2016-02-04T18:43:17Z","timestamp":1454611397,"authorUserId":"disqus:stephen_cleary"},{"_id":"c5b56eb1-c940-3d14-8171-3fae05df184c","authorName":"Dimitar Ginev","authorEmailEncrypted":"pcXe7epY/h0frZdpAIWUvTHcT+EgS6koV2TjMZI2182PGtu3NeyBoCYzBAl9YDD28Zgm8BjKMndm+tFx8WJ3+VmpYqQyvt9FBBNgt/eID2mZAd1IMN+anIoHmczC07wOVMXXPeCdPzMFBQyUhpWvO5bzX73Vw+9Sm/HaOJ3+LWKwpschGLyDI5K4Hw6aAk7Z5rpdQRnsoNOgQld9Y5J7fEIpElhdOXtBWpbmjrHp6kcwTMvedMcuhsHy+1sqZEzKNhseSeotboJqgkI98/VTBdhBthcsAZBzD3isz/M6ZWQxdznwtjXjoBbS1pbrPjiYIORMoy61dPW1yYDSvbTxsXKO62rNpJXjjvgThhb+RaZ0LCp6hJLcste8VWh6tQN2cpcxd3m4U0n7R2cO+AgzjZ+tndIRsvZjdMaOoTeDuji8xa5qZ1m5l6flvYLpybs9Ez2tjajnHC44caFG2ggTp+KKWqu46x4GBmQOLMeF1ZhJDemog7oH5935RFHATR81n6IkqxOP3dCQb9RTgnE6GP1teXzRijF7tewcmq32JdOjgvmYVymkjcthmm1HiEJJpgdC2dvtLjv06Uq6CRbIZpajM1vytLEEpDh56/UUri5g/yZlZAmhVlrburpQFhOEHwbS1hUZr7MLYyuioSa8mRi87Ypb4D+NKHSmGponZf4=","authorEmailMD5":"886756f0c06f96fa34273ab469fbb99d","message":"Thank you Stephen, this discussion and your site have been very helpful... It may be time to buy the book :). BTW is all of this stuff covered in your book?","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"99054c03-1092-3298-aad7-15f236ad74a5","date":"2016-02-04T17:37:51Z","timestamp":1454607471,"authorUserId":"disqus:dimitarginev"},{"_id":"1d6a1c0f-57f6-38d4-8fb3-fead45627cb6","authorName":"Jerry","authorEmailEncrypted":"IuLSc/7pcPD0hX+iQRJ1Ow4O994RL69PNwX6XhZhAVtr48ggb8FjaZyVl/bQnxp5UzMLIaiSYAARC68wkt3IAjF7Z6bcTrxoweaQt9N9wc6a75V+40kfkFcw9aewIlThzwEwgbyVLMURQzjNsMvHirFcDKl+1dRG6rvoRu3YGeLlNffHlZeJsxnuNZ/kSqjzfmkG7xDHr9sDOiDvxIlwnsFA+leBEb1b6hHcgVxPPsWAGOqvhgnM0USPxGWAplX2XP1TjaMUGnZCzJIF8ZXBOWBF5j3F5jUh5iLJsqF1F3tOfeWNYvYjraU3X3sOl2Io+68LCup4ffVEFmKl/cdz/Pm0af7tvXzhn8F3BM7r8AR9rFLwLhmC/EuWAOM2qcH7mTpJl5gUiDdoQgZNo+GdCiGOB4DDYTw9juNqLjgv6VyoPBtwO7A7Qk8r22g62MDk3NIpZp7fqcTgrECmFeHRd50K2Egpf8skYvkNPZaiDUWbu0ONfD4A7XxogEbRrasN+QmzA8oiwul5BERdg5FuTjrFR6SLnL05bjvq6Cib6+Nsd5DTuW57YlXM8oJLvCa4leYhnbnAE/MJehxvPzWoVrlSLE0/uv6MHbKbosh2QXggvA8tNnU1EYUly12YfpHeY/vU1WDcGf1EE15d6IX6+s66gtXxsvJPzFVhQ3q1Umo=","authorEmailMD5":"b21557fd0b177abb61796ab0a849739f","message":"But the web page will freeze up while waiting for the results to come back, is that right? I worked on a similar project that required me calling the third party web services that took almost 20 seconds to finish. It won't be acceptable for web applications.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"99054c03-1092-3298-aad7-15f236ad74a5","date":"2016-04-16T23:20:38Z","timestamp":1460848838,"authorUserId":"disqus:disqus_HrSDtjYd3b"},{"_id":"c6639ea9-ef6d-3eee-81a7-b3e1c2818813","authorName":"Stephen Cleary","authorEmailEncrypted":"WrC6qKDqFTOjRTjND2TprBJ/vetKP0r7Oj/JWZs6OZlVB+WgNlsUSC5wSKxgL/8Y/tHSnTOzcBqF4L/eIskCPsDHaXP98fJ/gqpzazYUaSmU2THXy9gKmPiFFWERddagnwSv2JAuhyr56pQIWWtX8D0LysoB3q+kpOVNSVnFoviHEtfsdwWvTOnZr/csMcQFYv1MPiVLBBHptB0ITQt3ECLeTItUaMjiEV54R5WTLvnxckYXuEyNnF/qFZEjXEdOmtN4k2BIAHsvROj1UqatudxbQBYeh7PsTcKBBkmMNaPPG/YDMYxpcD3MJHNmC8WWakE+10FBcaAbPcoS+3uBGcIqkZvQbqdpdvbf0QqFg25gfArhJFTsniwVWrCWB5uV7sZHB3H/T0zSQGQ16YGORAcHknldLQsi/hiEbP2pe+4Tq6yCDkxiccktJExrSYzEzK1+QvwMlXTEastzwrm5ZhlO0Keb/MhBtjKvdltcW0ynlHyibu1CZ096NgyuiV+TkRqBMiDtNKYd9mqZNLlCOZKA6KAWXA2NAUjQg35RBIdxfuzMCz4ej1GBBftidRhy5SIxKG65XMXdS4rLpIShY1N24Z+Q1DwtTr9JCXJk0hb6MlFuN8buVx67jXSpFCn+y8efzllX/PDy5JM7Av6joUtVCJd9F5TWtuMH06n8ocI=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"Web requests are always made asynchronously. JavaScript cannot make an HTTP request and then block until it returns. This is true regardless of whether your ASP.NET method implementation is synchronous or asynchronous; it will always be *called* asynchronously.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"1d6a1c0f-57f6-38d4-8fb3-fead45627cb6","date":"2016-04-17T01:36:38Z","timestamp":1460856998,"authorUserId":"disqus:stephen_cleary"},{"_id":"ed6d9227-a8bc-3a49-878a-7729bafab159","authorName":"Jerry","authorEmailEncrypted":"d8TFEl7L0Kv+1WpJMpZm++DP42eI2z5PBNDNw4EEHZno0DyuIlFbvPWMx60ncX42HongahBdZbq2a/2CEEaeVQ9VUug9X5aNTskLVHX+njvZpigvfSMoMzDu/SmhspwXCMT7VNUTUOVPBOshaxnmMQS/lmSM2qu3Y6PltGAaK6DhH4FdP7g5Il/7n5Vi9o+s0xFaiuWx+O26n12kfjw7j1H6sYls47pDHkzm+d0C12sBczH2EbqLT6gyFsCtz/ZIKA6s8XBEZDic8ULCWHUHtCpaC8ZBIWdq++J8Q1GDoDwCYHnTYFPwtBDtFmDOPxS92AxajeCTUjAncImzT75D6nwTdsfCSbcyr1cYpLGda1wQS7zrP+j8v3iU1JEs7WX7BlegVTINYOJjg0RNZxj0S+j631W+G8sdbn68n2nQhEtPjiR9RN3Z0ViDCZXhnLZhf0DK5300nfOhoRIo5lpU0BdY8Vyda3HrXF1DhYcxW/DUXoHrlBYbrouRdce1bbRthmfjNLpAaCwcYl0bB6nvmjRpbLvXy+bE7lpttc8C49MAml0nLuC/2yU26q1sk9ZM68NyDxFZNmzjxMuf9BDxbgTom9Y4rp8YwrNtRodTW5Y6/u3nm6gzitpzrQi8YwnB5uITFTMNDq55iVnUAM3U+vJe/o315r/SiLnBFmStYlo=","authorEmailMD5":"b21557fd0b177abb61796ab0a849739f","message":"Thanks, Stephen. Initially, I didn't call the third party services with Javascript but in [vb.net](http://vb.net) as they were actually WCF services. It caused a \"freeze-up\" page.\r\n\r\nTo solve this issue, I ended up with creating a page method to wrap up the web service calls and using javascript ajax call to invoke my page method.\r\n\r\nFor some reason,WCF proxy doesn't have asynchronous versions.Even if the asynchronous methods were available, I still couldn't use async keyword because the web server only support .net framework 4.0.\r\n\r\nThe code inside the page method looks like this:\r\n\r\nvar data1 = GetData1(); //WCF synchronous call  \r\nvar data2 =GetData2(); //WCF synchronous call  \r\nvar data3 = GetData3(); //WCF synchronous call\r\n\r\nvar aggregation = Aggregate(data1,data2,data3);\r\n\r\nEach WCF synchronous call takes around 10 seconds so the total time adds up to 30 seconds. In order to speed it up, I tried wrapping each call into a Task.Run so that they can run in parallel, thus reducing the total time to around 10 seconds.\r\n\r\nI understand it's far from a perfect solution as each Task.Run takes a thread pool thread that may impact other web applications. But how can I achieve the parallelism?","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"c6639ea9-ef6d-3eee-81a7-b3e1c2818813","date":"2016-04-17T15:41:23Z","timestamp":1460907683,"authorUserId":"disqus:disqus_HrSDtjYd3b"},{"_id":"fd093970-1cd9-319a-b43a-8b9c7287c27f","authorName":"Stephen Cleary","authorEmailEncrypted":"tGTnm/cWkSjtk6bWRLmGPawDldy+5VolFqOEK9s4WZQBlXAnsCtDA+gyCnjxjogsyiiHFotZFV2M9WHmbncTTLSW9J5SI30gEltXva8E07VCERbfz3pria5R17Hy2cGSwvqIVaqN3doML62IGoHr2XSqzkx8797h8l9ax1wiFSw+dfzpKsXv/v6e2vQP8lhtU1RmtL4C3hnRIX3FGAscnpkX2dWpxpD9pQnSnU4B+HfeTgaqps7MyF2OHJ9dFH4H/D1uzSFCWsYFnxNNeZmeB04tSOvIAQIorJK3IJtS2r6Uq/8LkMwazZMM6EvJM+mklSElDLgSMFN83jIs/GtOhqwqfrxGoKNQdcIZTwEwnhZ8YiEV2C2MFWpEHm60o7Y4dbhVqBrlENcnd4wB+6xpzGEegPoI7lojbUWKE5AlrwhsEzX87yjGiqqi4H2QcTbA6VGEOdHaj0kX+KeyKMFc9auxUKjF8Pxn4J+87Ec3Bj7AqIOTGqhWXDsRzZ1Q2/X2AGbLe+Iw4G2M/Mk4rzGaFL096Etq5FU7gYHSxJDTICppc2Sl1sbZ8nRdiUlVmvAFyhOhkaKWNbGiFLWgVkcXq0l/5K33ppcHXYcjwcILZBKTq4BxzUR27YzQFHHjRKc443LFANMav3t27VHufjQ7QnLyUYeZHS0ABuV3BVJxiKA=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"WCF proxies can be generated with Task-based async methods, but only if the target platform supports it natively (.NET 4 does not). It sound like the best solution would be to upgrade to 4.5 and then regenerate your proxy. There are alternatives, but they cost a lot in either scalability or code maintainability.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"ed6d9227-a8bc-3a49-878a-7729bafab159","date":"2016-04-18T01:22:36Z","timestamp":1460942556,"authorUserId":"disqus:stephen_cleary"},{"_id":"4f10608b-4a17-3a6f-9207-bf55da02bcdb","authorName":"Chris Cappelletti","authorEmailEncrypted":"TuhOYNWfchnFmpju1fO3H3PYSvRZUYTP8y/uAEPieIu4fkULpV0gPh96Pb07jxTXhwmyq7kAV2Pc6NnKnBG23OMzU8bv6ejWiRuq6Y/0nD/gm8wOYK4abRKkMMhasw0QTZTIZXSzvi549FXQqGHjUmPZhk5AkjJXO4Dha/grsX9OJJMd2X8hQuCOA4sr8ofmbyowbCZHzuVvwfZzrGaZoelPlL24y/SohmYdOHoVldCAVY2SwbkTcBzFbJzx6OchfbeCzv1AzUu4b1HG3VglJ1F16TE5kwW5eliiYImcBrd3bncKqg+joGVtjKHmOZRG8S/PatDC5EH1S0ZFfRFV6xfWTtahjMIUCKSikmvDKHoWVzLRyWo1v/YasAyk/CsxpxblFakra1Md+zhJ8/z7akyqCrJuKad5Y9DYXkxJjbKmPmkMYj/5zcCt+/dVueGNGSxUTuDyg8SW96+lCewXLAoGclun4B/8A9q6iuwpvlUCIAhYuECwn3DVq8WcpebfgtNM7D40dHQTdP4Xul7VDOoBfycMDWQ55oZXA6zhR6hNCVGnqvEYf8EEQtxWOEUdH05SOY+JWY8+Vt6idAU6VYmvTdkoEYA71XbNaHmbznQy2i9JCWFgqKWYblW1rmU3tWvfeK0b62nVwdQJyC+/PUwqzX/WP8pdEyRzgWjEKeE=","authorEmailMD5":"60450cd829ffdf410c3870e6f95730bd","message":"Sorry forgot one important note, the first call the client makes is to a non async rest service call using our internal rest client which is why I think I need the [task.run](http://task.run).","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"fb4a205d-51bd-3cd9-ba51-2f153fd1b1eb","date":"2016-10-27T15:22:50Z","timestamp":1477581770,"authorUserId":"disqus:chris_cappelletti"},{"_id":"82bc87de-0c20-3c12-850c-c9e7a553548c","authorName":"Stephen Cleary","authorEmailEncrypted":"OqLkJDCZjFLY+LOVedWacte/uFOFzjcPD7lfqpl9BH7d3dJrb8mWxHa9kpY5nTW8DGYa3G/KwJqVsqUmEtIdN5cqUkIDhawQyjYKJKhUuPJLP4yc/TRSN00n5L6pMgHxB69DDkLHLX9dvyfqju/CLAKkH6dWj4vUnZC+/Wndc0/ULL2yG03PihVKAOKjgszQAJdEEQGzXpAVu7Q09GwO1GLitNEGC8beqErT2nj99pLuukxdMYaGho7+4bY7mIxfXY0RSdQ1/Ie4PBliD6ZlWRWX/P9/2Q0pfsQtbyxPmS629y0g3Ime77t+cq9Cqwscn3rtCCDTgM0BW3SzXRMgEkUdPXYzspUrCHPnuYqnZRbElZ5Tu3tVSjAlOveKc7ZHMFMeITYAM12CE/m6jSq/Ist3OA5VDgPa9I0nzgolzf4dmi56ZQZumnsoX9Lxr2sC4Vhz4W03FolKayCIcqwm50imezQ0Rgovf0dRTh0KCKs2tOKKKyadph0Gm2dx6woMsiSBcGNEhAfuPUfnAhmUKA3RGu+ixl2KY9BKcpc/Ki3apmvFMoI17WZs/14E7xS4zQ9VVLZ3/PXsqKyino8D901tw1rcUznEHDOLgrXbYhaN173yxKDFHyvu5HABxG/StQR8Leua0V0vtv1Qw/WwfNFJ31yYMvYmmdUKem32weM=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"Ah, well, in that case it's a judgment call. If the library is really just part of your application, I could go either way. If it's a \"library\" in the sense of \"other applications or people will use this\", then I would not use Task.Run in the implementation.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"4f10608b-4a17-3a6f-9207-bf55da02bcdb","date":"2016-10-27T19:25:34Z","timestamp":1477596334,"authorUserId":"disqus:stephen_cleary"},{"_id":"a4262f59-2abc-3573-a0f1-56d7e8be8777","authorName":"Chris Cappelletti","authorEmailEncrypted":"pOaocDsnpwQZCJlVAvh70n2/q6PoBY+zYb0tGS78MRAQiod6AHxwbNTk3y9PYCPicWYeomqNK/SOGWye4hArw3hAeTWB5Q+4HKjbuPRKt3MBZERU6Gq8Ml7dMKCY1UhDpkVLdRzJ03b0JJAL+r11VtddUNw8PVIl2lImRQLQjLgfR/BWUcBpnwbJiHN21Zo6ApKyIMdwotw4TADuW5oAeK2Kvf8KlUWiN8YAtb+nRZ5elCMNXhxbBISYaiB0qU5VmqBsRhpe5dGi3+oEoqzbww4chIiUQr4n+yeSxAA5zY7Zz7LhwerJLwebYB3Ybtx+TFr3mO1VZ1ruedxeZGP3+H3+1L+X77AeH+V4rgNhZTIuLEs88asLQkqBNVWQsPt/HUr+RGSN8xnpUiFk3dbi5kVbyUC5Z178O66ReWbfYy4A8eF6G3g09UESWhsqcy5utet8Emse+EhkozxlK/OaEBBU+7CM+fAHNou8ds9fyQMBs+rB+Qp/iKWemT4qyFNkE18Sp3r2SLAOfu8DeWjTp3d5WGcpWolT7IfrX5RvUhwhjkUIGh/LAICr4FYXChVwA9L1wbPQZ4RiXqoG0orvx6ilh5CyuUoNp9snAztLnuiR5iETcfqPwG8KoKwbTkNYNAI8z0lnUBAKMG83u3NNNhY6+052BSkwjqnBqfkxoZo=","authorEmailMD5":"60450cd829ffdf410c3870e6f95730bd","message":"Im trying to hide the complexity of a system by wrapping it in a client library. Basically the client consumer awaits a call into a do-a-thing-async method, some of the arguments passed to the method control how long the user wants to wait before abandoning, like a certain client understood condition, a timeout, etc. my client implementation uses [task.run](http://task.run) with an async delegate, the reason for this is that Internally I'm doing awaiting on a semaphoreslim while waiting for an appropriate series of signalr events to get pushed from the server.\r\n\r\nI'm following all the TAP design rules, configuring my awaiters properly and doing all the other things that I've read from you an others that would be considered best practices, except not using [task.run](http://task.run) in the implementation. Is this a bad idea?","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2016-10-27T14:55:04Z","timestamp":1477580104,"authorUserId":"disqus:chris_cappelletti"},{"_id":"fb4a205d-51bd-3cd9-ba51-2f153fd1b1eb","authorName":"Stephen Cleary","authorEmailEncrypted":"XEQUKnIK1zBp+xtJi4urTER4yBe/Y3mrgTKLaoaM0fcm3WAGxuMzAibuxFEG8lq3+IyPS9T0OtSqh4FlaHZBXcUXOMFMUHs7yiTM4zb8CkRCdKsW+P30He8ERSLoP5Atw3mAmWh6KsoqLVH0I8+ZSPlTCkFuAT1oyU9Faz7q2i3VsAlIE296UjlNiDe3CjeS43Xw8/JxZKBWroEMGCYHg7RBUzUlCXRKXS2mB/HQ1lOHhK6K2aBKyIWwTySI4NcIRlHind4NcEqV8nbY27++FVi6R0U17vCr7M72gvgL9+nPSkmPlh7UE7yaQr9f98ZX1UfarmBwpk24nEHjHYpWBeFTaCw2B3eK5EydauSfTskRw0Lsfl9JXCBpKYeLGiClAOqU/9WJ1M5sI7KZwGRv6bXlY9hh9vkGtFhp8qF2oR9ifXj0QHQwqoH2CI2KMmJ85BQC6AqK/pLuX3GWYuLaMHM/Czb6TswJf1ex6pnZtpY78PCFZm2fasy5XA4Rq5nrGTwnp1HuARc5kvw4nQ0mCChMMdBuKtEbJK+i7UIXaAOHwNtvO3KBPem8ypOaOf3ICuWDduDIsJPYm30TioWR37G1ejgWRVufJmtZ7oYFJqwGKT5enaZW8Zq1gbhHJFUMrg6D2EbRQQ6HY0XFpmhfYLgVugMCpIhOR+0xWDFyUXQ=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"I don't see the need for `Task.Run` there, so I wouldn't use it.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"a4262f59-2abc-3573-a0f1-56d7e8be8777","date":"2016-10-27T15:08:19Z","timestamp":1477580899,"authorUserId":"disqus:stephen_cleary"},{"_id":"83408f05-dee6-3305-9c25-a5d2248aff4d","authorName":"Eric Brown","authorEmailEncrypted":"rjmYOYUxD4bgmOdeJaqdLwulwtXQMJaFT5LkVBtiRmq50xaAd2XA+5IQ4/lyVeof2AyEtnozELXmALBK23cv5pRXIrGkAVNPYrTxD3o3Fpb8KmsvF6Ph1ju09EnE/A8JTFegqJ9g5pHdwRncdyRw9wG86hOLLSGjR22e/biLkEVWWHuP0xhNCTzBpRVHy5B3snSUvO16e9QPT6lQ0PH3PrUFOUuIKwgJHcxI4ch6hVaRC2vRxWBPfW6LcxFDNQ8dYaaH4x5kfGrr/JfZ+WDHRf3bWz7DbRrGd0oBcpMfDf3pDKe9jqi0I33NC9uFBwwYwFDQ+ASy4tXtt9Paj5dtOb8/6JaPSu5okRCoHGlMnnIgd0A9YAZnOaFkEY2wD3+ViXINdjVgIDlzcsLABqxJyd80ARz6dWnjmcr+UAVpg95xrjD0mNbZn4ez9CCgAbFJfOcHwTx2ydncSi2cmIbPmtH8ReHonlC3O2RV9W/DIskzRJ471yjTQc3OSurLRLivAElUQtgKkxJfRFW+pL1qdKwmhsPoodbQxD2Sn3bR0tScZqhiGCuygvuGxA5TB6cuY0P3TdWhFJSTru4Jq/41lmlMxsVraMvR8Lvv3rJN6bZTcUyEI5EvxNrN41U1rD25WrMs/+12db3Drk/lZZhC/1kVgVGVww0oVv9Jg7IKIoI=","authorEmailMD5":"e3de71ea948a6b6d854d34256cdb257a","message":"This is SUCH a good post!! Thank you very much for taking the time to post about this important topic!","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2017-03-15T15:13:20Z","timestamp":1489590800,"authorUserId":"disqus:EricB1007"},{"_id":"3cbe602d-1f36-319b-8f5c-94dfef1d7bc4","authorName":"Joseph Louis Lagrange","authorEmailEncrypted":"S2ON2z5SJRwaziHbcFz0KTNxvgZD/lMmPLtNKfx+bLx5UTLcd+k1V5X4rL6nKgw9TpJ5pddk6X3DCSzReEZHutW7yuO8tPoX9pjUUrhUaWPdGI+CKFVSmx5VUVvlhip5oCo4iA8QaVYC5MjGiE0hjckPlmJSxszPgUDBo0K2WWV7A6pxUJYl+9WSi6FZDBktahMYyw1YPethTK4gop6wc/sxYy1C3EMp2HRUvjVsrnCpzTCbY+xAoj7yy1Z5LZqU4D8Kem8owH/Y3VFJ1Gg0kT0s3CdNt6RSgiALB9GGPODuDtSBiFGeTO+Q70sOr8pgdVU8WgLTEhqzNM0QwyjOd0xLPpm5A1LOKRZhREoLetWlpo18CKEaCDMkQRR1sl/Xlr6WwCr0A3yaZFFj7Tbq4uc4nYtAQqYuYoqVvowxu+N3Tn/tJ5zE74Exg/geDs7uYlBk9swIixi9VL8Aj0eUJ1bmzvKPkyKriuSdRtaK28FB2HjUs7apX6OJL8w/rzzVhaZa/Yxe8jQKN/mPxFerpagvZ4qQFDTi04Zm43X4I1bBD44nWjJARWx7uV4iRKTuonV5D+B5d3/PBBzxNsz7kZ0hS7xlgP5uii7hC9h4oilepzXLF2fxHxI7yXu1l7etKyyFWvrTi6j5UvF6X15iCS9t7Luqj1hDC3peuHsltDk=","authorEmailMD5":"7e6002f0e0c986706f0d834f7db3c134","message":"You always write the \"asynchronous signature\" of the implementation as Task MethodNamaAsync rather than async Task MethodNameAsync, why?","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2017-10-30T02:15:37Z","timestamp":1509329737,"authorUserId":"disqus:joseph_louis_lagrange"},{"_id":"c2feae65-2aa1-360b-9ff5-fd995ac8371e","authorName":"Stephen Cleary","authorEmailEncrypted":"mV2+e763+wvQ19G/WVruvzZ3YLSEfSEUAgDpYSxekhAWFNOo7W9dAmgwWg8sr5G9QffnLk5rFzYUquYzxjhWu1+ZVYx2Vd42uxgYpyv4FnKRNeADzgx/DUMZus4sH49FQRD7fPhMBPXlPSccM/RE+4+R063uAgmfbwB8D3DWsLu6IFgSgp8jBeN104QEnQG0LANiIi/bPIkA8e4Uw8dLN7tR314jLc9MoDxNg7RiWdCkvOJI4W6HQwwc1/2WtsmbGkJsxRQ70WaTDiugiLlPqdFb9DY4qVe6t/VMnNczIueqY9NmtczW074slOJ5OmlvUz1c+ae5zB7y94VXYsQuoDIiHGQBbXSl6Q0cRp281itavN1Znj0PjDCWuFcRiS2fewKc24DxIwFeo1CTGQrmlvr0IbHk7KAC4Wq9+F6/4HW2kwlTm1lCAJv4YGBn7TmBxCamqSlIQa9wazoOV4lDu+fG714CBhkSZUOIB0+vcgza6wgJDBQa0TrXsjo/qW7Pn90971D5TyA+7z1IJVC7ZgWAzPkzriTTqb55LKV/jEVIrfb+luMf2dNEQBL4tYR/WzgFInFfqQfieVbFL3UI7N42iXLExIzRD8ibYN/ZWVsd+M3wmlMrWaAyYnRSH4dUqcf2OyWCytRyZy2QiEt9YRruQf/FahjZwmMBW903p+M=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"\"async\" is an implementation detail. E.g., if you're declaring an asynchronous method signature in an interface, it must be without \"async\".","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"3cbe602d-1f36-319b-8f5c-94dfef1d7bc4","date":"2017-10-30T12:34:28Z","timestamp":1509366868,"authorUserId":"disqus:stephen_cleary"},{"_id":"1dd2fe02-02ac-3a22-bcb5-3d8ad3a86f5e","authorName":"Scott McKay","authorEmailEncrypted":"a5oYA7Hx1zgmy4RrudaIqLYXzwYpvRlyKadbokS/3zpOslYTOA0ySuz/r6aTgrNQWhRz/QowOjCpN4l/1lyYGOQyhhwYYAlCHQEa4uLow0KIwhuQxTzE5zH34DwEn716KDuF5v+69AYv06lIRt/6THTm4h+wpzkRGTCJeIbWKctdpnHin08ja1W/YUGl+pKqWdhTMAp6M1GsX7dAlv5efqAqUZK4e0nueHAal38XLltc3OdHgi7iDrM4WZjNkMDhnLjXfRXW/XTLpOndtJCV2rbqiZRfyVS3fxY7vBsG22Exq9aXDRDfp4URdOc9sxquJXHr5XKmXx82bG+KcjxXU39iBYjqp75DzsH5upWZPV2rO2uG3w3QQkyJ2EbDg2YjMYvKyzqSLut2U8da+D7Y2Ja4Kso2zUdiQ6mYwUpt4zRnTRhngk64N8WtI/mMBE9E3/B175ky2bGBkJkhmOG/XNRRTAYVAzJ7zNUqnEW2G0HzdilRIc4ZCqq/OFK2aIzANEaR3jHueEy+pEIyLjGXjJ93aAuppZuiS2PMiBtGGWPsjpqPlaVQ/f33s4E+ySwUJ1VRAN2gBsrayuH2Jvrr3CNpGsR1UaKNwOF3OqHFjwHt/rcSJl3GQB47Kryphcs3QMqWj+lyjyuA+GMqA1JmnmVK3H9eOdjClylt8Is3Ulc=","authorEmailMD5":"384d2327b00c037623207507e3a14cc7","message":"Is it valid to use Task.Run when processing a batch request (WebApi OData in this case) in an [asp.net](http://asp.net) web service? There's one thread processing the original batch request, but each item in the batch is really a separate request that is executed using HttpServer.SendAsync locally. If I just use Task.WhenAll with the SendAsync calls the subrequests execute largely synchronously on the thread from the batch request. If I run the sub requests using Task.Run they execute in parallel on separate threads, which is the behavior I'm after. I haven't found a way to get that parallel execution more nicely, but perhaps I'm missing an way to do that in [asp.net](http://asp.net).","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"","date":"2017-11-22T09:53:24Z","timestamp":1511344404,"authorUserId":"disqus:disqus_U6noZg42Is"},{"_id":"1a2b43f7-c42d-37da-9a5e-3e4da2af94a6","authorName":"Scott McKay","authorEmailEncrypted":"JTeGLCt4qvDBHqNIDYILzsaD/LJ3/zP9YSXaEqa8affSueHr/AE0VEE9PRIDRzs1Og4Iy84oJ8zLX0kv+6mPcu20e9l2RBp76Foi8GTwiDsAcD12bjIbtHgVFfK2ptKuHyPSMwq5+We4QPt86E1naoMtK1ivnlpbyn9c0lLgqkwjiWftWP465TLo4Dn9OV9VHySLtjdfuQSZgumJpwAnAySq6V/kRL6PI6gJWdtd03oWpcWxUzCMA2hg0a8k9Z7Do4wadLwLB10zZHJEsuHiw6naZNH9LnJzyKLA7tmCLEw+MtmAu8imQVEbB2xggGg4FjealrDQmA7mWngY91ooaQFP8hzIZkrugYAkOO7F9do+Xbzr5Gb3Gh8uWEMF97VEbRssHHsZYMmzeuJZsGqIt8itU4dlhyuIRRY1b0l1D81KnXDhKHinf3/Sdhzc5GBwo+rWY8RGZ8NEWLRdlOY/KOZvkwGPfa8NT30+0OLZbKtwMqpKhJer/JkEdkhLID9DTXKnM+ZYHpDJcIX4Rh5Bel5Evi3Kq/OCvqtEEF5+S5Qo3U/UTzEMCguYJimauAgh1f9bujbAV1bokgWXCzZbpFGdr3gvMJvw2mgjgQ0sHFocumd8FOa66dJWyW0/5ChakSNWt+e44gEsAQIqqakYOdxPCfe80qhFNDRCoUqMQmU=","authorEmailMD5":"384d2327b00c037623207507e3a14cc7","message":"I have a special case in that I want the subrequests in the batch to be processed in parallel, but to re-join them all (using your AsyncBarrier class) before calling an external system. Due to that there's no async I/O in the initial subrequest handling so they each run sequentially until they hit the barrier. To force that initial stage to run in parallel I'm now using HostingEnvironment.QueueBackgroundWorkItem with a TaskCompetionSource in the Task.WhenAll.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"d5438ebc-ffca-3e3d-a98c-eca36319ea20","date":"2017-11-28T21:20:10Z","timestamp":1511904010,"authorUserId":"disqus:disqus_U6noZg42Is"},{"_id":"d5438ebc-ffca-3e3d-a98c-eca36319ea20","authorName":"Stephen Cleary","authorEmailEncrypted":"ApG2/dC8uqlvpxpIhxVd1/47jOfsGQJYi/WV0D5kQvMTn+FAS63AQd7sYIAW37owTsAi2chHTpG4zyvYCxaeqDr+JA2wPg0S/ateHhGNchI8cqRIeGRMhQgQToJrGU5BHVtB8waOvorzFGxRfpqa/i52jcWB3Srbx39Z38Vhvl6ySudPLdKhe4eaaWlGbAeSFnS2RtuS0Iya54l2eFyYgYK6jxfmMojQ9ZD9S3FMMxjkPKm33UbtC5xJRD4P4hN7Sg+aKvHaGeN9/SruyRWSJcOtKPxHhZTdY6zy2jEB+x+0iCAjIsRCoj20BXooRWd0XQO27mSEsfR3DOLBoGE+YVvUu8Y1u2ZjCJ4lGv9FlwRkeOTxvmSMoIyFZrE8cYlu5jHAYuAU9BvliEmtHIUdpKzHmmXBQEOgPXuh8mCPjwpTuMPXU4B1HJ6yl+CWj3aExq+F0shWPr7E9fkWYX4Hbc0I48QstbbiQzKUX5dwN3TMyuUkqb6XaAdHF39MEtMNpgtEsQU8QDFLYM2TvD8NHKD4iAGa56FQQPim9TQD7u3fk8OD5KQYKpun4cUHzk9CjHjE/6wg0cEHjTDJNqP7Y/NSEUrrZn06onKpBxksMDb8frjzoA8SRKitEbOKQaDZQd0vtg5i7pex9pHVo3Oj1YYS9xA9CdLLDYm9u8T6xAA=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"I would not use Task.Run there. SendAsync with WhenAll should operate concurrently; if it's not, then there's something else throttling it. The best solution is to find out what else is doing that throttling and fix it.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"1dd2fe02-02ac-3a22-bcb5-3d8ad3a86f5e","date":"2017-11-28T13:32:52Z","timestamp":1511875972,"authorUserId":"disqus:stephen_cleary"},{"_id":"1d9750d7-a733-3c8e-8639-c02c3baa6c08","authorName":"Stephen Cleary","authorEmailEncrypted":"Nq7KL3b2d7VIK9Di6iBnI+QT5OkUMyFMtcdsQK6V5OztvKsPqSglfoqGPfhPKXDsVL1n6Oi3NWmCigYflXZLjZPDT2ypK+degRh3/cazFn6/RkCAl0gQcVog28kyjdjX9bOXeDgjIvt6xrBEPB3pthckQh9Fyj501kGjuv3f1EggQEjnKU7uxmxNLcyDx83AS7SuU5jbOJlno+hrRITp0ZJgO01XP1aISbKG6kLJa8MvNRVqqKHIZ5NIHW41DXAOIVOnk3XQl/kN7awK3SiFAUojKS9DzLgRHU8IMhjDmmxUEpEdCr1v2rJCnGTryM2b54pxgMRrZ9J85wt4G9UM4eoq8lLQ/RjUEcTJd9FyamF85QqcN82m+xcj6TGG/x8yhJg/66BtWmd+6cEptN0Y16Yssmj5/83ybnNhFlujr9CBh8hXSDjYoVwUiByZUlYs1Vm/zJKqVTzJv+5zNEXOLS5exFY/w3PiSmqx5SyCusgEPjEJrb+wEZXIYcBKa2YTn8cFTjudlpA5TDBzw5/jaQpmODOQfNT99GurCr/q6T029djDlJBxhTWxZkRtM6od+p4sopHDxxxilRAyLsZiui31Ut9nDUXCnL6hQOf1TDOS0vulAw//82lsQZ7y0BKnpwepIRaqHShqw0w0Oxa8Tb1i2CJoyiaJTz1hPCpJvfU=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"Ah, you wrote HttpServer but my mind read HttpClient.\r\n\r\nMy first inclination is to let them run synchronously. If they are being handled synchronously, and SendAsync is behaving synchronously, then just let that stand. That's usually better than introducing parallelism in an ASP.NET environment.\r\n\r\nBut if that's not acceptable, then I'd use TPL Dataflow here, rather than AsyncBarrier. I'm also not clear on how QBWI comes into play, unless the main operation is fire-and-forget, which sounds dangerous.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"1a2b43f7-c42d-37da-9a5e-3e4da2af94a6","date":"2017-11-29T13:53:41Z","timestamp":1511963621,"authorUserId":"disqus:stephen_cleary"},{"_id":"37ea80db-2310-38ed-bca3-1e1ed36b6213","authorName":"Scott McKay","authorEmailEncrypted":"JewP06HkrXSSagGuTrSvE1c7PFB1AFggmSlO461a8Gkw0m6I2VZjK/spAOzntuMWN4wletZ3ZucaYh+0CyuEhCjhYd/k2DejaVAy3z74Owtqz47YrWmfkX91XwxiWmKDEOMWEDDhiZKblPtoi8gE/wk620CNlvUrQXzYOyKt+4hIfHyQ6y064dLvlaBhhdViYcWzve5w3FHEpR8Xsn2anhI+eEBZeopzGGL+quMvRHOWq76PzfztJ7UCAMpRiwNfyXPMWP/u9PH9r51ifeA7tVbn/D5ll4Y/1NmxQhHUu1HPm/SKdeUOBbUqZpL8Yj0waGy4s3+ikCTDUuq6dqvl38O8lbPIECOSv9PRqfLd7fZtPlampc23O3cYx8mJSHIFqmgSMU4GLSImDN78dHUZSCrd/Fr+xlakShH5lcNtVtPr9+4h7RMWoeS3XMkOAjbmPun+1Rj+NM8PW01pYGy+GDWqV1MwnrJcLsrkcbKtuhPZL4KHW0vRKP6vagVTyhUyGtoTiFGWHUYUwo+oZriJEOu8fnOozMP0L46IbL/zw+dTVMU2SgoRMW/j5ovyMES29GElorffDubt08Z5mXgeb0zw4p9b98YVPDKFXPHTguzOXvMVmnzT9Wi95VOlC1651wauXoDTU95usAO9jDT+67fhufD6NuVj+v09+RIwHsk=","authorEmailMD5":"384d2327b00c037623207507e3a14cc7","message":"It's a low latency service. Letting them run synchronously costs me over 1ms per item in the batch. By firing off the subrequests on separate threads I can complete an entire batch of 50 requests, including a call to an external system, in 10ms total. If I didn't care about the latency I would definitely let it do its own thing. Obviously there's a cost in running more threads though to balance out.\r\n\r\nI'm using QBWI to fire off the subrequests essentially as completely separate requests (an OData batch is just a way to pass multiple standalone requests at once). I wrap that in a TaskCompletionSource so that they're not fire-and-forget, and use Task.WhenAll to await the subrequests completing. I could equally use Task.Run for that, but I thought QBWI was more standard for ASP.NET. I would prefer a bit more control over how many threads were potentially used to process the batch, but I'm avoiding adding that complexity for the moment unless I need it.\r\n\r\nWhilst I run all the subrequests as separate requests, I attach a helper class with the AsyncBarrier to the request properties. When all the subrequests meet the barrier, I combine their info so it's just one call to the external system. I run the subrequests as standalone requests because I need the WebApi OData processing of the request input and formatting of response output that happens when I push them through the non-batch route.\r\n\r\nObviously this is very specific usage in a low latency environment and brings in a few of different considerations.","postId":"2013_10_taskrun-etiquette-and-proper-usage-fe7a94d6-0c34-3e54-ab2d-97969a27b041","replyTo":"1d9750d7-a733-3c8e-8639-c02c3baa6c08","date":"2017-11-29T21:45:55Z","timestamp":1511991955,"authorUserId":"disqus:disqus_U6noZg42Is"}]