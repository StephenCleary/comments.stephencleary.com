[{"_id":"d50b40d3-79e5-3a71-ba5b-218436f856e7","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"@Anonymous:  \r\n\r\nAs far as I can tell, you're not using the PacketProtocol class defined in this blog post, so I'm not sure why you're posting here.  \r\n\r\nA better place to ask for review would be the NCL forum:  \r\n [http://social.msdn.microsoft.com/Forums/en-US/ncl/threads](http://social.msdn.microsoft.com/Forums/en-US/ncl/threads)  \r\n\r\nwhich I see you have already done:  \r\n [http://social.msdn.microsoft.com/Forums/en-US/ncl/thread/3d6681f5-7164-48d7-b703-e63ece938be0](http://social.msdn.microsoft.com/Forums/en-US/ncl/thread/3d6681f5-7164-48d7-b703-e63ece938be0)","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2010-08-13T19:49:59Z","timestamp":1281728999},{"_id":"1431827a-cd69-3f5b-a348-d162144b7728","authorName":"Wannabeuk","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"Im not sure if you still check this, but i've tried to use this class as-is, and i find that it only works on the first message. Any subsiquent messages return an empty string.  \r\n\r\nDo you have any examples of how to use this class, perhaps im missing something, cheers","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2011-04-22T13:35:03Z","timestamp":1303479303},{"_id":"405a7e2c-8d87-3830-922d-fb227144a21a","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"Here's an additional test, including checking the messages passed:  \r\n\r\n[TestMethod]  \r\npublic void TestMethod1()  \r\n{  \r\n int numMessages = 0;  \r\n var messages = new string[2];  \r\n var packetizer = new PacketProtocol(2000);  \r\n packetizer.MessageArrived += message =>  \r\n {  \r\n messages[numMessages] = Encoding.UTF8.GetString(message);  \r\n ++numMessages;  \r\n };  \r\n packetizer.DataReceived(  \r\n PacketProtocol.WrapMessage(Encoding.UTF8.GetBytes(\"Hello\")).Concat(  \r\n PacketProtocol.WrapMessage(Encoding.UTF8.GetBytes(\"World\"))).ToArray());  \r\n Assert.AreEqual(2, numMessages);  \r\n Assert.AreEqual(\"Hello\", messages[0]);  \r\n Assert.AreEqual(\"World\", messages[1]);  \r\n}","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2011-04-25T02:20:10Z","timestamp":1303698010},{"_id":"5064f629-8dd8-3ab8-9261-43bef8974a36","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"@Wannabeuk:  \r\n\r\nI just tried it, and it worked fine. Here's my test code:  \r\n\r\n[TestMethod]  \r\npublic void TestMethod1()  \r\n{  \r\n int messages = 0;  \r\n var packetizer = new PacketProtocol(2000);  \r\n packetizer.MessageArrived += _ => ++messages;  \r\n packetizer.DataReceived(  \r\n PacketProtocol.WrapMessage(new byte[3]).Concat(  \r\n PacketProtocol.WrapMessage(new byte[4])).ToArray());  \r\n Assert.AreEqual(2, messages);  \r\n}","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2011-04-25T02:10:01Z","timestamp":1303697401},{"_id":"66c7efc9-c5ee-3d4c-a949-0da8c44edbca","authorName":"Fredrik Blomqvist","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"http://www.blogger.com/profile/02690296548623493995","authorUserId":"","authorFallbackAvatar":"","message":"Great code!  \r\nJust one question:  \r\nIf a client writes for example 200 bytes of data to the stream, and then stops, and this code reads that data (which is one length buffer + data), won't the code just continue to loop through the rest of the readbuffer (which for example is 4096 bytes) until it finds some length data?  \r\n\r\nWhat I mean is that it will loop through useless data, when there are maybe some new data that has been written after the readBuffer was filled?  \r\n\r\nSo instead of accepting zero length packets, shouldn't the code be notified and then just throw away the rest of the readBuffer? Or am I totally wrong now?","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2012-03-19T03:54:03Z","timestamp":1332129243},{"_id":"767f7f1d-9074-3551-bb45-9c048b4830dc","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"The code in this blog post assumes that DataReceived will be passed the bytes read from the stream, not a partially-filled read buffer. It accepts zero-length packets to allow the other side to detect half-open connections ([http://nitoprograms.blogspot.com/2009/05/detection-of-half-open-dropped.html](http://nitoprograms.blogspot.com/2009/05/detection-of-half-open-dropped.html)).","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2012-03-19T17:19:58Z","timestamp":1332177598},{"_id":"0e888e22-92ae-30ce-a1f5-ae66657cf1c8","authorName":"dsdstnv","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"http://www.blogger.com/profile/05782625689903846191","authorUserId":"","authorFallbackAvatar":"","message":"Hi guys,  \r\n\r\nI wanted to ask...this code,does it wrap any kind of messages to IP message?  \r\n\r\nI needed to wrap Sampled Value messages based on IEC61850-9-2 to IP message, then to transmit to another PC, unwrap and read it?  \r\nHow could I do that?  \r\n\r\nThanks in advance!","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2012-07-12T17:51:59Z","timestamp":1342115519},{"_id":"cfcae4ba-272f-37e2-8c79-55ad4c298895","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"No. This code only does length prefixing. If you want to wrap it into another kind of frame (like IP), you'd have to write that code yourself.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2012-08-06T17:56:15Z","timestamp":1344275775},{"_id":"a2abdc60-698e-3143-b6cc-a8c74faa7548","authorName":"Musterion","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"Well done Stephen,  \r\n\r\nThese series of articles have been very helpful.   \r\n\r\nI am working on a middle-ware application that receives messages from multiple applications as xml or fixed-length strings, sends them over TCP/IP socket to a back-end system, gets responses and passes back to the respective application.   \r\nHow do I ensure this middle-ware application is able to cope with the many requests it will have to handle? ","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2012-10-12T15:05:07Z","timestamp":1350054307},{"_id":"55a5295c-97bd-3885-8f6d-3511c66d1e26","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"You should be using asynchronous I/O for all your network communications. This is good advice in general, but especially if you have scaling concerns.  \r\n\r\nIf you have control over the protocol, then impose some kind of message framing on the xml messages. It's possible to detect xml messages without explicit message framing, but it's quite complicated (and inefficient).","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2012-10-19T00:33:39Z","timestamp":1350606819},{"_id":"837db7aa-290a-39b4-a39f-25c51825a4cd","authorName":"Michael Mankus","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"http://www.blogger.com/profile/00879337794584805047","authorUserId":"","authorFallbackAvatar":"","message":"This code has made my day! I've been struggling to create a message framing interface (without knowing that was what it was called). I was trying to implement a message delimited solution with no luck. I stumbled across your description of message framing and subsequently this article. Fantastic! It worked perfectly as soon as I dropped it into my code and I instantly saw all of my communication errors go away. Thanks buddy!","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2013-04-30T00:29:01Z","timestamp":1367281741},{"_id":"c28e2314-887f-316b-8524-3616bc8c39f5","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"My thanks as well. This article and the example cleared my thoughts, and I believe I have finally grasped the issue.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2013-06-11T11:59:12Z","timestamp":1370951952},{"_id":"9ea1c70b-968f-3ec3-96c6-cc4afbcdcdd3","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"Lots of thanks for your articles. I stumbled upon EXACTLY the issue with my server-client working perfectly on my local network, but when used over the internet, i realized that multiple sends dont always come up as multiple receives, and I was not grasping the issue. After reading this framing tutorial, I will now sit down and rewrite the entire backend of my code. Not that much fun, but Im happy to have found this site for guidance!!! Thanks again /Andreas, Sweden","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2013-10-09T17:16:56Z","timestamp":1381339016},{"_id":"6685ef42-13a4-34c9-b825-61717c5a9ff5","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"This is great. I have a suggestion though. It's allocating a new dataBuffer for every message it receives. If you are developing an application that is receiving tens of thousands of messages per second, couldn't that impact performance? Couldn't you change it to just allocate the dataBuffer once to be the max length, and then reuse the same buffer? It would mean that for the MessageArrived delegate, you'd have to pass in the length as well as the bytes. Thanks for the sweet code.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2013-12-10T13:37:00Z","timestamp":1386682620},{"_id":"d0782b63-32f8-31d3-908e-c388f5da6313","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"Yes; in some of my high-volume solutions I do use a \"buffer manager\" to reuse buffers when possible. However, I did not put that in the sample code here because the purpose of this sample code is to illustrate proper packetizing, which is complex enough without the buffer management logic. :)","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2013-12-10T18:02:18Z","timestamp":1386698538},{"_id":"a7a6bb30-b756-3dc1-b0f8-17fd30bd69c9","authorName":"netvillage","authorEmailEncrypted":"","authorEmailMD5":"","authorUri":"http://www.blogger.com/profile/10693749844405191284","authorUserId":"","authorFallbackAvatar":"","message":"Thanks for being awesome","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2014-02-02T04:30:11Z","timestamp":1391315411},{"_id":"284021bd-3f8c-38ed-be12-088588735f2a","authorName":"Amir","authorEmailEncrypted":"d/yU6RwCLotQqCCBz0Q6ytK06ek3RCpNLfcmVXBB9dU3/yPhJjzTIi015uNEC4c/xi+GfelbPyfBBCJcAHDXGBcmhpYO00FRzWzfvr4F0XiTRWJ1fSdh5wscsIITU8iEX4scvLM5p6pFvvQscnuw+kfB8EJM+JGAD9DLopprqyBOy6Mm/WZc06vFo4TeAVA+vwtqmcR6K3w0Ypk3fhKstNlThN0zS7whStM4dcIPoOxh/f0jR8BRlyDfU2iqsvbuwfrGhI1Lyjwde0FIgbKQ8tRdX5CGRFBTp9uyPBHdsqTwKPZZxU7qMm/2ASFyQPd5HJ3TEOIad4G51XC9iFOK5xbFj3hFsLf2vnlxK04GtHJ1gn6M7zlCo34BZ6AWb3a028czZ4pPKh/wjgI3OOhLjxg3dWoCgnEufHw+0LozbKFFoDp69RaIVK1jmYEqxp5RVWVfgmq3UE77msG57Sp5/39B685gDmE5KHAvKile+jAEADm7ItkChD5X46VM72h7D3wH+6wpOM3joDZidz/ZZLHEV/TSx1jkLlQ6mHieFrZK1XpTPOKBoyjQm7toExF2q+9kvMavs68TsUaIeJlOSy4Ku/fkdpWsq4B4Qk/mC/ts0oaynww0++SCL2ZXXALqNzx5m4Svkmjw171bSo/CsAS1xFJck0xvzxzG450MlLs=","authorEmailMD5":"fb538b1e65a06ca517809472352602dc","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"Thanks for the code. It helped me alot. However, there is a bug in the WrapMessage method. Instead of   \r\nbyte[] lengthPrefix = BitConverter.GetBytes(message.Length);  \r\nthere should be:  \r\nbyte[] lengthPrefix = BitConverter.GetBytes(message.Length + 4);  \r\n4 is the size of the header.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2016-02-26T21:45:14Z","timestamp":1456523114},{"_id":"299c23ca-8440-3fdd-9968-69f2f6659842","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"It's not a bug; it's by design.\r\n\r\nThe code I posted does not include the length of the prefix itself in the calculation of the length. You're welcome to do this differently, but you'll also have to change the receiving code to subtract the length of the prefix.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"284021bd-3f8c-38ed-be12-088588735f2a","date":"2016-02-26T22:10:28Z","timestamp":1456524628},{"_id":"70a8f0dc-ff68-351d-8fa8-8ee45c69e83a","authorName":"Amir Kargar","authorEmailEncrypted":"QOmLb7Z7c+/h0M2LmjocqYjbyNJ4Cz7KXP6FXapyDnGdghiTb5eh7rJFAOUU1JiCVzfuXJ9XtYzHV/+Ai6kNwpUk6dgBJYBIxzGiuwTILjw3WLCHAoC2A/su86a3L9iE+bm7naZ9R7Ln5DL0NzboB8w762aigjTD3mMfaFVXXTfF4LNlZ4EYUqws0HtnbNYVYI1CbJjd8KUAFkzO1MMoFZaSmg3EWpTBleZS+1ihydYztjEqcEEWkGAmtEXNm9dbGdTjkffswEs0AZ8h7P8eM8Mo08+zZQIAP5SvyG9Vqh96+s46GZ00vOyVFyaT/JbLXOoyOYnkMeR5zyOalFyD9SbTg+SIjn/asaUCltRGPrYwrBZXqYo1rVEThlUT5MRErIWHRBJU1KELo813/6Vvbr6tCXBQKBlZc4tLyHij6/vVyDKl1/PuYWKh+QtxNxuPfpPdTLixVOZ8CVjsUDr855AZQN785yEXyXCEG3/v4ZRnIgB+8PL0pTDA/gj+c8QGiaHjUH3kX8oJXuRVDzsnz7D6+yh8Ik/YqXFnm1rrxNh9C2FkmiSbdZ82Zy7+YdCCmhyqFpT3ikPOKhb1HejBWns2Ss9dLnL962yWeVzbNRVlbxrZ8q3uwvPsDf4yc1P+kjSBIM21Dml2PtOrC+1DGZIV/GAfZ302p50j5xhOlpM=","authorEmailMD5":"f3affe085af34481a66275b6423c072a","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"You are totally right. I am sorry. Would you please help me on how to use the WrapKeepaliveMessage() ?  \r\nMeanwhile, I am using your code and works great! Thanks!","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"299c23ca-8440-3fdd-9968-69f2f6659842","date":"2016-04-25T16:01:31Z","timestamp":1461600091},{"_id":"423733c6-f08d-3d5d-96cf-d7aeca115149","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"You periodically call WrapKeepaliveMessage and send the resulting byte array on the socket.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"70a8f0dc-ff68-351d-8fa8-8ee45c69e83a","date":"2016-04-26T13:29:35Z","timestamp":1461677375},{"_id":"475d5d1c-8691-34f0-9ab4-95d5781281fb","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"I'm not sure what you mean by the \"payload length differs\". Length prefixing allows for different messages to have different sizes without any problem.\r\n\r\nThe chance of undetected corruption is very small. Both the link layer (e.g., Ethernet) and TCP have checksums that the corrupted data would have to pass. The rate of real-world undetected errors is estimated to be between 1 in 16 million to 1 in 10 billion ([http://dl.acm.org/citation.cfm?id=347561&dl=GUIDE&coll=GUIDE](http://dl.acm.org/citation.cfm?id=347561&dl=GUIDE&coll=GUIDE)).\r\n\r\nThe recovery for any kind of \"impossible\" message (maximum length too large, incorrect length for the specified message type, etc) is always the same: close the socket and start a new connection.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"961d68e0-de3c-36aa-ae0c-c6f476ac4c73","date":"2016-07-06T12:25:10Z","timestamp":1467807910},{"_id":"961d68e0-de3c-36aa-ae0c-c6f476ac4c73","authorName":"Edwin van de Burgt","authorEmailEncrypted":"F9++OlWU3xQUloGCu/EIecdEPlVnh/Tb/kRytKxjEgDWTFiYwJIXAytzPbZ8hZDLj3y5bPtEJFvQcjDn0da5QgRrH4RY+0OK8AmxWdgi9G1bX5SYvI19f/GB5IOOt4Mo2uPD4EbhTkVRlpPPDIl2UcfZHtUZADcfokphuY/aaDtWamDjDj+yjqZoy6VRa/1PhF/KrNngBzClkleKPYLHuZRLKY80fSuIQ3SijzDhHT6Wj9sJ+wJWJNryAv5M/wAfD2qVkiAKYlg+x32cmon6b2o5JHZsQust1Rzg23W1wNXWk6pGoyON6rYh7uTVDD9mii/kbl5qb0H+RjEtA8MOvHkZusH1U91CVTYtZ/Lc3f7JkG3Y/uDxriF40ycnZJvEgMt2i8xJFQ4Lp1IkjlAbynSMSPmw4/k4nC1v+sipZNY8LRIsSW5CMFFrfX7uoZdYQ3aAfhoyE+UQl8LhTyU+wQ2jJhKuQmhg53a+OUzFpMOMkTj4+Ks66OyDpQkBo+dTc4vns1zn99XDuaEgjpm6ksrUA+1NpGwpL2rZHYbbHglj8xUkoL/vJ9Pt6YHnOGu1/PGwzvLAWPyXVG7bcTfjWhLUjwN3JFKRwaYPUveHT9WgDg7LwhAIqlBo6aXul/IGKF5RQYOB78pqz1+RluD7wmMnb1h0iKq3cH+MaSi2EXI=","authorEmailMD5":"64ecf1a08d1bc977cb615c71da052597","authorUri":"","authorUserId":"disqus:edwinvandeb","authorFallbackAvatar":"","message":"How do you implement re-sync code when the size has been corrupted and/or the payload length differs?","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2016-07-06T08:15:30Z","timestamp":1467792930},{"_id":"1463577d-c775-3f19-81a6-68579e092003","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"Yes, usually server applications need some kind of collection of client structures. A ConcurrentBag could be an appropriate solution, though with I/O-based systems, a simple lock around a regular collection usually suffices.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"387ad707-5a64-3379-a1d8-560b2b38602a","date":"2016-09-14T15:20:44Z","timestamp":1473866444},{"_id":"33d390a7-a05a-3b70-bcef-2d251e92762f","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"If the class is properly written, there should be no problems creating multiple instances of it.\r\n\r\nBy \"a simple lock around a regular collection\", I mean you could just have a List<clientdata> protected by a lock. Concurrent collections are normally used if a lot of code is modifying the collection simultaneously (i.e., there is a lot of contention). But this is not usually the case for a list of client TCP/IP connections - it would only be modified if a client connects or disconnects.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"c84fa86a-ff78-3dcf-b6bd-1356031bff8a","date":"2016-09-14T18:39:12Z","timestamp":1473878352},{"_id":"387ad707-5a64-3379-a1d8-560b2b38602a","authorName":"Jesus Conejo","authorEmailEncrypted":"beODSA3lhMfqUYnjoXkl2+0pQM1uV0ZiGYs4W0AXIVD8jUd1TtZJzoNt0P+qTh8mGvxLnwmnS6YhNan4z/nz+QBJdSx2SrB1pQF3uJETRzYg3nFjDax6Y43OKskAunGbb2uX0biu1RX3Wdb1b33yIJjRvBZp1+der0VRlaqyn8yIweYQsM0zqyjpzzmuTOVTaoD7BVEYZDzZBxOm4PMGbFNq+MldpXbuzCLuzt6+4j/BHUv9GuR8gnkcFBXEJ8iV6RQYE16TAM/0EpPxkUNWSFKfvuJlZGBKtaHxILEylAOFg0etisDR27AvtxKBmk8EPZCim8Y6RjDAKmd2PR+VL1qN8Euv6VM6uXGf82UEW3ao6/I0tYl2RkqXjn7JgHaSX9dMMtK6s+znjgBJykap5BoLx0Ta8TUT+BuuacoQBjH13R7T8EpoGQ6Q36kpeYN7Uw7dCYpsEHWpUqCn2oIyREwARxCGcGNC8ItSol3Bl5pm4SwZ24uzNedXBAvHdOpUPvj9F3Fn0/d/XUfsB0C3tRqnpK+K+6zUaOywqu6YoY9orceBEFDxk8WxpI/XU7MOS7OiULv3W/Dofmv/EERRU5LW3H40NsdEV6l/XTWwejVIW3CKy3nNSipvT8eTnfle0S1BMAJD0UWF2bnfCL4angC/MUmyAIahRvm9jc68X78=","authorEmailMD5":"659bac2d29dea449065bd7bdd6ed9888","authorUri":"","authorUserId":"disqus:jesus_conejo","authorFallbackAvatar":"","message":"Hi Stephen. Thanks for clarify so many things. I'm using AsynchronousClient class from Microsoft for creating sockets and works pretty well when tested with some few devices (creating few sockets...creating Tasks, WaitAll, AsynClient objects ,etc), but I need to create many sockets (100-500) for send commands to IP Devices (these devices are the same and they have a protocol for connecting them and use them). Which could be the best way to do it?, in a concurrent way (I would prefer a concurrent way , not secuential) ? still with the same async way?, perhaps using ConcurrenBag for a better threadsafe?, which is your opinion?. Thank you!","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2016-09-14T14:55:18Z","timestamp":1473864918},{"_id":"c84fa86a-ff78-3dcf-b6bd-1356031bff8a","authorName":"Jesus Conejo","authorEmailEncrypted":"Ms0w0N7y6tStJUO+TQkE+77ufod0UXr1g4SWqrX2i8ZX8uON62iOD9XB5utVeJ69RaQ3WfLLmTz6moaHjxU6DDOvUuOdDEiFQNcvLeMVADt4XRIJ6nZ2e1RzV2CKFmgwhiXOPjcJ2mn6qmPuXYqhJR6U5I6ojfMiPo+AwSvXWsxSGpT77n5PEiSMaHzmGmW3tkoPiP7+JR1Cu2MjobsIvpF21Rgq3WeasSP3pIjJRJNGNXk3RPS5lgib1vhIZPIPheJq51tavdrCRTMeTmTpGfKUPdvKILegoswcywKZC15UY59BqgEAvT2xz3m3UTMYvCSHBXnyC7NLtUvjqD6PhatXMrGOZn8+6/c2yJj7zb/jnZIgEShJMLlPwG7Ry3eUKIwVe44eovyvwtu89f1OdyX2QqVBQ41hv+bpTze8NvqddTBm5YLPTEs0J9+i/SeKg+zmQFZyq/z0djsMvR+0goMcGM2C1ovo5VcFsnWfxsGn7TtlcjvjWfq2wcRn+VDTbxwYRjfl7fbmZPB6Fod5pn+5ZcKcOoqqhEWjupSBhbh6YoCd7qMQsSuffo8ISN5cMMNwn1pfv0tu8dDECY48dasbi09urVVN3eTuUs++M/fL5nHm8GFet8aL4B0pvHJjguRDrOvGP+2qwBG/rBLbzGnJge+r+bKNRIXOAM6l+g0=","authorEmailMD5":"659bac2d29dea449065bd7bdd6ed9888","authorUri":"","authorUserId":"disqus:jesus_conejo","authorFallbackAvatar":"","message":"Hi Stephen, thanks for the answer. All the protocol/data for the IP Devices are in the Async class (modified/adapted from original Microsoft) so for connect to one device I just create an object of that class and the object does all....The question is...for many objects (to create many sockets and communicate with every device) of the same class will the system hang?...It's enough the async way (creating Tasks->async->await, ...async creating their own threads) for this case?.... in this scenario, what would mean \"a simple lock around a regular collection usually suffices\"?....sorry for my ignorance....Thanks!","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"1463577d-c775-3f19-81a6-68579e092003","date":"2016-09-14T16:54:15Z","timestamp":1473872055},{"_id":"f510dbce-1e57-322a-820e-77871bf961c1","authorName":"Jesus Conejo","authorEmailEncrypted":"n2zKbR8ctoZStsYifqmHjtyvP7t+4sOxDXAhkA9dt+QLGNA69TpJXiXhD115PLwoVnWP2TOiNW3JC/Le+6/A9PORvpPUw0ZZdBzp/ZGfmWAhZk/ji8+g7tF3EkEKilWIoU1ETc0Fg/mGPJL0An3yC8IbRmQJE0D0g2Bvu7MyKDsc7s1fdaT7Kn3MVHgZp3Twz9vseiiou+rhlC0ZYHSi+VkLNGylTyHYevjnnX/UJowK0B0A/QwneKTXmPQHhlbrtSZlgRfmsSiCDbLmKFYPULk7gnsytWFzoIpS5/vddv1n1Kz2HyizPluMHD+xJO7L3PzTALgL773BF3yAh2h9stGtKCH8bNrLs0ZIUW8HfpIk+EPXgRiDAvirdicuwf2k9ciQVHCBAQN9UtGrhc+wc3Dfhv7E1PY8jd+H3SnYQ263D45LpKgIpjlvzbNkZFDoLMKiVQXyuas6YcbcIkYx9FRm06l1h0Y8c1dNKRxqZhSU8h7n6BOS1PnQJPQf6QaakY4Ea6HHbclfbODlWQrKDD2Ewt2mz7RnVGiDGJpk78kpBg0xvNvk8+VvHGkRuiWTwQ1hQWguGwtUCxclEpOnnIynwwWJFMbsv4bBO2MCU7Y6AJUJpxPHK7pSqBngKn6AD+Eu6Dyu5ZjOkqlNF5E/jHuWFEBsFoYGT/lwjTQDRn4=","authorEmailMD5":"659bac2d29dea449065bd7bdd6ed9888","authorUri":"","authorUserId":"disqus:jesus_conejo","authorFallbackAvatar":"","message":"Thanks so much Stephen.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"33d390a7-a05a-3b70-bcef-2d251e92762f","date":"2016-09-14T18:55:15Z","timestamp":1473879315},{"_id":"1c4c35a5-bc62-3836-a790-c7ef068acf73","authorName":"Soumen Mondal","authorEmailEncrypted":"P2NHgVuhMLMEvQy70+lRDdZbS3oyj4b2T9Qp3qGo2dzNht/mRe9RbYNJuC+V67MEO/zzxB1+7amnfGqoSkUK5O57YGKgLM97beBuih3wEh2DqmoOq6tZl9NlKNFHx+craAXEA7lb/woj9r37bP6oytOhlIf7GWmBv+hrCFq6jA3h1HMsw9D5xX0hH8bbf4gA3t2rSRXWA8qUh3r6RcEzCDn2nua8lk5ZFCRZzxzfugcjubSMIFGhUG6KDI+FnmyMbnFPuThfvvrlXt1kCh/pGdzsKs/7ev7P99ztT+8HXXbyZxiSCw2qDrcJJS7FGptW3mr69N3s3fvPhJEFHfAd34x4EKRpeS/yRZm2ViwnoD9Xnrbh73H6VbvkrlPFykk6qjL+QCDhT9SfsWsuONJRbMiw2Sw12WdqMCHK9/4X7HPDJ8hRsGusB9LA4xpk341gUge8lJSwselCVMKD1Zq2nNxl61ot9wID4VZ+5Mr6Dq94BF2P/hyG7LBtTBUHnKW+C6SMzddVQvS/HILh2gDlX30ESWLK7fjyceLec9PGX+2DthChNLtXanwcVC8awFCudB2JRWgpQKg/AAheK1tS/iRi7pI1qwJy5DVCFBMrriQmGDcD5IRZiTME2gLpMRvBSyPHEFtxozHZ8J7Zfzz16FtKWZZ1ohCkav0+GHLeyGc=","authorEmailMD5":"bf0ce2750b73e0f385399d45fdff6f01","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"How can i use this packet protocol when send file data over ssl stream.Please help. I am using this code to send data to server from client  \r\n private Boolean SendTCPPackets(String filePath)  \r\n {\r\n\r\n Boolean status = false;\r\n\r\n TcpClient client = null;  \r\n SslStream sslStream = null;  \r\n String returndata = String.Empty;  \r\n String reciveddata = String.Empty;\r\n\r\n client = new TcpClient(serverName, serverPort);\r\n\r\n // Create an SSL stream that will close the client's stream.  \r\n sslStream = new SslStream(  \r\n client.GetStream(),  \r\n false,  \r\n new RemoteCertificateValidationCallback(ValidateServerCertificate),  \r\n null  \r\n );  \r\n try  \r\n {\r\n\r\n sslStream.AuthenticateAsClient(serverName);\r\n\r\n String fileName = Path.GetFileName(filePath);  \r\n Byte[] fileNameByte = Encoding.UTF8.GetBytes(fileName);  \r\n Byte[] fileNameLen = BitConverter.GetBytes(fileNameByte.Length);\r\n\r\n String filetext = File.ReadAllText(filePath).Trim();\r\n\r\n Byte[] fileData = Encoding.UTF8.GetBytes(filetext);  \r\n Byte[] fileDatalenByte = BitConverter.GetBytes(fileData.Length);\r\n\r\n Byte[] clientData = new Byte[4 + fileDatalenByte.Length + fileNameByte.Length + fileData.Length];\r\n\r\n fileNameLen.CopyTo(clientData, 0);  \r\n fileDatalenByte.CopyTo(clientData, 4);  \r\n fileNameByte.CopyTo(clientData, 4 + fileDatalenByte.Length);  \r\n fileData.CopyTo(clientData, 4 + fileDatalenByte.Length + fileNameByte.Length);\r\n\r\n client = new TcpClient(serverName, serverPort);\r\n\r\n client.Client.SendTimeout = 5000;  \r\n client.Client.ReceiveTimeout = 5000;  \r\n Byte[] messsage = clientData;  \r\n // Send message to the server.  \r\n sslStream.Write(messsage);  \r\n sslStream.Flush();\r\n\r\n String serverMessage = ReadMessage(sslStream);  \r\n serverMessage = serverMessage.Substring(0, serverMessage.Length - 5);  \r\n if (serverMessage.ToLower() == \"true\")  \r\n {  \r\n status = true;\r\n\r\n }  \r\n else  \r\n {  \r\n status = false;  \r\n }  \r\n //status = false;  \r\n // Read message from the server.\r\n\r\n }  \r\n catch (AuthenticationException e)  \r\n {  \r\n Console.WriteLine(\"Exception: {0}\", e.Message);  \r\n if (e.InnerException != null)  \r\n {  \r\n Console.WriteLine(\"Inner exception: {0}\", e.InnerException.Message);  \r\n }  \r\n Console.WriteLine(\"Authentication failed - closing the connection.\");  \r\n //client.Close();  \r\n return false;  \r\n }\r\n\r\n finally  \r\n {  \r\n //client.GetStream().Close();  \r\n //sslStream.Close();  \r\n client.Close();  \r\n }\r\n\r\n return status;  \r\n }","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2017-08-01T07:45:03Z","timestamp":1501573503},{"_id":"3f350cea-5822-38ae-8acd-ace360e493eb","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"These blog comments always mess up code block formatting, which is unfortunate.\r\n\r\nThe code in this blog post should work just fine for SSL streams as well as regular TCP/IP streams; once the SSL handshake is complete, the SSL stream works just like any other stream.\r\n\r\nIf you're having a particular problem, I recommend asking on Stack Overflow.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"1c4c35a5-bc62-3836-a790-c7ef068acf73","date":"2017-08-01T13:01:23Z","timestamp":1501592483},{"_id":"1d6b99bb-04b8-3801-a989-d501ce171677","authorName":"PROJECT IN C#","authorEmailEncrypted":"moJDKS3AJk3QVMLnQtVk7mVvdkFLesNLNgBqWB3rquLxZMMjKvqGkm35xFdlXBZDe6IhtZ7p2wwM3kJ1pOTFS1oHY/M0ctxIAPTq5/K9HAi5Cr+tUL0j/qKC5djLVSA6bGVrV0PLDasxQzZbpKwtqHd9pwcQozD5wVF6ICM1PFjAw8qSMRAbHQTIHJIqtsC3lHap14h49lzyLz396fEUawO/1kZVT5gRzv64RI1NTfoHqEzfOsrGuMrCD72fZWCphU/cj5kSj0FwVVaAIN6A76U3vhw/UK3bQKQEtNr+xmCSo6VmtdCoSns2UfApP1UxAFKFgB2oQM5NU6C4FH0STsFdyBDrKKJcqYjWhmGdvq1J7YomymSbPbJs05Ty30n5POopKet4t92Znz/QvOdumwTT4wReBdFE2dYTe8Aw8PBSWSUMeJ2ew7lsLa2SP/qLSoBR9JlmS95PjF2pDqewPImQZ1bhQUzNJ5zg1rspeeNAA/LGJ034Wtw9DMAB5vAisI+vxORpgWi0nhTfZpYLQ9nmkbvGJNpK5y7eGp84umJ6FlB+QnAG5OkUe6cWKYkJ+wqS8lRkO5h3BLVycpz8gBhN/LxUy5W0j/i380+p+oEjBl9ues8CgZnexLTOEIQj6/u6fSy64byqISgQJWEt9QqRmuyo6No5qx6TglieyFU=","authorEmailMD5":"6007950fcd8849a4f80e1d7e0d2a900b","authorUri":"","authorUserId":"disqus:projectinc","authorFallbackAvatar":"","message":"how we call this code from begin receive and End Receive Method in socket .\r\n\r\n[https://stackoverflow.com/questions/46010688/how-to-validate-the-message-that-is-receive-in-socket-in-c-sharp](https://stackoverflow.com/questions/46010688/how-to-validate-the-message-that-is-receive-in-socket-in-c-sharp)","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2017-09-04T03:50:22Z","timestamp":1504497022},{"_id":"0637a4e0-5739-3216-b44f-fb6678daac1c","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"You would create one instance of PackageProtocol for each socket, wire up the MessageArrived event, and then every time you a read completes (from EndReceive), pass the bytes read to DataReceived.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"1d6b99bb-04b8-3801-a989-d501ce171677","date":"2017-09-07T17:12:13Z","timestamp":1504804333},{"_id":"4e36183b-4068-316e-ae7a-bd47d29a0693","authorName":"Peter","authorEmailEncrypted":"uquMPueW68kKbFbvGlWO6NdP1RcDWQ1bz9nLO5OjZZCVt5qepNoVQCHmEKuKqxVKIApbCC48XXWPQv5IVXm4mXIj7Enawg5hnJS4YbkilgzqWVukg5oGO7u/UnUgQTl4lw0SnYwybQwcvt/EPTLVdHgdUZwjZReDJNTEv3Vo55mqRleqfXg2c2AlKOk8KsX/h5nHbnibxgtO8vmWSAZVpCLpd8ecAdjCmr/ghLRJZSLvpIukccWyrV2GOzMKjbqCANXfUoTRdf68TGXWLK3lJy7Y1fjuXuossER1RRmI3BbXz9Z10ylqdZ1hiuVfB9YuYr2bPS+xk5LQCUKkAqzcjntSEksrguEuw/RIWnIdRHQlArDGnf2Vm9MCXAwXPa444AWZuAIlgIgZAMhBj65T2mQcu0Kxm2jiI4hhxhGdmY+qRKC8wYKCF9awZMHJcIAVaIC+hz9FViz+VZ9bebQiDhja0NRV2elMMjPX6RsvQNGB4Bo/f/iwBbBJ4GuZQq3BNogMYZJlpQNlFTSd5OzW1d0F7EazhiU50fKHKw4hoK09sDSVQw1Cz4duoyoQpSwhv2irQ7ITRYvWnnbEfaZsMdSI6yqsZuR5HfwGk8sduUSDxMatMSMowLUsoWXL15zU69mTy4wG5rJHgMQjwlLcEaMNQNpOBzAntetSAq7vFhA=","authorEmailMD5":"a17ff8ae8b929197e841343003acb0e1","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"thanks for the source it helped me a lot.  \r\nbut in this line\r\n\r\nArray.Copy(data, i, this.lengthBuffer, this.bytesReceived, bytesTransferred);  \r\ni think you should replace i with 0  \r\nbecause i had an annoying bug","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2017-09-27T12:01:45Z","timestamp":1506513705},{"_id":"7d3cec0e-567d-3723-8718-ff3e06d670f9","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"I took a look at it, and it should definitely be i and not 0.\r\n\r\nCan you post a Gist with a unit test reproducing the bug?","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"4e36183b-4068-316e-ae7a-bd47d29a0693","date":"2017-09-27T13:40:30Z","timestamp":1506519630},{"_id":"cbf82642-ea1f-3cbe-a60e-a96abe79589a","authorName":"Peter","authorEmailEncrypted":"lgi0jybPjx2h8nO39zNjJSATPGUHk4e/rB896dZ8wTUndmbW0pmQxTDQx9zFW8bMxqQkCduDRfk0N+kw5Kq0J1NSd+/U4E0DVOZP7z0SIRDeN/8AsNvpO5gIa6kidjQPjE2nqm8YqktOgTBhXbuqk5C5o6qC+mI2vzQSiWyLlmGuGzPotrBipBsOQhmYueYZZLB7B/7+1MxxwyM/mViiNMmRua67AgxGM93McIkE25+0YxpkoxeWtk7Ki1avHkOHBCxpmBHlp1hqKmtOaKp13d4NTwJ+Gm3eoSaBMsMJBXnUaKV/K1pWG6uPQGbQdYXqw2BL/aUJmgrulzl+2+ZcZUFt6ZV98yup2Unu9eo/ERW6wFqG9yyR8GY5gov/D+dZzO7DhSEurWSBpHVw3KhAnVWWZSXFN6w6BYSbmVkTQzqIL+j+otr/ZICNqZWaXmIIuPxtPnkGx1RTUO/XBsG4YKoN2x9Ww7IhuhG2IwkE9pRvSlSu8fsN2U18bAzyAWWQJH3hJzu7ZTFrxantR2ELxxHOThG78rTd5aMxeSdNYALkJ77gwnlo095Cu69id24cPIJE7T/eEgS4w9l88WTn6QSYWMu0+BUPV9n1KebRQ8WcZV1HlgdMeQiAjpHoyMV9dA7FLR7Ehmz8CBxpuGAMZTZwQfJkCPkbbPehhcR62JU=","authorEmailMD5":"a7432534416cef14f3958dd9224ed0e9","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"private void ReadAsync(IAsyncResult result)  \r\n{  \r\n try  \r\n {  \r\n _socket.EndReceive(result);  \r\n _packetProtocol = new PacketProtocol(_bufferBytes.Length);  \r\n _packetProtocol.MessageArrived += Client_ReceivingPacketDone;  \r\n _packetProtocol.DataReceived(_bufferBytes);  \r\n }  \r\n catch (SocketException)  \r\n {  \r\n Disconnect();  \r\n }  \r\n}  \r\npublic void SendData(string data)  \r\n{  \r\n if (Encoding.ASCII.GetBytes(data).Length + 16 >= _bufferBytes.Length)  \r\n {  \r\n //spilting data  \r\n string[] splitedData = DataSpliter(data);  \r\n //sending them  \r\n for (int i = 0; i < splitedData.Length; i++)  \r\n {  \r\n if (i == splitedData.Length - 1)  \r\n {  \r\n Send(splitedData.Length, splitedData[i], 0, true, false, true);  \r\n break;  \r\n }  \r\n Send(splitedData.Length, splitedData[i], data.Length, true, i == 0, false);  \r\n System.Threading.Thread.Sleep(500);  \r\n }  \r\n }  \r\n else  \r\n {  \r\n Send(1, data, data.Length, false, true, false);  \r\n }  \r\n}  \r\n/// <summary>  \r\n/// Send the data to the server/attacker  \r\n/// </summary>  \r\nprivate void Send(string data)  \r\n{  \r\n byte[] dataBytes = PacketProtocol.WrapMessage(Encode(Encoding.ASCII.GetBytes(data)));  \r\n _socket.Send(dataBytes, 0, dataBytes.Length, SocketFlags.None);  \r\n}  \r\n/// <summary>  \r\n/// formating the data that will be sent.  \r\n/// </summary>  \r\n/// <param name=\"data\">the data that will be sent.</param>  \r\n/// <param name=\"dataLength\">the length of data so that the server can check if the data transferred successfully</param>  \r\n/// <remarks>\"dataLength\" is only used in the header</remarks>  \r\n/// <param name=\"spiltedData\">formatting and sending data in a different way if they are splited</param>  \r\n/// <param name=\"firstIndex\">check if we are sending the first index of the splited data and we will put the header</param>  \r\n/// <param name=\"lastIndex\">check if we are sending the last index of the splited data and we will put the end of packet</param>  \r\nprivate void Send(int parts, string data, int dataLength, bool spiltedData, bool firstIndex, bool lastIndex)  \r\n{  \r\n string formedData = String.Empty;  \r\n if (firstIndex)  \r\n formedData += String.Format(\"\r\n\r\n<{0}|{1}>\", dataLength, parts);  \r\n if (!spiltedData)  \r\n {  \r\n formedData = data + \"\r\n\r\n\";  \r\n }  \r\n else  \r\n {  \r\n formedData += data;  \r\n if (lastIndex)  \r\n formedData += data + \"\r\n\r\n\";  \r\n }  \r\n Send(formedData);  \r\n}","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"7d3cec0e-567d-3723-8718-ff3e06d670f9","date":"2017-09-29T14:18:33Z","timestamp":1506694713},{"_id":"f30ca70a-74d1-36a7-aea6-dc5f3883c7c8","authorName":"Peter","authorEmailEncrypted":"QSPAz23g9igrHqvQg8epoF0dwUEWK/qwPZxtQwmozr0LQexhIVCvy1Zls68UpxEs5906iWpGsscv6xyXgy3v2BzFYtDhUAGG2GI5Nw+3pBiJzGtQUa+1vBjj7LisSR+lqzO+k9501iKDOWgzwkv3gw3JBDowOUFP28nrinHKzL8rDK7z5NdPFkn1nAnZZWb6Xxg6mthwyB6ububtEX31wlVippcRG7Px4xTczOIbAfbuwE0DKueL9TGF4rQMmEaSwUYkZuTMT78Qyc2BzSIoCVSBtfawvnxORU2/MWB+9t5HPFtpojjSvNGZgCzNEHFX040v36qHHRMIHC2VyDtSPmoF/oV0ciV/fYix0lltx1xR7l5l1QMpJlkJrFJLt0342ogKxUDwnruMs8TL2OSNf23248qxWzyuGdtmf3ma8z5sxN4vOKafEQCDLsNRKZruao6UBIdeFiUUI2/av9BwFM/Nl9Ciade2dAvagf5PlqdV0McjC/5gHqExvbwk+dAC8sgNtjMk5fd07FN32fpCOWYD29ZAlh4a+fsh8g+Rq/pbqkXw9jQbFMt0Pza5I+P6NrDp+BFrQG0V6wFfacD0/3bbQyZB4cm6h3S4hwKN3UOoAEsTfWweauP/6gydWYWMO004mb1j1Rp5Jhdn9SM6wHL6kCxi8CBUIOJEobqEgwk=","authorEmailMD5":"734a374e3234e1fc3a049febeff4234e","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"well, i'm trying to transfer a file.  \r\ni take 1024 bytes (as size as the buffer) from the file every time and send them.  \r\nthe first packet was sent successfully and the problem was in the second packet when i sent it, for some reason, the dataBuffer become null again, i don't know why but i think because of the line 197  \r\npic :- [https://prnt.sc/gr7c29](https://prnt.sc/gr7c29)  \r\nps : sorry for my bad english.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"7d3cec0e-567d-3723-8718-ff3e06d670f9","date":"2017-09-29T14:12:15Z","timestamp":1506694335},{"_id":"c2cce118-05b4-388f-a6fa-2fb3a20c9f91","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"You should have one PacketProtocol instance for each socket connection, instead of creating a new one on each read.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"cbf82642-ea1f-3cbe-a60e-a96abe79589a","date":"2017-10-03T17:46:24Z","timestamp":1507052784},{"_id":"77455e45-2e41-3d8b-b1ca-bdbcbeaac336","authorName":"Peter","authorEmailEncrypted":"wHZpBvM4OMA923ekJQH6ULTqfOcTt96pBxWy90/XgICfklDuBSq9MoGublFLkbTtCs00ZP+5WWSpSJLBnWsRRZN8wVnWBHt4OnRPLe5jegOcdgBU5R7OY4KiA34JUJ0e7O1zlQMD4YZmozbiS74EX88iHgeH0xIb0k+jvz5B0LDnMWEk+nopS3zZ1RnxRPX9GmwIw1mz46kah8Qb8lXI0m4sotOOr20gZHfdmf5XFsQPtOvb48wMw1loVJZnglajOCkBxjeS6tmQOGqWCcA3tCCYUSZPW7a61ui9cwx1eQNkEfgEGB7oFZ9BH/mqexfhVrTFnC3rS4Zb54pdNLoTSXoxK68VwY5dGwN67Ce9CahVZRUVwtrfZkGamlIEJaPDKOrJsTeqVRMcMbiVPG+P55/JCjGIowFkAvnCescffI2obYleA2ftRiTPnDDFtCT8G/P3b0GxGjafMF45+hcIQrVWHk9rEmQ/yvCr7TiFPHmXxhaHPVliBj8kIPVkQwaTsV0akxRVIlfH6qaJnbkIghD7Wfmkvyh96s46vvb7mIfnmSoWAINUJkv8cwuFMmEFj/zvvMTuxp7C249z9uaIv0FLMt97snDO/aOSeckf4TW/dqjZJS/v+i2bouzoA/XJ/CQTUg3VEwAiLqtCVwecBc5VzHQYRHohRUU9boaYfbo=","authorEmailMD5":"a7432534416cef14f3958dd9224ed0e9","authorUri":"","authorUserId":"","authorFallbackAvatar":"","message":"Thanks for replying,  \r\nI've written my source code again and improved my code   \r\nand your lib works like charm.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"c27cbe5c-d714-33fb-98d9-a2524f84d35e","date":"2017-10-04T22:50:28Z","timestamp":1507157428},{"_id":"c27cbe5c-d714-33fb-98d9-a2524f84d35e","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"It's normal for dataBuffer to become null - it's null anytime it's reading the length prefix.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"f30ca70a-74d1-36a7-aea6-dc5f3883c7c8","date":"2017-10-04T16:30:46Z","timestamp":1507134646},{"_id":"513c6b3e-bd3b-391b-a86b-1e8c37e4e0c0","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"Glad it worked out for you!","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"77455e45-2e41-3d8b-b1ca-bdbcbeaac336","date":"2017-10-05T01:39:04Z","timestamp":1507167544},{"_id":"72fa29a3-c78b-3727-b7bc-6d2740473dcc","authorName":"Pradeep","authorEmailEncrypted":"UmS4wOwLmshAabx+62hMdMDpqXhgWsLUXjv4mJFZPQyeZdudQJrJvEkAmY604nu3E1s3UZ9n3hjSZU7jbNwtHSwJloYQvx2lpkA55AdtIYaF4AJyrqA0x93cZrnSbpY207gPGFkcUyf8I9318DRjEPCjERgklDyVzUBn/W84SPhUd9VJgcx3y/deX19Wu4PiO1NBIFLSrTU2F9+fNNdT5DpDrpH75rwfetuJ71dDgTcUlkmHiuX0QfRTycJizQ8og4GxsETbmHX4bVt+dFm58jhrUiyia7Ik1DfInyTIwL5qNJqJ9cjX2CXhUeO41LNhiRmQ7m1Kpb0okOz18uA/2S2C/N4KeBZWkDAHW7p6Csosb2mFfbnNYaMG6NCsNzaByCo0HAMzWhUqOk2RR8znXhDWsP4tktIR27+aWFhZ/clCbKE8aOCsy8Eh0xsOQw9QXcxlXbEJaYzqwQZH5YpKXA7KPat4FAaUo39mP4X9+jzBQ1hgGe16kqHZuFkzJnYwUNFWH7xFY1hwLtcA4C4JbMDEShN1jcPUincu1yOZkP4UI69zc1XrAEoCX1qJOc8/cp6sQ8ntEzBLcNW57RWjTniVuBt5DgzlsqhGQpC4t8Sruy/dQGUBSDImP+0oXlNrc7XeqPyxs3YIlQCXYW/sYmxBS0CGx6RQVmM7a0Essis=","authorEmailMD5":"c9fff93b0975f41010ae13dcb1a948f3","authorUri":"","authorUserId":"disqus:disqus_j9TS7gArn0","authorFallbackAvatar":"https://disqus.com/api/users/avatars/disqus_j9TS7gArn0.jpg","message":"I'm very new to socket programming, and am glad I found this post. Your class seems to have everything ever needed for message framing from both sides (sender/receiver).   \r\nI'd like to use your class as it is in my programs, but I am unsure how to. Need a little more guidance here.\r\n\r\nTo be specific, I am currently following two docmuent pages which contain basic examples of asynch TCP server and client:\r\n\r\n[https://docs.microsoft.com/en-us/dotnet/framework/network-programming/asynchronous-server-socket-example](https://docs.microsoft.com/en-us/dotnet/framework/network-programming/asynchronous-server-socket-example)\r\n\r\n[https://docs.microsoft.com/en-us/dotnet/framework/network-programming/asynchronous-client-socket-example](https://docs.microsoft.com/en-us/dotnet/framework/network-programming/asynchronous-client-socket-example)\r\n\r\nI've created the two projects as per those pages. Now I'd like to incorporate your message framing class into the same. I'd be much obliged if you could just point out how I could use it at both the server and client side.\r\n\r\nMany thanks.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2017-11-20T10:12:17Z","timestamp":1511172737},{"_id":"057a3369-7fbe-3abc-a4fe-4ce439987a94","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"You should create a new instance of PacketProtocol for each socket connection, wrap each message sent using PacketProtocol.WrapMessage, and pass all received bytes to DataReceived.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"72fa29a3-c78b-3727-b7bc-6d2740473dcc","date":"2017-11-21T02:39:27Z","timestamp":1511231967},{"_id":"300d2a54-eae1-3de8-8ad9-91f17990df0f","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"MLLP is based on delimiters, which I discuss in [http://blog.stephencleary.com/2009/04/message-framing.html](http://blog.stephencleary.com/2009/04/message-framing.html)\r\n\r\nPersonally, I prefer length-prefixing. The benefit of length-prefixing is that the receiving end knows the message size before the message data arrives, so it can allocate one chunk of memory that contains the entire message. In contrast, when reading a message into memory using delimiters, the receiving end has to keep re-allocating the space for the incoming message. However, the benefit of delimiters is that messages can be of any size, even sizes too big to fit into memory. This benefit is also a drawback; the receiver must be explicitly coded to allow messages too big for memory, or it will fail to receive them.\r\n\r\nIn the few cases where I've had to deal with large messages (terabytes of information), I've just split them into smaller messages using a kind of multiplexing stream model similar to WebSockets, and used length-prefixing on those smaller messages.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"6a139f5a-3280-3911-bb80-184b3d24a8d8","date":"2017-12-14T14:16:31Z","timestamp":1513260991},{"_id":"6a139f5a-3280-3911-bb80-184b3d24a8d8","authorName":"Jay Ghiya","authorEmailEncrypted":"SLJASpCZp3w10ACG3ab3duouOZixpMvmwQuaOdD66pPCo36sGN5TykgBU+q9IMLK/OZQeMVz9ElSmyBlcPzc35HxicCRJNwThZ/OcGMpI15exjP+4njc2jeZX6ODHLkXfVE9MgIeLKDUbwyNyDIdrVWmFSU7QsrDzrGT7tEmaSXia7ysgcbLO8j2cZPPqjPQCaLJr4hzm7ZkwL6SqPfaDlh0M5HVBV52I00fwrV/dcnFPVMsXBJAInCXYXFGSWq9za8cwo3JOlDYUPMaB9ecG09yzITwXMjc+EnT3iQov1eu7yGjXKgwyGbHKliV39dvOPIytycc2F5XNvgdjaEJNbhZ8Da+LCQcC6LWopExgoP4FrXoHagWrmdzKJWGUY+9vNpk16cqlCTT57nePP5qxJqMSFgubT8Z80eO2IeVrBT2q3JPGajrBBdP9JpattI4tzVTFzTrGh6NBulxUROE7sg4hpDX5EKdtKDFhbqA74Ie0/h/avTMPTqxvZ5uWE0Hu+tg+bC+CccM6ufR0YKqRtfxSfgKc1Q/nsqdUuy59aJraVCXf3YeQFcOSEQh2UCFkxe5NLXrNaHkYkiYslxHtvmasW/qhKK0CHJ6mFv7tfhAS4SIQsL+bG3NNeQqwkMZ7DvBGtxONX4f3ZWlreW8gQ6FlE70F/4LMtpl22whUKs=","authorEmailMD5":"b639a04e96a94092bb729714f996804b","authorUri":"","authorUserId":"disqus:jayghiya","authorFallbackAvatar":"","message":"hey first of all kudos to you for such detailed explanation regarding tcp protocol! i have one query regarding MLLP encoding? is it better than prefixed length encoding as it has a end-delimeter also?","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2017-12-14T10:42:14Z","timestamp":1513248134},{"_id":"61c1f52f-633a-3199-96ea-39a474a468be","authorName":"Jay Ghiya","authorEmailEncrypted":"MENjURVFGFH9AgYqExtCqoDVk70VRGAHzSa/oqxovq+v11zqp3j7pWtcngHChZM8WRZrLwCRgwz8RE132D0deLAFnXThLGVOWVmEuAc+ybk2k+11RrGmsHNBhVvfT3VOKjpNNgxavpe3dpBJGRzq0Y/sR4mX9b1JODLR4U5ToqVW/iKr7SzKT3fs9TYfUqtIoDeJ70SHNAZQEczSA78XmXfN4q2UQHu+QCNz0pT8Fwuko+tNDGZ5/T3oYi8MNPNV0Y6aOgObw8rge4GsBFCCuTzm4Fiue2OmhwJLDH8TvsJu+2N0B2r0LdLqs6sr8MYFxqmDUYdZFj/4cI6xsXASeBPlUjcqsiLHp4JsjXr69qeRuqdl+Y1oc1/585uVen+03s1xW3IdBWo/PUu4NWxGVGvSfWWaTfFXx99mhwiTnzBhRo4YCvDH0t054H8hER27XRz3RJ0p8M19rUI3cVKkc5iC6yK+mG9yyCkgJXTmieMhH6PWwYCp12GFtucEjVztxbeVKoRH1cIR5oBvU6OR/PqKUkfVIoKje5Dyx0eO3zweJVLp6gzSW6H1DRbs9z2bh1bewAKleaaZ6tD4T31hLejMQpntF0WO5Ov02QSJQv2tdMsgQNJX0rFWDVii6U1cggG9VCmVb8Xin17QxqBDjzuF9hveQkKEy/pdult43AU=","authorEmailMD5":"b639a04e96a94092bb729714f996804b","authorUri":"","authorUserId":"disqus:jayghiya","authorFallbackAvatar":"","message":"Thanks a lot! Really appreciate the prompt response!","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"300d2a54-eae1-3de8-8ad9-91f17990df0f","date":"2017-12-15T04:53:22Z","timestamp":1513313602},{"_id":"5e6e2a94-4e3a-34ed-b4f4-f0b2ada07539","authorName":"Pradeep","authorEmailEncrypted":"FCuIn2r1eF1rlH9KZ1ZX4bgWuu2XmjiaVZlAx9dk90TpxABIbG8Jxuh1r8Zz0tI208DjoNsaP4BqktsPOIIYDO269q9gx10vNgZTbJhbn6bqQH5vDbml/Dh1nVo2Ih7tqZjHRYHU36wMtgIJIzSmfveQKRsMF0INB3RL6JBjAFvSi0Ev82ErDv99kPMmUlITFx31UNTfs+mdIA4RD0o6j2yWyw6ikr2wUz5uEbdRX9LzP+v/Qrpet2UT8zuZ1p2iSLul/p5BbZHeXEh81pgeOW1eClBePpQuoEzkRNSdt/WOAvZRr7Sj9Dd3JBHSkSsKJd8Z1/yC1ruq83iJYmlMbgaPLcJ29CFhjR4iYHOCq0oedTJ+WwpksukH8FEk5luonjTD+gHRrx4d23+vtco1xl5MB4ca0sJC93fb46cucxm49LUEUwNEFYithEgX0AaNurEo6JQYG0jffqUOVkTVLEeB2lRy+Q/HRSfAxq94AgMBrlR3VYBuFo1zNeOmC5vzxEzlXUhbRT7ZcQPvdP1bYiCpkFy2ObdsVaJHZjsizoGEztV1/VJsSGyU8n6CjNVXP8FuQZNBqD8pX0BT6f9kqfo6frx1uDLRa3F7vJAwB/pT+GwaP0jrPoIfynS7M399s1Us2ssa70czy4QaxCAjtIwzOmmEyCWjNJUK4Ew3wSE=","authorEmailMD5":"c9fff93b0975f41010ae13dcb1a948f3","authorUri":"","authorUserId":"disqus:disqus_j9TS7gArn0","authorFallbackAvatar":"https://disqus.com/api/users/avatars/disqus_j9TS7gArn0.jpg","message":"Many thanks, Stephen. I've been able to put together a very basic middle-ware within a couple of weeks, and I owe it all to your excellent explanations and details about the common pitfalls to avoid in this series. Of course, there's a lot more I need to do to make it really robust or to get it to scale, but I've never felt so confident about TCP programming before I read your series. Thanks again. Cheers.","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"057a3369-7fbe-3abc-a4fe-4ce439987a94","date":"2017-12-28T10:32:13Z","timestamp":1514457133},{"_id":"09737035-652b-36cb-8e8e-963a58804f5f","authorName":"Copa017","authorEmailEncrypted":"ASU8ZkKUrFQ82CxU+viPFQTri7LSE12TkmIlHfMAJcDUXsMd4siME36dDor+renYOnRmdf+tuXEzlRegXYAOSeyYo19+kgeip83WUKNWGtfF+54KUkcUdC/7yjWRStL29Nh6L2Ky5hKE0oXGaXOz9kDm18W1bdr3Iibm8eqPJeuD3goffmzhbflaqdc3kH2lbvdGEU9djZptH8wRIRwqMPaeyhjKW1ir/xinCUrjYSGNrdwu1ftv+8aryg7rMKqPB08GW0lVvJBj8dDP90c3CjCR4LczWJPT8mVdGSnxdCJjYtIwUjq72CklJMksjLt/hvRt0sdDJyGbry5GJo2Vf6PfBTl78DgYGEsCVW75wn97D+EcV40+Jkn9kvpN+b3xy+ZTvx95YhzuynwGHoiFSIqZdTvngnUqfr8Z5qWJMwcptcsAFN3sxelSDYisw0znQOla84UFg7+APNyV2PyOUoz0ybq9DG1oELeO11RtSZVJSlQ1jxmJ0oCaBS+C/gpXAk1mk5DGMJH03+kPOk3aD1bN05HubaQhT4goID1ilhf/rOKdNv0OGHyUmDMExevvomB2tOmbOrGcDpXf5aksMDJ4LR6sx19Ie/0q65CVE7V10ERWCnURoWNlCmolFc0B/Pj8cV9PSQ1cHek9JxKJimz6BGhZHOI1qZcDzqxVHxY=","authorEmailMD5":"6d907241c6ea06b2e4c7ed326a26de10","authorUri":"","authorUserId":"disqus:copa017","authorFallbackAvatar":"","message":"Thank you very much Stephen for sharing this, and the informations you give in general.  \r\nIt works great, but I had to change the call to DataReceive to pass also the 'len' of received data as parameter. Otherwise in DataReceive the reading of recbuf.Length always gave the size of the buffer and not the bytes amount that was read. Cheers!","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"","date":"2018-03-02T07:55:13Z","timestamp":1519977313},{"_id":"c6bfbf19-cc46-36d8-8297-dab25ced8eba","authorName":"Stephen Cleary","authorEmailEncrypted":"","authorEmailMD5":"3db7b6e14d9da42751e4bab03bc4d034","authorUri":"https://stephencleary.com/","authorUserId":"","authorFallbackAvatar":"","message":"Yes, the code in my blog post assumes that you've already copied the received bytes into a separate array and pass that into DataReceived. It's inefficient (additional memcpy), but it does make the DataReceived code a bit simpler. Since that's the most complex (and most important to understand) piece of code in the whole sample, I decided to do it simpler and less efficiently for this blog post.\r\n\r\nIn real-world code, I don't use the additional array. I always either pass the bytes read as you do, or use an ArraySegment. Actually, updating this code to use the new Span would be a fun project!","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","replyTo":"09737035-652b-36cb-8e8e-963a58804f5f","date":"2018-03-04T03:02:14Z","timestamp":1520132534},{"_id":"21b9bbe0-8ff5-11e8-b893-719cb4b450cd","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","postUri":"http://blog.stephencleary.com/2009/04/sample-code-length-prefix-message.html","replyTo":"","authorEmailEncrypted":"fCjq2V1cDjNs4Sdp8lUPMHkdREWWD5Hf73p9W+H3S9HE2LTYU1QiuTbiyoJrhA7dDEouphLOWRjo9VUjN7c8wX7KujynbQChF4QKEl90vsH3Cv3uUzLEDLEVLqiuVUUVzO1kENrX2VrcE0+qDvdBH0WXMEe+4icDON87clyWm76Ux/GBXU29EBfcxeZUmu9cA+g9blRp2PhLC4G3Y5i/fRW9lIT87xKkzNF/xaJ3YVymye9LnEjWULBXeclsxMsww9sIb2adBSXjmjt6f3gFtRCqnwif60hmg31WFtAYGllY7q3JKKKhBySktP5JCXB3QFv8d+rBCLIY60IYineDAyQEZ4V5o0Kdm/X3cgs+KxJL/IE1bNabz1d/CvLRUsDrvgv6p9h08srnG1NKJ7UmgdxeeX4V0+1SyOLoFx76hllpu6/jMpFvF3QWHU/TbBUHm44F7Y0kAqfJvpF60sz9bGdavMyL3ooeh4KPfOzg0DGa8i53dz+HZvc7S1PNRrA6CndcA2nut8Q66lMkSTD4n32prNB1bRk1p6pNjSJec7WXwGXv/KPdja8sB2lWGraCvW0icdtd0LCG5GnE/U/E/2bh5ycJoHFbpDguq3Gz5wd2eGa7/QIRreFCQ0dH4MlLP856WM0ZeuHpeFSdtrJqGfsWRTkRh9n+8eV8Zt/09ME=","authorEmailMD5":"5cd0c89778f90d75e2a6a5a7f14c3567","authorName":"G","authorUri":"","message":"Hi,\r\nthx a lot fot this whole list of article on Tcp connection management, I learned a lot by reading it.\r\nSmall question about the code snippets published on your site, are there any licensing attached to them? Is it ok to use them on commercial app? if yes on what conditions?\r\nRgds,","date":"2018-07-25T10:26:03.501Z"},{"_id":"08413dd0-9010-11e8-b893-719cb4b450cd","postId":"2009_04_sample-code-length-prefix-message-ba45f669-db06-32ff-ba50-472b420edace","postUri":"https://blog.stephencleary.com/2009/04/sample-code-length-prefix-message.html","replyTo":"21b9bbe0-8ff5-11e8-b893-719cb4b450cd","authorEmailEncrypted":"r9TbRWP8jkF52bymwPHWvRC8LiP0MNh2Ow3Qka7CJa4TfbNBrTU+40hfJCm7bippY2PwdakE+R7DBsjtbfg/bXOwia/wHfsxtXt6an5aHlaVXf3l/g4qZH2iRs5DK1/pRlNuVX/Q6Dkfpy3VfEUQBOwEMrha2KE/bJa9ox8XE3YxUwkdPFdCEel9ezgnPcEKpEZR71uvwU2Y9q8Sk64lAIjkANqUMNda/awQW/2/Nf4YkDnm0NvzDvAPIUmCfhLwiCT7S0dHrARuujjL1zqq9XwDrSNjj6htd42eHeIdAswFNQgWEgZMjl9vSxfidQMkYs3lGdJKvDr/atMOzLJiaYrifPtspufRLAqSPYEV1JelC7dxYgD2RD4gCQbwcEDPtozNl4PtFShsdEPbsXu9y0pP2+vtrQ2eFP5wbo5BEc0nqV9WcCFYRDzKX9S4djluPhRJvOMyHM6XjKOMnoK1J4XiWcZAIHFve0BPM+hqp3VnLQyk97ZC6HiE1FonvxuoIZypwkpcaCgdP2aNC/4G9A2EpMFnxVzvmVqLXEDXjQnK5C3oajDsI4ay3llYyRjJcM0egmvZZu/RQXo/iRJ+gTjjVcYosro3zxkN6Ad0cV8si9xNlsP9SCF6OXTjpwVl+8GYawk0M9UV3nwR8+rRHunJ+fwdvh0ZCjlzNLurH0g=","authorEmailMD5":"23448e78d187fba56d8bc263081ac5d8","authorName":"Stephen Cleary","authorUri":"https://stephencleary.com","message":"All the code on my site is MIT-licensed, so feel free to use in commercial apps!","date":"2018-07-25T13:38:37.111Z"}]