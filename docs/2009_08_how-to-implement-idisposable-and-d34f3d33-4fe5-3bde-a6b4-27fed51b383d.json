[{"_id":"3dfa5c3d-216e-35a7-affb-efca9bcd9cb3","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","message":"Some of the most solid advice I've ever seen on IDisposable. I wish all the other bloggers stopped advertising the \"official\" pattern so much. It's overly complicated to cater for use cases that are a bad idea in the first place.  \r\n\r\nThanks for your insightful observations and the best article on the topic ever - [http://www.codeproject.com/KB/dotnet/idisposable.aspx](http://www.codeproject.com/KB/dotnet/idisposable.aspx) :)","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"","date":"2010-05-04T20:01:18Z","timestamp":1273003278,"authorUserId":""},{"_id":"5e855403-d68c-3898-8ae3-c3a350cf39a3","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","message":"why don't rumble to Mircosoft that they are wrong in thier Dispose pattern? :)","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"","date":"2010-07-07T13:57:01Z","timestamp":1278511021,"authorUserId":""},{"_id":"7c5af0cc-22de-3f17-92ce-5b0abc4f78dd","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","message":"Do you have any thoughts on whether it would be ok/recommended to wrap the Dispose code in try-catch:  \r\n\r\npublic void Dispose() {  \r\n try {  \r\n managedResource.Dispose();  \r\n }  \r\n catch { }  \r\n}","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"","date":"2011-03-02T17:31:49Z","timestamp":1299087109,"authorUserId":""},{"_id":"5d557c0e-b268-3b7c-8547-1f769f73693a","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","message":"catch { } is called \"swallowing exceptions\". It is almost always, by the definition of exceptions, the wrong thing to do. If you catch an exception, it should be handled. The only case where it shouldn't is a case where exceptions can be thrown for things that aren't actually broken. (Thread.Sleep, for example, can throw a ThreadInterruptedException if someone calls thatThread.Interrupt(). But nothing's actually \"wrong\".) However, cases like that are not that common, and they're usually already handled by the code that needs to handle them. All you're really doing by swallowing exceptions is sweeping errors under the rug and making them that much harder to diagnose and fix.","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"","date":"2011-09-20T16:16:17Z","timestamp":1316535377,"authorUserId":""},{"_id":"d72a5cd3-8714-363b-9e08-174b1f1e4ef3","authorName":"Anonymous","authorEmailEncrypted":"","authorEmailMD5":"","message":"What if it's a COM object with a .close method - replace CloseHandle with a simple com_object.close and then Marshal.ReleaseComObject(com_object)?","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"","date":"2011-10-17T08:41:41Z","timestamp":1318840901,"authorUserId":""},{"_id":"4a83fecc-bc27-3149-80df-7984b11fb80d","authorName":"Stephen Cleary","authorEmailEncrypted":"iY512JIF8Ewy+U+a88O5eqD00yG/Ig72eFPbkv1ZeRkhHgd/zCyoIRavItcfB2o67ZZzSP02+j9NTTkaUMZqPjXoGNLuSqzwurzNV1CxlFWtsTwEqtHSMw02x6ZwzoKsCDs9L6vckvxMAxvrhDVWtJARo3wM13r6Rxd0EjAadIox+oc+SuhrxzVdPVnca+GiMRhnHy/xgHgaDiyny+6wQUmL7uXHsRbWxEx0bpmRU//8FzzQqfQ8adW+rUVzrYkAvb51S45t3so4BTLBX5K1bdnwSBk2DKC1VEiepXyFzn/VpaFznTkWEKaq1X18x1povjwzmCMkVmsRvl9yR4O2TQthR+V79RGFLMH/B6ciaIPFtNL+x1J8o7RR4U24Q7wIaQxIHx6DvmlPvqFvVom4/+JLhwzUe72I7iZcwcfXy8DjiiXN3kuyELBHZ58G+WNwAblk6+Dx2A7du2txGHR5YzmqSlYvQKU9J+ruQxeXoQCeupCGpmmosCYMZ/T2QDdfXVq06IBuVGGJ63AIROa+jbxBaz2W5NTM4waIA7xu7YzsXNPFoyRNqMAwJcPG8BsHWSZ8E5X2iZrnXX2t7Nmfw+dLMy9A5t1P2zLpgYPbiJkgoAQcXE5SUviY0Hnx/V/hhnvzsJ19XcGva7Kc7IheAk1vd7s9kkbPO9z0mxsyFwE=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"I have very little COM interop experience, but I believe this is correct:  \r\n\r\nA \"Close\" method on a COM object is an actual method, not a generic resource cleanup method (i.e., it actually performs an action; one that you don't necessarily want done in every use case). ReleaseComObject can be called from Dispose if your COM object is owned by that object.  \r\n\r\nCOM objects are considered managed resources (since the GC will deref them eventually).  \r\n\r\nI'm basing my assumptions on CBrumme's blog post, which may help you in your design: [http://blogs.msdn.com/b/cbrumme/archive/2003/04/16/51355.aspx](http://blogs.msdn.com/b/cbrumme/archive/2003/04/16/51355.aspx)","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"","date":"2011-10-18T00:30:19Z","timestamp":1318897819,"authorUserId":""},{"_id":"00e26f04-76f1-323c-bf10-f57859c83a3e","authorName":"Soumyadip","authorEmailEncrypted":"Qoj7HS6pyamze628udM/TYC8k2w7dkmje23MTLoG6Psptgwq3BM7yqRE184SWzp4N19as4fj0hxa8JOcBZhaJsdQ5MImvdUEMORQMYSFigm0r3L8CZ6/Bk69vnl4ErwohyT2Uq9xYsrOVcKOBt0zAKugU69JsT6MJEwsN/ZTXB6px9H5Cr7/ycsX+Aj4BrjbStRsAPjcr2rp/wd6MuAu21yi3uRt9XYvGWU1mSlQhJvNmjseqHYuqdMe3V6te+ZTGEY/0irb2WotE8aTSDrKpRPpCCEixtPl8AxY5tZrjt5Z/W4Mi97itbyyRsEBa1AqjuyNRr48lIKSl0jWb3LOMOq75kCjXJdM6hOMU9p3wxU3XyPFGD5YvEt1L3OBcotWjubrLiZT/oTN3U/oWE/ej7OSWl726ErmRCgKZS8r0yBjmSzXojh8SP1dYUNekqtXlXAqYtNIFovA4DqAG7lnA7MV0EU0uCcE0VVztJ01/ZrdeMBatNAGtXzJ2Q/pZdN8BrUzd1H0YnNlmeh3oTNjIe9KPz3P6wURtL+pW8P3A1aUMuWO5KjSrT6sjByCM9IPGZJaBdzic157bDjjm+Y+efrDU10y6juUDBWeJJLRMbJojT3e2jz6YHGc6TjlGD81K6fvOIWV9FnHYphHHqzIBxL3EpJ/TFVyoTSZajlp07E=","authorEmailMD5":"1536936f03a6b30cf33ab4ca2604aa09","message":"Hi Stephen, Could you please write a post , how to implement IDisposable for structure?  \r\nThanks :)","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"","date":"2014-06-17T08:22:05Z","timestamp":1402993325,"authorUserId":""},{"_id":"1700ae09-6d0f-3b38-ad02-ec1d011f43bf","authorName":"Stephen Cleary","authorEmailEncrypted":"NUpivu+3ZSSp65I18wWIaYqaV9Jqx/N3Y7FckBGaWpB5nrQsws7eBUVH40WUU4SObvum5+4u7+L1xKPolssIpuDhejqFrt9a66wsxX9Rr73CVLiBIk/h9sud9DiNw27M8UnS4dVz41aj3Qpnw0y349/HT3Rw9V0So12YLensH94uZxJyDf+bb+9I7Kk+HDToYurmYgS1r47nHdn/V8NCdnQxXo+BK5KIIprwPTYdGM+L7Ww+uMT9O+cVpF237IdH378X8led65/yaxUPkk8kmDOo018l6lVDPDVO9NmntrsOefQLex7HqUyLyzM+3hNMKjZq+XRhaalHIymsiJhCSVnS1pYWWsyOvbV2ba6KrhaPx9geYx5UyYH6e1IFOYUArUeFZwY4K3JeHr9AUbTwrY7RDhL/P2t8bFWBx1QUypS9CYzfefpyUXrdWydntkdaCnuueI7DIkogED7WXVdgGUms6/fSh0RIk9bSGJJOd5nFOABoTT2tYkH2PKncDXf0rA0Mz9tdK4M2gF8slGwOq5Fp1mt1WkQWfIefhccfTfHq6yqRSS5tG/BhzcADU8K/9bFvlrs0FfjzwMW6byKPokQBe/Bzxi791xW/rqWd3k1EQUZ9bHJAIsTMzf9lBBjxIYigQr2cbdkyU4euLlLtifiuwCx5JNMH4rel3DAKflk=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"I would recommend not implementing IDisposable on a structure. If you did decide to do that, you would only dispose managed resources (i.e., follow Rule 2).","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"00e26f04-76f1-323c-bf10-f57859c83a3e","date":"2014-06-17T14:16:54Z","timestamp":1403014614,"authorUserId":"disqus:stephen_cleary"},{"_id":"8500c14e-1853-3795-b2da-02362700a4ae","authorName":"Jens Melgaard","authorEmailEncrypted":"fK7M/SoJA0XrMswUzM+ZwB7uLbbEme/TKaahvq43f9S3HQ84luGY//QIMipklkYDLLes49cbt2we604PVZS8hS3I4DNQ2wPbs4vw4KEnuO8MeS4j3Uwkx+hGaBRmFCYMFaTFnvH3rAQ2gkEO32PibrzJ7fj296yZ9YY2R4R84NgtWJZTu1HbVh3T6XyZnFxPCrhOS+1fc9t73DLngvsKPl1uCqzs/RQviPSoUdaUzb6EP+8tsZ0vMXf7lV9K+hoCh6nzuOCHbsNliIAS5vveUHTWwa8ezABcrTdYSl8aVCtJBiMfB00ncSG8BaPyU/iuS7uq/5aUsCxaFjzO2+aAnXASqTDzWicmRTNCyzdNIsGOwCocnFvdR+SIZjK6h7kGLnPwjS/jWzN572P1QaOz+oqIZQqbQ/Fz0w+LO4OI/rPI+WnI2ffCC/ZZhFvAmQHrC1b44loVH3PQ/ybDjQ6KFpC+chx1yH5hG39hpW6lmlpT3HOaISR7QdgJgAUREa8Nzr5z/jcikQb6rQfgu48KtwM4bP8/sG0JmpwmNI/MNNaK46++jl9uMUrOSfi7jHOjzrtpRBxl+ABYlrPK5yVFg1hnycM84BDrQNz4qb8XBxYWIa58PxiiZRop38FGua7QhWRVpD3eyBqrcblBHBSWaqdFVGXXPu74DorKdVV8FnU=","authorEmailMD5":"73444d6da4e960f1f7d41d3201b12d2c","message":"AFAIK IDisposeable is nothing more than an Interface that allows a language construct (the using statement) replacing:\r\n\r\nvar something = GetSomething();  \r\ntry {  \r\n something.DoIt();  \r\n AddSomeMoreCode();  \r\n} finally {  \r\n something.Done();  \r\n}\r\n\r\nWith:\r\n\r\nusing(var something = GetSomething()) {  \r\n something.DoIt();  \r\n AddSomeMoreCode();  \r\n} //And Done is implemented as Dispose instead.\r\n\r\n(And to be fair, that is a far cleaner syntax)\r\n\r\nSeeing it in that light I would argue that there is no problems with IDisposeable in it self, and there has never been.\r\n\r\nThe truth is that any single one of the problems mentioned would exist regardless of IDisposable. So it's hardly IDisposable's fault... If there is anything wrong with IDisposeable, it's what is written about it and tough about it... (This even comes from Microsoft them self who are more focused on what they wanted with the interface rather than what they managed to be capable of)... which overall has makes it all a huge mess.\r\n\r\nBut considering that the using statement can be useful in other scenarios as well. Then I wouldn't cling to strongly to these rules.\r\n\r\nOne could argue that it would be desired to unlock using for other interfaces, possibly user defined interfaces, but that is another talk.","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"","date":"2016-12-05T10:56:08Z","timestamp":1480935368,"authorUserId":"disqus:jens_melgaard"},{"_id":"e8d2ed8a-b805-3b4f-89e5-172da5af310b","authorName":"Stephen Cleary","authorEmailEncrypted":"moO4XymjIUKHrKIAhNmBcqlbkcLP5pLOfWihtb9Z46CRj6y3DxLSVFbNdw86UrYI8F67r8G5VfYrdSP6nswq3Y0KIE3/qIAlVlfTo81FT7/HfhMpLwXPpBLrUtAGP5mWOtGINbp8J4UU+XGbZ5Hgn184D6pzaAf8Fij8oMQzyRu4uilGeqtmV/6H9sn443RijEIygepP3TMNJ8hFXUAnfCU/44W+ax4qHAwhCSxPvCzh45cdw6f3lRtGxWDoLYIpZgZe/GCIJbOuSxbqbMDKhawOy6JrvT4D/ScHfd0t+6mM2O7gFS55KwoHNFWUxz87k90AI274pcSoJFADBfVJB/IiJo4zq7P5RGeXB9Msm/rQxD44HOX4LdfoC/Viwcc+NqMpMAFShSEJ44hG6Dw6l2zu5vSOZc1/PPrbkf5cuIfxW6PBIRArqSlxa1j+nUOXXCohMfNZO2pPMv78gnBwoNULRljIbZPX7DF0w+9TGVppWaUS/bjvjZQZFBukUW6UCWyuC3MFi01SxAq0HNq/cln7RTtDLz9aCc+7Ld72fM2g9e6FOZreMhwfTuLzsOI4VBNAW6oO4Eb1IqFlzQCb7iWbL/uDYIYyfBYTvdG7bM1wo4m7Edo1O+cXc2q6AjHzqOv/aLD2d6Ntpv8A2a7aT5en4x4XzpORkbtKVOf8r/E=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"It depends on your background. For example, with my background in C++, I see one major problem with the whole disposable system: it puts the burden on the client to dispose of the resource. C++ destructors do not; they are always called automatically when the object goes out of scope (RAII).\r\n\r\nI have nothing against using IDisposable for \"cleanup\" tasks - e.g., I use IDisposable to unlock async-compatible locks; this series is just looking at IDisposable with its original purpose in mind: disposing allocated resources.","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"8500c14e-1853-3795-b2da-02362700a4ae","date":"2016-12-05T14:20:46Z","timestamp":1480947646,"authorUserId":"disqus:stephen_cleary"},{"_id":"c0e1c78e-05a4-3e8a-9bb1-86c1695d688e","authorName":"pwee167","authorEmailEncrypted":"Q179rDmqT+7h9KmzGGA9OFfar+VajjZ368bkWWWsr+XFRPmiXvtLNZ+F7DZyWESosN/+VRRIHuQ4cpOjzi/xgeea6pd+ZDEtG5jUAWsRR7+U0jrwU5HJXcaXxNmO/EDy02vonSlARhuaXxSDMfm/cokT0yTQ18CfmshfpD2+rgSPv+Yg6P0wTg3lPnANJn79voML4XcYV3qXLtM5Sf7SoOFtTxWTAh2zI4/lkB80NVIcMMDJ/uZM8NC1IZpEyrRZQ0GefgfLAOu1Zi1Oll7mRgGzB0ap60bGLx1I67laFPILYQLXS2MUrV0gUFGsMrJmmoLcAyQIwCC0KQVLWhTwGEN96mFFOMZ0rvC5/48BHHndSeRo6jtfXvaDhKphvt6AKg3mQUEZngrkX+t13kQ1K9nsqUYWK1LP9+PXcXz7CtBWMbxU7KoPMHFhtMFfCfB5NY6/zzO5l1VTumbZmn1wW7qK2qN1o28/XJXz5lr8GBD0CJL1IyjnpbVRQhioHzeqjnVXVxmf7hxmmIcPVgTktLsJSrXMgEVM56cYTDTZ3KjUPFChfjaTFwuEDvkWojLoJ3MdOYyYOrS2edKcAJWoPNcV1bs04wYWhcRBBgWTG+0sga7i/1KkO86KiEgFAkYZ+hE1SVK8tdEuyEUFMNR1GZ8y27Wiuod4XazCeDCqrW4=","authorEmailMD5":"1d071a2559b38acd23991885bfecda38","message":"@stephen_cleary:disqus Great articles once again.\r\n\r\nQuestion: How does the GC treat classes implemented as IDisposable? Specifically, if the class doesn't own unmanaged resources or managed (IDisposable) resources, yet it was implemented as IDisposable?\r\n\r\nDo these classes automatically get placed in the finalizer queue waiting for the finalizer to get around to it?","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"","date":"2018-02-10T16:44:23Z","timestamp":1518281063,"authorUserId":"disqus:pwee167"},{"_id":"0a9edbe5-bccc-3ea3-88db-98f7d69ea105","authorName":"Stephen Cleary","authorEmailEncrypted":"YAbTer0brTbRaQbVFuF4JUTRgATl+7hfUCwDYM55k9eUueqF7GFW+9/6456tQpWMsVBumCk25BVjLJqcB8g/vsP+uuQTnSTLlATAcKe0Q0eJq/AQgIKIil9rIambJHNM7u5AXEkUcPu/DkVLmkg4v+wz4hzbWVoIKjxu5BWHB0K/gSl0ijrSmLfCDjnIK9g7uW0nb+2dGDkDsyh4XrB0SO+DUlhOtc9r3n+ioutRTilDiJwrzs3frEJfaG0tFAGDr79GxorSCnJtsJ1/5Bnv7pOlIXhsCOQREMyXnc8ZtQXgKCJNxbOAWE+cqiM7KAOfvebSqAQMvV4IgIV8N6cT/Fxhbwo2ucME3vIqDkMiY8/+CnIqwl6LDpMcocP+MCeoDYvjO1D954dSzIlPu1zeSXOy8CFkDiTP9hhkRYNmbhJO8fcVGYCieE4h0T+jmFvYX0F5I4pe3CR1IcfU3c2CBobULiCNFh3O2ZFMR1cw1sUD0MYwe0Oz+ezQ3AhuUBz17OnUC+4jzPig5UOsH5c0P+2+aPO1cNz29zkV+8wa+C0qsz57iv/IPnG/6CerLEjZ1UGChzpkuGODQRMU69H8FqA/8C9MqyjBsAAc5L0itYySR4J+ByQO5aDQHYUAiJRxlHr0rtrTlvljlmiNlZ5FnSNmSHi/B89mfm/hgNPJr64=","authorEmailMD5":"ad2250182ff26a84dda974e50cd94382","message":"The GC doesn't treat IDisposable types in any special way at all.\r\n\r\nTypes with finalizers get put on the finalizer queue. If a type implements IDisposable (and does not have a finalizer), then it does not get put on the finalizer queue.","postId":"2009_08_how-to-implement-idisposable-and-d34f3d33-4fe5-3bde-a6b4-27fed51b383d","replyTo":"c0e1c78e-05a4-3e8a-9bb1-86c1695d688e","date":"2018-02-12T03:21:34Z","timestamp":1518405694,"authorUserId":"disqus:stephen_cleary"}]